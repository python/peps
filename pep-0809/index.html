
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="color-scheme" content="light dark">
    <title>PEP 809 – Stable ABI for the Future | peps.python.org</title>
    <link rel="shortcut icon" href="../_static/py.png">
    <link rel="canonical" href="https://peps.python.org/pep-0809/">
    <link rel="stylesheet" href="../_static/style.css" type="text/css">
    <link rel="stylesheet" href="../_static/mq.css" type="text/css">
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" media="(prefers-color-scheme: light)" id="pyg-light">
    <link rel="stylesheet" href="../_static/pygments_dark.css" type="text/css" media="(prefers-color-scheme: dark)" id="pyg-dark">
    <link rel="alternate" type="application/rss+xml" title="Latest PEPs" href="https://peps.python.org/peps.rss">
    <meta property="og:title" content='PEP 809 – Stable ABI for the Future | peps.python.org'>
    <meta property="og:description" content="The Stable ABI as abi3 can no longer be preserved, and requires replacement. abi2026 will be the first replacement, providing resolution of current known incompatibilities, with planned retirement after at least 10 years. The next ABI (for example, abi2...">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://peps.python.org/pep-0809/">
    <meta property="og:site_name" content="Python Enhancement Proposals (PEPs)">
    <meta property="og:image" content="https://peps.python.org/_static/og-image.png">
    <meta property="og:image:alt" content="Python PEPs">
    <meta property="og:image:width" content="200">
    <meta property="og:image:height" content="200">
    <meta name="description" content="The Stable ABI as abi3 can no longer be preserved, and requires replacement. abi2026 will be the first replacement, providing resolution of current known incompatibilities, with planned retirement after at least 10 years. The next ABI (for example, abi2...">
    <meta name="theme-color" content="#3776ab">
</head>
<body>
    
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-sun-half" viewBox="0 0 24 24" pointer-events="all">
    <title>Following system colour scheme</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none"
         stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <circle cx="12" cy="12" r="9"></circle>
      <path d="M12 3v18m0-12l4.65-4.65M12 14.3l7.37-7.37M12 19.6l8.85-8.85"></path>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24" pointer-events="all">
    <title>Selected dark colour scheme</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none"
         stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z"></path>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24" pointer-events="all">
    <title>Selected light colour scheme</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none"
         stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
</svg>
    <script>

        document.documentElement.dataset.colour_scheme = localStorage.getItem("colour_scheme") || "auto"
    </script>
    <section id="pep-page-section">
        <header>
            <h1 data-pagefind-ignore>Python Enhancement Proposals</h1>
            <ul class="breadcrumbs">
                <li><a href="https://www.python.org/" title="The Python Programming Language">Python</a> &raquo; </li>
                <li><a href="../pep-0000/">PEP Index</a> &raquo; </li>
                <li>PEP 809</li>
            </ul>
            <button id="colour-scheme-cycler" onClick="setColourScheme(nextColourScheme())">
                <svg aria-hidden="true" class="colour-scheme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
                <svg aria-hidden="true" class="colour-scheme-icon-when-dark"><use href="#svg-moon"></use></svg>
                <svg aria-hidden="true" class="colour-scheme-icon-when-light"><use href="#svg-sun"></use></svg>
                <span class="visually-hidden">Toggle light / dark / auto colour theme</span>
            </button>
        </header>
        
        <div id="mobile-search" class="mobile-search-container"></div>
        
        <article data-pagefind-body>
            
            <span data-pagefind-meta="title:PEP 809 – Stable ABI for the Future" data-pagefind-weight="10" class="visually-hidden">PEP 809 – Stable ABI for the Future</span>
            <section id="pep-content">
<h1 class="page-title">PEP 809 – Stable ABI for the Future</h1>
<dl class="rfc2822 field-list simple">
<dt class="field-odd">Author<span class="colon">:</span></dt>
<dd class="field-odd">Steve Dower &lt;steve.dower&#32;&#97;t&#32;python.org&gt;</dd>
<dt class="field-even">Discussions-To<span class="colon">:</span></dt>
<dd class="field-even"><a class="reference external" href="https://discuss.python.org/t/104073">Discourse thread</a></dd>
<dt class="field-odd">Status<span class="colon">:</span></dt>
<dd class="field-odd"><abbr title="Proposal under active discussion and revision">Draft</abbr></dd>
<dt class="field-even">Type<span class="colon">:</span></dt>
<dd class="field-even"><abbr title="Normative PEP with a new feature for Python, implementation change for CPython or interoperability standard for the ecosystem">Standards Track</abbr></dd>
<dt class="field-odd">Requires<span class="colon">:</span></dt>
<dd class="field-odd"><a class="reference external" href="../pep-0703/">703</a>, <a class="reference external" href="../pep-0793/">793</a>, <a class="reference external" href="../pep-0697/">697</a></dd>
<dt class="field-even">Created<span class="colon">:</span></dt>
<dd class="field-even">19-Sep-2025</dd>
<dt class="field-odd">Python-Version<span class="colon">:</span></dt>
<dd class="field-odd">3.15</dd>
<dt class="field-even">Post-History<span class="colon">:</span></dt>
<dd class="field-even"><a class="reference external" href="https://discuss.python.org/t/104073" title="Discourse thread">30-Sep-2025</a></dd>
</dl>
<hr class="docutils" />
<section id="contents">
<details><summary>Table of Contents</summary><ul class="simple">
<li><a class="reference internal" href="#abstract">Abstract</a></li>
<li><a class="reference internal" href="#terminology">Terminology</a></li>
<li><a class="reference internal" href="#motivation">Motivation</a></li>
<li><a class="reference internal" href="#related-peps">Related PEPs</a></li>
<li><a class="reference internal" href="#background">Background</a></li>
<li><a class="reference internal" href="#rationale">Rationale</a></li>
<li><a class="reference internal" href="#specification">Specification</a><ul>
<li><a class="reference internal" href="#abi-stability">ABI Stability</a></li>
<li><a class="reference internal" href="#opaque-pyobject">Opaque PyObject</a></li>
<li><a class="reference internal" href="#new-export-hook-pep-793">New Export Hook (PEP 793)</a></li>
<li><a class="reference internal" href="#runtime-abi-checks">Runtime ABI checks</a></li>
<li><a class="reference internal" href="#build-time-macros">Build-time macros</a></li>
<li><a class="reference internal" href="#wheel-tags">Wheel tags</a></li>
<li><a class="reference internal" href="#new-api">New API</a></li>
<li><a class="reference internal" href="#interfaces-api">Interfaces API</a></li>
</ul>
</li>
<li><a class="reference internal" href="#backwards-compatibility">Backwards Compatibility</a></li>
<li><a class="reference internal" href="#security-implications">Security Implications</a></li>
<li><a class="reference internal" href="#how-to-teach-this">How to Teach This</a></li>
<li><a class="reference internal" href="#reference-implementation">Reference Implementation</a></li>
<li><a class="reference internal" href="#rejected-ideas">Rejected Ideas</a></li>
<li><a class="reference internal" href="#open-issues">Open Issues</a></li>
<li><a class="reference internal" href="#footnotes">Footnotes</a></li>
<li><a class="reference internal" href="#copyright">Copyright</a></li>
</ul>
</details></section>
<section id="abstract">
<h2><a class="toc-backref" href="#abstract" role="doc-backlink">Abstract</a></h2>
<p>The Stable ABI as <code class="docutils literal notranslate"><span class="pre">abi3</span></code> can no longer be preserved, and requires replacement.
<code class="docutils literal notranslate"><span class="pre">abi2026</span></code> will be the first replacement, providing resolution of current known
incompatibilities, with planned retirement after at least 10 years. The next ABI
(for example, <code class="docutils literal notranslate"><span class="pre">abi2031</span></code>) will have at least five years of overlap with the
preceding one.</p>
<p>Long-term stability will be enabled through a mechanism for runtime ABI
discovery, allowing extensions to be run with earlier releases that support the
same ABI. Changes and additions during the lifespan of an ABI can be added as
<em>interfaces</em>, allowing them to be discovered at runtime so that callers can
choose suitable fallback behaviour. Currently, such additions prevent extensions
from loading at all on earlier runtimes.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">abi3</span></code> ABI will be retained in GIL-enabled builds for at least five years,
after which time it may be retired (with only <code class="docutils literal notranslate"><span class="pre">abi2026</span></code> and later being
available). It’s possible that GIL-enabled builds will be retired completely
before then. Free-threaded builds do not have <code class="docutils literal notranslate"><span class="pre">abi3</span></code>, and so their first
Stable ABI would be <code class="docutils literal notranslate"><span class="pre">abi2026</span></code>.</p>
</section>
<section id="terminology">
<h2><a class="toc-backref" href="#terminology" role="doc-backlink">Terminology</a></h2>
<p>This PEP uses “GIL-enabled build” as an antonym to “free-threaded build”,
that is, an interpreter or extension built without <code class="docutils literal notranslate"><span class="pre">Py_GIL_DISABLED</span></code>.</p>
</section>
<section id="motivation">
<h2><a class="toc-backref" href="#motivation" role="doc-backlink">Motivation</a></h2>
<p>The Stable ABI is currently not available for free-threaded builds.
Extensions will fail to build when <a class="reference external" href="https://docs.python.org/3/c-api/stable.html#c.Py_LIMITED_API" title="(in Python v3.14)"><code class="xref c c-macro docutils literal notranslate"><span class="pre">Py_LIMITED_API</span></code></a> is defined.
Likewise, extensions built for GIL-enabled builds of CPython will fail to load
(or crash) on free-threaded builds.</p>
<p>In its <a class="reference external" href="https://discuss.python.org/t/84319/123">acceptance post</a>
for <a class="pep reference internal" href="../pep-0779/" title="PEP 779 – Criteria for supported status for free-threaded Python">PEP 779</a>, the Steering Council stated that it “expects that Stable ABI
for free-threading should be prepared and defined for Python 3.15”.</p>
<p>This PEP proposes a Stable ABI that will be compatible with all variants of 3.15
and later, allowing package developers to produce a single build of their
extensions.</p>
</section>
<section id="related-peps">
<h2><a class="toc-backref" href="#related-peps" role="doc-backlink">Related PEPs</a></h2>
<p><a class="pep reference internal" href="../pep-0803/" title="PEP 803 – “abi3t”: Stable ABI for Free-Threaded Builds">PEP 803</a> is an alternative to this proposal, and much of the background text
used in this PEP is deliberately identical. We thank the PEP 803 author for the
use of their text.</p>
</section>
<section id="background">
<h2><a class="toc-backref" href="#background" role="doc-backlink">Background</a></h2>
<p>Python’s Stable ABI, as defined in <a class="pep reference internal" href="../pep-0384/" title="PEP 384 – Defining a Stable ABI">PEP 384</a> and <a class="pep reference internal" href="../pep-0652/" title="PEP 652 – Maintaining the Stable ABI">PEP 652</a>, provides a way to
compile extension modules that can be loaded on multiple minor versions of the
CPython interpreter.
Several projects use this to limit the number of
<a class="reference external" href="https://packaging.python.org/en/latest/specifications/binary-distribution-format/#binary-distribution-format" title="(in Python Packaging User Guide)"><span class="xref std std-ref">wheels</span></a> (binary artefacts)
that need to be built and distributed for each release, and/or to make it
easier to test with pre-release versions of Python.</p>
<p>With free-threading builds (<a class="pep reference internal" href="../pep-0703/" title="PEP 703 – Making the Global Interpreter Lock Optional in CPython">PEP 703</a>) being on track to eventually become
the default (<a class="pep reference internal" href="../pep-0779/" title="PEP 779 – Criteria for supported status for free-threaded Python">PEP 779</a>), we need a way to make the Stable ABI available
to those builds.</p>
<p>To build against the Stable ABI, the extension must use a <em>Limited API</em>,
that is, only a subset of the functions, structures, etc. that CPython
exposes.
The Limited API is versioned, and building against Limited API 3.X
yields an extension that is ABI-compatible with CPython 3.X and <em>any</em> later
version (though bugs in CPython sometimes cause incompatibilities in practice).
Also, the Limited API is not “stable”: newer versions may remove API items that
were available in older versions.</p>
<p>This PEP proposes a significant change to versioning of both the Limited API
and the Stable ABI. The goal is to enable long-term management of stability
and compatibility, while also allowing users of the limited subsets to have
access to innovations in later Python releases.</p>
</section>
<section id="rationale">
<h2><a class="toc-backref" href="#rationale" role="doc-backlink">Rationale</a></h2>
<p>The design in this PEP makes several assumptions:</p>
<dl class="simple">
<dt>One ABI</dt><dd>A single compiled extension module should support both
free-threaded and GIL-enabled builds.</dd>
<dt>No backwards compatibility</dt><dd>The new limited API will not be supported by CPython 3.14 and below.
Projects that need this support can build separate extensions specifically
for the 3.14 free-threaded interpreter, and for older stable ABI versions.</dd>
<dt>API changes are OK</dt><dd>The new Limited API may require extension authors to make significant
changes to their code.
Projects that cannot do this (yet) can continue using Limited API 3.14,
which will yield extensions compatible with GIL-enabled builds only.</dd>
<dt>No extra configuration</dt><dd>We do not introduce new “knobs” that influence what API is available
and what the ABI is compatible with.</dd>
</dl>
</section>
<section id="specification">
<h2><a class="toc-backref" href="#specification" role="doc-backlink">Specification</a></h2>
<p>Note that much of the specification is identical to <a class="pep reference internal" href="../pep-0803/" title="PEP 803 – “abi3t”: Stable ABI for Free-Threaded Builds">PEP 803</a>, and readers
should refer to that proposal for details. The ABI Stability, Build-time Macros
and Interfaces API sections are unique to this proposal.</p>
<section id="abi-stability">
<h3><a class="toc-backref" href="#abi-stability" role="doc-backlink">ABI Stability</a></h3>
<p>The Stable ABI will be frozen for a duration of at least 10 years. When a new
version of the Stable ABI is frozen, the existing version will continue to be
supported for at least 5 years. This allows ample migration time for package
maintainers (and other users) to migrate their entire range of supported
releases simultaneously. However, if the Python core development team sees no
reason to replace the current Stable ABI, freezing a new version may be
deferred.</p>
<p>New Stable ABIs are defined using the PEP process, with their name reflecting
the release year of the first runtime that supports it.</p>
<p>When a Stable ABI is frozen, the year becomes the name of the ABI. For example,
we anticipate that the first ABI under this scheme will be <code class="docutils literal notranslate"><span class="pre">abi2026</span></code>, and will
be supported by all releases until at least 2036. If support is dropped in 2036,
then <code class="docutils literal notranslate"><span class="pre">abi2031</span></code> would be the migration target, which allows package developers
to support at least five years of releases after their own migration.</p>
<p>While frozen, no ABI changes are permitted at all. Additions are not permitted,
nor are removals, modifications, or drastic semantic changes. Critically, an
extension module compiled against a particular ABI must load successfully
(as in, all imported symbols are satisfied on all supported platforms) against
any Python version supporting that ABI, earlier or later.</p>
<p>Semantic changes that cannot be detected at runtime via existing compatible ABI
are not permitted. That is, the APIs to detect whether a particular behaviour is
expected on the current Python release must have been available on all earlier
releases that support the ABI.</p>
</section>
<section id="opaque-pyobject">
<h3><a class="toc-backref" href="#opaque-pyobject" role="doc-backlink">Opaque PyObject</a></h3>
<p>Version 3.15 of the Limited API will make a number of structures opaque, such
that users of them cannot make any assumptions about their size or layout. The
details may be found in <a class="pep reference internal" href="../pep-0803/" title="PEP 803 – “abi3t”: Stable ABI for Free-Threaded Builds">PEP 803</a>, and the proposal here is identical.</p>
</section>
<section id="new-export-hook-pep-793">
<h3><a class="toc-backref" href="#new-export-hook-pep-793" role="doc-backlink">New Export Hook (PEP 793)</a></h3>
<p>Implementation of this PEP requires <a class="pep reference internal" href="../pep-0793/" title="PEP 793 – PyModExport: A new entry point for C extension modules">PEP 793</a> (<code class="docutils literal notranslate"><span class="pre">PyModExport</span></code>:
A new entry point for C extension modules) to be
accepted, providing a new “export hook” for defining extension modules.
Using the new hook will become mandatory in Limited API 3.15.</p>
<p>This proposal is identical to that of <a class="pep reference internal" href="../pep-0803/" title="PEP 803 – “abi3t”: Stable ABI for Free-Threaded Builds">PEP 803</a>.</p>
</section>
<section id="runtime-abi-checks">
<h3><a class="toc-backref" href="#runtime-abi-checks" role="doc-backlink">Runtime ABI checks</a></h3>
<p>See <a class="pep reference internal" href="../pep-0803/" title="PEP 803 – “abi3t”: Stable ABI for Free-Threaded Builds">PEP 803</a> for details. This proposal is identical.</p>
</section>
<section id="build-time-macros">
<h3><a class="toc-backref" href="#build-time-macros" role="doc-backlink">Build-time macros</a></h3>
<p>We require <a class="reference external" href="https://docs.python.org/3/c-api/stable.html#c.Py_LIMITED_API" title="(in Python v3.14)"><code class="xref c c-macro docutils literal notranslate"><span class="pre">Py_LIMITED_API</span></code></a> to be defined to <code class="docutils literal notranslate"><span class="pre">0x03ff_YYYY</span></code> - that is,
the high word is a constant <code class="docutils literal notranslate"><span class="pre">0x03ff</span></code>, while the low word is the ABI name
(year) as a hexadecimal value. While this results in a decimal value that is not
the same as the year, we consider that to be unimportant as the value is an
arbitrary label and more likely to be specified as a constant (in a <code class="docutils literal notranslate"><span class="pre">cc</span></code>
command line) than a calculated value.</p>
<p>The use of <code class="docutils literal notranslate"><span class="pre">0x03ff</span></code> as the constant is intended to allow compatibility with
earlier runtimes. The same constant when used with headers only supporting
<code class="docutils literal notranslate"><span class="pre">abi3</span></code> will select the “most complete” version of ABI3 available in that
release. For example, using <code class="docutils literal notranslate"><span class="pre">0x03ff2026</span></code> in 3.15+ would select <code class="docutils literal notranslate"><span class="pre">abi2026</span></code>,
while in 3.10 will select the version of ABI3 that works for 3.10-3.14.</p>
</section>
<section id="wheel-tags">
<h3><a class="toc-backref" href="#wheel-tags" role="doc-backlink">Wheel tags</a></h3>
<p>Wheels should be tagged with the ABI tag <code class="docutils literal notranslate"><span class="pre">abi2026</span></code>. No changes to Python or
platform tags are needed. It is perhaps worth noting that releases tagged for
<code class="docutils literal notranslate"><span class="pre">cp314</span></code> or earlier will never be compatible with <code class="docutils literal notranslate"><span class="pre">abi2026</span></code>, as it was not
present, and so a wheel tagged <code class="docutils literal notranslate"><span class="pre">py3-abi2026-&lt;plat&gt;</span></code> is not going to cause a
wheel using the new Stable ABI to be loaded by an older release.</p>
</section>
<section id="new-api">
<h3><a class="toc-backref" href="#new-api" role="doc-backlink">New API</a></h3>
<p>Implementing this PEP will make it possible to build extensions that
can be successfully loaded on free-threaded Python, but not necessarily ones
that are thread-safe without a GIL.</p>
<p>Limited API to allow thread-safety without a GIL – presumably <code class="docutils literal notranslate"><span class="pre">PyMutex</span></code>,
<code class="docutils literal notranslate"><span class="pre">PyCriticalSection</span></code>, and similar – will be added via the C API working group,
or in a follow-up PEP.</p>
</section>
<section id="interfaces-api">
<h3><a class="toc-backref" href="#interfaces-api" role="doc-backlink">Interfaces API</a></h3>
<p>A new <em>interfaces</em> API will be added to Python and the new Limited API. This API
is to satisfy the “semantic changes are detectable on all releases” requirement
from the ABI Stability section above. That is, consumers <a class="footnote-reference brackets" href="#consumers" id="id1">[1]</a> will be
able to adopt a new API immediately, compile for the Limited API with the latest
release, and retain binary compatibility for all releases supporting that ABI.</p>
<p>In short, the primary API is <code class="xref c c-func docutils literal notranslate"><span class="pre">PyObject_GetInterface()</span></code>, which delegates
to a new native-only type slot to fill in a C struct containing either data or
function pointers. Because the C struct definition is embedded into the
extension, rather than obtained at runtime, an extension module can be aware of
later structs while running against releases of Python that do not provide it.</p>
<p>If the call to <code class="docutils literal notranslate"><span class="pre">PyObject_GetInterface</span></code> requests a struct that is not available
on the current version, or is not available for the provided object, the call
fails safely. The caller may then use fallback logic (for example, using
abstract Python APIs) or abort, based on their preference.</p>
<p>For example, if a new API were to be added during <code class="docutils literal notranslate"><span class="pre">abi2026</span></code>’s life that allows
more efficient access to an <code class="docutils literal notranslate"><span class="pre">int</span></code> object’s internal data, rather than adding a
new API, we would create a new interface: a struct containing a function pointer
to copy the data to a new location, and a previously unused index/name for that
interface. The caller can call <code class="docutils literal notranslate"><span class="pre">PyObject_GetInterface(int_object,</span> <span class="pre">&amp;intf_struct)</span></code>
first; if it succeeds, call (a hypothetical)
<code class="docutils literal notranslate"><span class="pre">(*intf_struct.copy_bits)(&amp;intf_struct,</span> <span class="pre">dest,</span> <span class="pre">sizeof(dest))</span></code>; if it fails,
they can use <code class="docutils literal notranslate"><span class="pre">PyObject_CallMethod(int_object,</span> <span class="pre">&quot;to_bytes&quot;,</span> <span class="pre">...)</span></code> to perform the
same operation, but less efficiently. The final result of this example is a
single extension module that is binary compatible with <em>all</em> releases supporting
<code class="docutils literal notranslate"><span class="pre">abi2026</span></code> but is more efficient when running against newer releases of Python.</p>
<p>Overview complete, here is the full specification of each new API:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="c1">// Abstract API to request an interface for an object (or type).</span>
<span class="n">PyAPI_FUNC</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="w"> </span><span class="n">PyObject_GetInterface</span><span class="p">(</span><span class="n">PyObject</span><span class="w"> </span><span class="o">*</span><span class="n">obj</span><span class="p">,</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">intf</span><span class="p">);</span>

<span class="c1">// API to release an interface.</span>
<span class="n">PyAPI_FUNC</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="w"> </span><span class="n">PyInterface_Release</span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">intf</span><span class="p">);</span>

<span class="c1">// Expected layout of the start of each interface. Actual interface structs</span>
<span class="c1">// will add additional function pointers or data.</span>
<span class="k">typedef</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">PyInterface_Base</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// sizeof(self), for additional validation that the caller is passing</span>
<span class="w">    </span><span class="c1">// the correct structure.</span>
<span class="w">    </span><span class="n">Py_ssize_t</span><span class="w"> </span><span class="n">size</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// Unique identifier for the struct. Details below.</span>
<span class="w">    </span><span class="kt">uint64_t</span><span class="w"> </span><span class="n">name</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// Function to release the struct (e.g. to decref any PyObject fields).</span>
<span class="w">    </span><span class="c1">// Should only be invoked by PyInterface_Release(), not directly.</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">release</span><span class="p">)(</span><span class="k">struct</span><span class="w"> </span><span class="nc">PyInterface_Base</span><span class="w"> </span><span class="o">*</span><span class="n">intf</span><span class="p">);</span>
<span class="p">}</span><span class="w"> </span><span class="n">PyInterface_Base</span><span class="p">;</span>

<span class="c1">// Type slot definition for PyTypeObject field.</span>
<span class="k">typedef</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">Py_getinterfacefunc</span><span class="p">)(</span><span class="n">PyObject</span><span class="w"> </span><span class="o">*</span><span class="n">o</span><span class="p">,</span><span class="w"> </span><span class="n">PyInterface_Base</span><span class="w"> </span><span class="o">*</span><span class="n">intf</span><span class="p">);</span>
</pre></div>
</div>
<p>The unique identifier for the struct is a 64-bit integer defined as a macro (to
ensure that compiled extension modules embed the value, rather than trying to
discover it at runtime). The top 32 bits are the namespace, and implementers
defining their own structs should choose a unique value for themselves. Zero
is reserved for CPython.</p>
<p>The interface name is to identify the struct layout, and so any defined object
can reuse an interface name from another namespace, provided the struct matches.
This is intentional, as it allows third-party types to implement the same
interfaces as core types without having to rely on sharing the implementation.
To be clear, an interface defined for CPython may be used by other extension
modules without changing the name or the name’s namespace.</p>
<p>For example, consider a hypothetical interface to implement
<code class="xref c c-func docutils literal notranslate"><span class="pre">PyDict_GetItemString()</span></code>. The core <code class="docutils literal notranslate"><span class="pre">dict</span></code> type may do internal
optimizations to locate entries by string key, while an external type can use
the same interface to do their own optimization. To the caller, it appears to
use the same interface, and so the caller is compatible with a broader range of
types than if it were using (for example) CPython’s concrete object APIs.</p>
<p>Interface names cannot be removed from headers at any time, and structure
definitions can only be removed when all Stable ABI versions supporting them are
fully retired. However, objects may stop returning a particular interface if it
is no longer recommended or reliable, even if earlier releases did return them.
Runtime deprecation warnings may be used if appropriate, no particular rule is
specified.</p>
<p>Interface structures are fixed and cannot be changed. When a change is required,
a new interface should be defined with a new name. The fields added to a struct
for an interface are public API and should be documented. Fields that are not
intended for direct use should begin with an underscore, but otherwise cannot be
made “private”. Interfaces may provide a mix of data and function pointers, or
use strong <code class="docutils literal notranslate"><span class="pre">PyObject</span> <span class="pre">*</span></code> references to avoid race conditions.</p>
<p>After retrieving an interface, the interface must remain valid until it is
released, even if the reference to the object is freed. The behaviour of the
interface may handle changes to the underlying object however appropriate, but
probably should document its choices. It would not be unreasonable to have two
similar interfaces that handle these kind of changes differently (e.g. one
interface that locks the object for the lifetime of the interface, while another
does not).</p>
<p>The process of adding new Limited APIs changes somewhat: rather than having an
ABI that grows with each release, new APIs may be added as a real function for
when the Limited API is not in use, but should be added as a static inline
function for the Limited API. This static inline function should use an
interface to detect the functionality at runtime, and include an abstract
fallback or suitable exception.</p>
<p>This means that consumers can adopt a new API immediately, compile for the
Limited API with the latest release, and retain binary compatibility for all
releases that support the same Stable ABI.</p>
<p>At the next Stable ABI freeze, the API can either be promoted to the new Stable
ABI/Limited API as a real function, or retained as an interface.</p>
</section>
</section>
<section id="backwards-compatibility">
<h2><a class="toc-backref" href="#backwards-compatibility" role="doc-backlink">Backwards Compatibility</a></h2>
<p>Limited API 3.15 will not be backwards-compatible with older CPython releases,
due to removed structs and functions.</p>
<p>Extension authors who cannot switch may continue to use Limited API 3.14
and below for use on the GIL enabled build.</p>
<p>No changes to <code class="docutils literal notranslate"><span class="pre">abi3</span></code> will be made to the GIL enabled build, and all existing
symbols will remain available, even though these are no longer available under
new Stable ABIs.</p>
<p>Making free-threaded builds the default/only release for CPython will be a
backwards-incompatible change, and extension authors will need to have migrated.</p>
</section>
<section id="security-implications">
<h2><a class="toc-backref" href="#security-implications" role="doc-backlink">Security Implications</a></h2>
<p>None known.</p>
</section>
<section id="how-to-teach-this">
<h2><a class="toc-backref" href="#how-to-teach-this" role="doc-backlink">How to Teach This</a></h2>
<p>The native ABI of Python can be described as a periodically updated standard or
specification, identified by year, similar to other languages. Any extension
module can use this ABI, and declares which ABI they expect as part of their
distribution information. Any Python implementation may choose to support a
particular ABI version, and any extension also supporting that version should be
usable.</p>
<p>Migrating from <code class="docutils literal notranslate"><span class="pre">abi3</span></code> to a new ABI may involve source code changes, but can
be treated as a one-time task. In many, if not most, cases, source code will be
compatible with both <code class="docutils literal notranslate"><span class="pre">abi3</span></code> and the new ABI, simplifying production of builds
for old releases and current releases. In general, <code class="docutils literal notranslate"><span class="pre">abi3</span></code> builds should be
built with the oldest supported CPython runtime, and new ABI builds should be
built with the latest CPython runtime (or another compatible runtime).</p>
<p>Migrating from one ABI (e.g. <code class="docutils literal notranslate"><span class="pre">abi2026</span></code>) to the next (e.g. <code class="docutils literal notranslate"><span class="pre">abi2031</span></code>) should
be a manual task. There is enough overlap between ABI updates that most projects
only need to support one at a time, and can update all of their builds at once
if their own support matrix allows. There is no expectation for package
maintainers to immediately support each new ABI.</p>
<p>Forward-and-backward compatibility is ensured by dynamic interface detection.
Code using recently added limited API functions will run on older releases,
though potentially at lower performance. See the documentation for new functions
to find information about any Limited API-specific nuances.</p>
<p>Non-C callers should use the interfaces mechanism directly to get access to new
features without artificially limiting their compatibility to newer releases.
The names and struct layouts of interfaces are guaranteed stable for all time,
though it should not be assumed that an interface will be available for all
time, and suitable fallback code (either an alternative implementation or error
handling) should be included.</p>
</section>
<section id="reference-implementation">
<h2><a class="toc-backref" href="#reference-implementation" role="doc-backlink">Reference Implementation</a></h2>
<p>See <a class="pep reference internal" href="../pep-0803/" title="PEP 803 – “abi3t”: Stable ABI for Free-Threaded Builds">PEP 803</a> for links to reference implementations for the aspects inherited
from that PEP.</p>
<p>The reference implementation of interfaces is
<a class="reference external" href="https://github.com/zooba/cpython/pull/44/files">zooba/cpython#44</a>.</p>
</section>
<section id="rejected-ideas">
<h2><a class="toc-backref" href="#rejected-ideas" role="doc-backlink">Rejected Ideas</a></h2>
<p>[See discussion for now.]</p>
</section>
<section id="open-issues">
<h2><a class="toc-backref" href="#open-issues" role="doc-backlink">Open Issues</a></h2>
<p>[See discussion for now.]</p>
</section>
<section id="footnotes">
<h2><a class="toc-backref" href="#footnotes" role="doc-backlink">Footnotes</a></h2>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="consumers" role="doc-footnote">
<dt class="label" id="consumers">[<a href="#id1">1</a>]</dt>
<dd>We use the word “consumer” to include anyone who codes against
(“consumes”) the C API. This is predominantly developers of native extension
modules (sometimes “package developers”), but also includes developers of
apps that host CPython and those who interact at runtime with CPython’s
interfaces (such as debuggers or cross-runtime proxy tools).</aside>
</aside>
</section>
<section id="copyright">
<h2><a class="toc-backref" href="#copyright" role="doc-backlink">Copyright</a></h2>
<p>This document is placed in the public domain or under the
CC0-1.0-Universal license, whichever is more permissive.</p>
</section>
</section>
<hr class="docutils" />
<p>Source: <a class="reference external" href="https://github.com/python/peps/blob/main/peps/pep-0809.rst">https://github.com/python/peps/blob/main/peps/pep-0809.rst</a></p>
<p>Last modified: <a class="reference external" href="https://github.com/python/peps/commits/main/peps/pep-0809.rst">2025-10-01 17:55:07 GMT</a></p>

        </article>
        <nav id="pep-sidebar">
            <div id="search"></div>
            <h2>Contents</h2>
            <ul>
<li><a class="reference internal" href="#abstract">Abstract</a></li>
<li><a class="reference internal" href="#terminology">Terminology</a></li>
<li><a class="reference internal" href="#motivation">Motivation</a></li>
<li><a class="reference internal" href="#related-peps">Related PEPs</a></li>
<li><a class="reference internal" href="#background">Background</a></li>
<li><a class="reference internal" href="#rationale">Rationale</a></li>
<li><a class="reference internal" href="#specification">Specification</a><ul>
<li><a class="reference internal" href="#abi-stability">ABI Stability</a></li>
<li><a class="reference internal" href="#opaque-pyobject">Opaque PyObject</a></li>
<li><a class="reference internal" href="#new-export-hook-pep-793">New Export Hook (PEP 793)</a></li>
<li><a class="reference internal" href="#runtime-abi-checks">Runtime ABI checks</a></li>
<li><a class="reference internal" href="#build-time-macros">Build-time macros</a></li>
<li><a class="reference internal" href="#wheel-tags">Wheel tags</a></li>
<li><a class="reference internal" href="#new-api">New API</a></li>
<li><a class="reference internal" href="#interfaces-api">Interfaces API</a></li>
</ul>
</li>
<li><a class="reference internal" href="#backwards-compatibility">Backwards Compatibility</a></li>
<li><a class="reference internal" href="#security-implications">Security Implications</a></li>
<li><a class="reference internal" href="#how-to-teach-this">How to Teach This</a></li>
<li><a class="reference internal" href="#reference-implementation">Reference Implementation</a></li>
<li><a class="reference internal" href="#rejected-ideas">Rejected Ideas</a></li>
<li><a class="reference internal" href="#open-issues">Open Issues</a></li>
<li><a class="reference internal" href="#footnotes">Footnotes</a></li>
<li><a class="reference internal" href="#copyright">Copyright</a></li>
</ul>

            <br>
            <a id="source" href="https://github.com/python/peps/blob/main/peps/pep-0809.rst?plain=1">Page Source (GitHub)</a>
        </nav>
    </section>
    <script src="../_static/colour_scheme.js"></script>
    <script src="../_static/wrap_tables.js"></script>
    <script src="../_static/sticky_banner.js"></script>
    <script src="https://analytics.python.org/js/script.outbound-links.js"
            data-domain="peps.python.org" defer></script>
    <script src="/pagefind/pagefind-ui.js"></script>
    <script>
        window.addEventListener('DOMContentLoaded', (event) => {
            // Ranking configuration to boost exact title matches
            const searchOptions = {
                ranking: {
                    termSimilarity: 9.0, // Higher values favor exact matches
                    termFrequency: 0.5, // Lower values reduce penalty for low term frequency
                    pageLength: 0.2, // Lower values reduce the impact of page length
                }
            };

            // Initialize pagefind for either mobile or desktop, not both
            if (window.innerWidth <= 640) {
                new PagefindUI({ element: "#mobile-search", ...searchOptions, showSubResults: false });
            } else {
                new PagefindUI({ element: "#search", ...searchOptions, showSubResults: true });
            }
        });
    </script>
</body>
</html>