
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="color-scheme" content="light dark">
    <title>PEP 783 – Emscripten Packaging | peps.python.org</title>
    <link rel="shortcut icon" href="../_static/py.png">
    <link rel="canonical" href="https://peps.python.org/pep-0783/">
    <link rel="stylesheet" href="../_static/style.css" type="text/css">
    <link rel="stylesheet" href="../_static/mq.css" type="text/css">
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" media="(prefers-color-scheme: light)" id="pyg-light">
    <link rel="stylesheet" href="../_static/pygments_dark.css" type="text/css" media="(prefers-color-scheme: dark)" id="pyg-dark">
    <link rel="alternate" type="application/rss+xml" title="Latest PEPs" href="https://peps.python.org/peps.rss">
    <meta property="og:title" content='PEP 783 – Emscripten Packaging | peps.python.org'>
    <meta property="og:description" content="This PEP proposes a new platform tag series pyodide for binary Python package distributions for the Pyodide Python runtime.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://peps.python.org/pep-0783/">
    <meta property="og:site_name" content="Python Enhancement Proposals (PEPs)">
    <meta property="og:image" content="https://peps.python.org/_static/og-image.png">
    <meta property="og:image:alt" content="Python PEPs">
    <meta property="og:image:width" content="200">
    <meta property="og:image:height" content="200">
    <meta name="description" content="This PEP proposes a new platform tag series pyodide for binary Python package distributions for the Pyodide Python runtime.">
    <meta name="theme-color" content="#3776ab">
</head>
<body>
    
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-sun-half" viewBox="0 0 24 24" pointer-events="all">
    <title>Following system colour scheme</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none"
         stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <circle cx="12" cy="12" r="9"></circle>
      <path d="M12 3v18m0-12l4.65-4.65M12 14.3l7.37-7.37M12 19.6l8.85-8.85"></path>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24" pointer-events="all">
    <title>Selected dark colour scheme</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none"
         stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z"></path>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24" pointer-events="all">
    <title>Selected light colour scheme</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none"
         stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
</svg>
    <script>

        document.documentElement.dataset.colour_scheme = localStorage.getItem("colour_scheme") || "auto"
    </script>
    <section id="pep-page-section">
        <header>
            <h1>Python Enhancement Proposals</h1>
            <ul class="breadcrumbs">
                <li><a href="https://www.python.org/" title="The Python Programming Language">Python</a> &raquo; </li>
                <li><a href="../pep-0000/">PEP Index</a> &raquo; </li>
                <li>PEP 783</li>
            </ul>
            <button id="colour-scheme-cycler" onClick="setColourScheme(nextColourScheme())">
                <svg aria-hidden="true" class="colour-scheme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
                <svg aria-hidden="true" class="colour-scheme-icon-when-dark"><use href="#svg-moon"></use></svg>
                <svg aria-hidden="true" class="colour-scheme-icon-when-light"><use href="#svg-sun"></use></svg>
                <span class="visually-hidden">Toggle light / dark / auto colour theme</span>
            </button>
        </header>
        <article>
            <section id="pep-content">
<h1 class="page-title">PEP 783 – Emscripten Packaging</h1>
<dl class="rfc2822 field-list simple">
<dt class="field-odd">Author<span class="colon">:</span></dt>
<dd class="field-odd">Hood Chatham &lt;roberthoodchatham at gmail.com&gt;</dd>
<dt class="field-even">Sponsor<span class="colon">:</span></dt>
<dd class="field-even">Łukasz Langa &lt;lukasz at python.org&gt;</dd>
<dt class="field-odd">Discussions-To<span class="colon">:</span></dt>
<dd class="field-odd"><a class="reference external" href="https://discuss.python.org/t/86862">Discourse thread</a></dd>
<dt class="field-even">Status<span class="colon">:</span></dt>
<dd class="field-even"><abbr title="Proposal under active discussion and revision">Draft</abbr></dd>
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><abbr title="Normative PEP with a new feature for Python, implementation change for CPython or interoperability standard for the ecosystem">Standards Track</abbr></dd>
<dt class="field-even">Topic<span class="colon">:</span></dt>
<dd class="field-even"><a class="reference external" href="../topic/packaging/">Packaging</a></dd>
<dt class="field-odd">Created<span class="colon">:</span></dt>
<dd class="field-odd">28-Mar-2025</dd>
<dt class="field-even">Post-History<span class="colon">:</span></dt>
<dd class="field-even"><a class="reference external" href="https://discuss.python.org/t/86862" title="Discourse thread">02-Apr-2025</a>,
<a class="reference external" href="https://discuss.python.org/t/84996" title="Discourse thread">18-Mar-2025</a></dd>
</dl>
<hr class="docutils" />
<section id="contents">
<details><summary>Table of Contents</summary><ul class="simple">
<li><a class="reference internal" href="#abstract">Abstract</a></li>
<li><a class="reference internal" href="#motivation">Motivation</a></li>
<li><a class="reference internal" href="#rationale">Rationale</a></li>
<li><a class="reference internal" href="#specification">Specification</a><ul>
<li><a class="reference internal" href="#emscripten-wheel-abi">Emscripten Wheel ABI</a></li>
<li><a class="reference internal" href="#determining-the-abi-version">Determining the ABI version</a></li>
<li><a class="reference internal" href="#package-installers">Package Installers</a></li>
<li><a class="reference internal" href="#package-indexes">Package Indexes</a></li>
<li><a class="reference internal" href="#dependency-specifier-markers">Dependency Specifier Markers</a></li>
<li><a class="reference internal" href="#trove-classifier">Trove Classifier</a></li>
</ul>
</li>
<li><a class="reference internal" href="#backwards-compatibility">Backwards Compatibility</a></li>
<li><a class="reference internal" href="#security-implications">Security Implications</a></li>
<li><a class="reference internal" href="#how-to-teach-this">How to Teach This</a></li>
<li><a class="reference internal" href="#reference-implementation">Reference Implementation</a></li>
<li><a class="reference internal" href="#copyright">Copyright</a></li>
</ul>
</details></section>
<section id="abstract">
<h2><a class="toc-backref" href="#abstract" role="doc-backlink">Abstract</a></h2>
<p>This PEP proposes a new platform tag series <code class="docutils literal notranslate"><span class="pre">pyodide</span></code> for binary Python package
distributions for the Pyodide Python runtime.</p>
<p><a class="reference external" href="https://emscripten.org/">Emscripten</a> is a complete open-source compiler
toolchain. It compiles C/C++ code into WebAssembly/JavaScript executables, for
use in JavaScript runtimes, including browsers and Node.js. The Rust language
also maintains an Emscripten target. <a class="pep reference internal" href="../pep-0776/" title="PEP 776 – Emscripten Support">PEP 776</a> specifies Python’s support for
Emscripten.</p>
</section>
<section id="motivation">
<h2><a class="toc-backref" href="#motivation" role="doc-backlink">Motivation</a></h2>
<p>Pyodide is a CPython distribution for use in the browser. A web browser is a
universal computing platform, available on Windows, macOS, Linux, and every
smartphone. Hundreds of thousands of students have learned Python through
Pyodide via projects like <a class="reference external" href="https://web.archive.org/web/20241211090946/https://cfp.jupytercon.com/2023/talk/TJ9YEV/">Capytale</a>
and <a class="reference external" href="https://stanford.edu/~cpiech/bio/papers/pyodideU.pdf">PyodideU</a>. Pyodide
is also increasingly being used by Python packages to provide interactive
documentation.</p>
<p>Pyodide currently maintains ports of 255 different packages at the time of this
writing, including major scientific Python packages like NumPy, SciPy, pandas,
Polars, scikit-learn, OpenCV, PyArrow, and Pillow as well as general purpose
packages like aiohttp, Requests, Pydantic, cryptography, and orjson.</p>
<p>About 60 packages are also testing against Pyodide in their CI, including NumPy,
pandas, awkward-cpp, scikit-image, statsmodels, PyArrow, Hypothesis, and PyO3.</p>
<p>Python package projects cannot deploy binary distributions for Pyodide on PyPI.
Instead they must use other options like <code class="docutils literal notranslate"><span class="pre">anaconda.org</span></code> or <code class="docutils literal notranslate"><span class="pre">jsdelivr.com</span></code>.
This creates friction both for package maintainers and for users.</p>
</section>
<section id="rationale">
<h2><a class="toc-backref" href="#rationale" role="doc-backlink">Rationale</a></h2>
<p>Emscripten uses a variant of musl libc. The Emscripten compiler makes no ABI
stability guarantees between versions. Many Emscripten updates are ABI
compatible by chance, and the Rust Emscripten target behaves as if the ABI were
stable with only <a class="reference external" href="https://github.com/rust-lang/rust/issues/131467">occasional negative consequences</a>.</p>
<p>There are several linker flags that adjust the Emscripten ABI, so Python
packages built to run with Emscripten must make sure to match the ABI-sensitive
linker flags used to compile the interpreter to avoid load-time or run-time
errors. The Emscripten compiler continuously fixes bugs and adds support for new
web platform features. Thus, there is significant benefit to being able to
update the ABI.</p>
<p>In order to balance the ABI stability needs of package maintainers with the ABI
flexibility to allow the platform to move forward, Pyodide plans to adopt a new
ABI for each feature release of Python.</p>
<p>The Pyodide team also coordinates the ABI flags that Pyodide uses with the
Emscripten ABI that Rust supports in order to ensure that we have support for
the many popular Rust packages. Historically, most of the work for this has
been related to unwinding ABIs. See for instance <a class="reference external" href="https://github.com/rust-lang/compiler-team/issues/801">this Rust Major Change
Proposal</a>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">pyodide</span></code> platform tags only apply to Python interpreters compiled and
linked with the same version of Emscripten as Pyodide, with the same
ABI-sensitive flags.</p>
</section>
<section id="specification">
<h2><a class="toc-backref" href="#specification" role="doc-backlink">Specification</a></h2>
<p>The platform tags will take the form:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>pyodide_${YEAR}_${PATCH}_wasm32
</pre></div>
</div>
<p>Each one of these will be used with a specified Python version. For example, the
platform tag <code class="docutils literal notranslate"><span class="pre">pyodide_2025_0</span></code> will be used with Python 3.13.</p>
<section id="emscripten-wheel-abi">
<h3><a class="toc-backref" href="#emscripten-wheel-abi" role="doc-backlink">Emscripten Wheel ABI</a></h3>
<p>The specification of the <code class="docutils literal notranslate"><span class="pre">pyodide_&lt;abi&gt;</span></code> platform includes:</p>
<ul class="simple">
<li>Which version of the Emscripten compiler is used</li>
<li>What libraries are statically linked with the interpreter</li>
<li>What stack unwinding ABI is to be used</li>
<li>How the loader handles dependency lookup</li>
<li>That libraries cannot use <code class="docutils literal notranslate"><span class="pre">-pthread</span></code></li>
<li>That libraries should be linked with <code class="docutils literal notranslate"><span class="pre">-sWASM_BIGINT</span></code></li>
</ul>
<p>The ABI is selected by choosing the appropriate version of the Emscripten
compiler and passing appropriate compiler and linker flags. It is possible for
other people to build their own Python interpreter that is compatible with the
Pyodide ABI, it is not necessary to use the Pyodide distribution itself.</p>
<p>The Pyodide ABIs are fully specified in the <a class="reference external" href="https://pyodide.org/en/stable/development/abi.html">Pyodide Platform ABI</a> documentation.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">pyodide</span> <span class="pre">build</span></code> tool knows how to create wheels that match the Pyodide
ABI. Unlike with manylinux wheels, there is no need for a Docker container to
build the <code class="docutils literal notranslate"><span class="pre">pyodide_&lt;abi&gt;</span></code> wheels. All that is needed is a Linux machine and
appropriate versions of Python, Node.js, and Emscripten.</p>
<p>It is possible to validate a wheel by installing and importing it into the
Pyodide runtime. Because Pyodide can run in an environment with strong
sandboxing guarantees, doing this produces no security risks.</p>
</section>
<section id="determining-the-abi-version">
<h3><a class="toc-backref" href="#determining-the-abi-version" role="doc-backlink">Determining the ABI version</a></h3>
<p>The Pyodide ABI version is stored in the <code class="docutils literal notranslate"><span class="pre">PYODIDE_ABI_VERSION</span></code> config variable
and can be determined via:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pyodide_abi_version</span> <span class="o">=</span> <span class="n">sysconfig</span><span class="o">.</span><span class="n">get_config_var</span><span class="p">(</span><span class="s2">&quot;PYODIDE_ABI_VERSION&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>To generate the list of compatible tags, one can use the following code:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">packaging.tags</span><span class="w"> </span><span class="kn">import</span> <span class="n">cpython_tags</span><span class="p">,</span> <span class="n">_generic_platforms</span>

<span class="k">def</span><span class="w"> </span><span class="nf">_emscripten_platforms</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
    <span class="n">pyodide_abi_version</span> <span class="o">=</span> <span class="n">sysconfig</span><span class="o">.</span><span class="n">get_config_var</span><span class="p">(</span><span class="s2">&quot;PYODIDE_ABI_VERSION&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">pyodide_abi_version</span><span class="p">:</span>
        <span class="k">yield</span> <span class="sa">f</span><span class="s2">&quot;pyodide_</span><span class="si">{</span><span class="n">pyodide_abi_version</span><span class="si">}</span><span class="s2">_wasm32&quot;</span>
    <span class="k">yield from</span> <span class="n">_generic_platforms</span><span class="p">()</span>

<span class="n">emscripten_tags</span> <span class="o">=</span> <span class="n">cpython_tags</span><span class="p">(</span><span class="n">platforms</span><span class="o">=</span><span class="n">_emscripten_platforms</span><span class="p">())</span>
</pre></div>
</div>
<p>This code will be added to <a class="reference external" href="https://github.com/pypa/packaging/pull/804">pypa/packaging</a>.</p>
</section>
<section id="package-installers">
<h3><a class="toc-backref" href="#package-installers" role="doc-backlink">Package Installers</a></h3>
<p>Installers should use the <code class="docutils literal notranslate"><span class="pre">_emscripten_platforms()</span></code> function shown above to
determine which platforms are compatible with an Emscripten build of CPython. In
particular, the Pyodide ABI version is exposed via
<code class="docutils literal notranslate"><span class="pre">sysconfig.get_config_var(&quot;PYODIDE_ABI_VERSION&quot;)</span></code>.</p>
</section>
<section id="package-indexes">
<h3><a class="toc-backref" href="#package-indexes" role="doc-backlink">Package Indexes</a></h3>
<p>Package indexes SHOULD accept any wheel whose platform tag matches
the regular expression <code class="docutils literal notranslate"><span class="pre">pyodide_[0-9]+_[0-9]+_wasm32</span></code>.</p>
</section>
<section id="dependency-specifier-markers">
<h3><a class="toc-backref" href="#dependency-specifier-markers" role="doc-backlink">Dependency Specifier Markers</a></h3>
<p>According to <a class="pep reference internal" href="../pep-0776/#platform-identification" title="PEP 776 – Emscripten Support § Platform Identification">PEP 776</a>, in Emscripten Python
<code class="docutils literal notranslate"><span class="pre">sys.platform</span></code> returns <code class="docutils literal notranslate"><span class="pre">&quot;emscripten&quot;</span></code>. To check for the Emscripten platform in a
dependency specifier, one can use <code class="docutils literal notranslate"><span class="pre">sys_platform</span> <span class="pre">==</span> <span class="pre">&quot;emscripten&quot;</span></code> (or its
negation).</p>
</section>
<section id="trove-classifier">
<h3><a class="toc-backref" href="#trove-classifier" role="doc-backlink">Trove Classifier</a></h3>
<p>Packages that build and test Emscripten wheels can declare this by adding the
<code class="docutils literal notranslate"><span class="pre">Environment</span> <span class="pre">::</span> <span class="pre">WebAssembly</span> <span class="pre">::</span> <span class="pre">Emscripten</span></code> classifier. PyPI already accepts uploads of
<a class="reference external" href="https://pypi.org/search/?q=&amp;o=&amp;c=Environment+%3A%3A+WebAssembly+%3A%3A+Emscripten">packages with this classifier</a>.</p>
</section>
</section>
<section id="backwards-compatibility">
<h2><a class="toc-backref" href="#backwards-compatibility" role="doc-backlink">Backwards Compatibility</a></h2>
<p>There are no backwards compatibility concerns in this PEP.</p>
</section>
<section id="security-implications">
<h2><a class="toc-backref" href="#security-implications" role="doc-backlink">Security Implications</a></h2>
<p>There are no security implications in this PEP.</p>
</section>
<section id="how-to-teach-this">
<h2><a class="toc-backref" href="#how-to-teach-this" role="doc-backlink">How to Teach This</a></h2>
<p>For Pyodide users, we recommend the <a class="reference external" href="https://pyodide.org/en/stable/usage/loading-packages.html">Pyodide documentation on installing
packages</a>.</p>
<p>For package maintainers, we recommend the <a class="reference external" href="https://pyodide.org/en/stable/development/building-and-testing-packages.html">Pyodide documentation on building and
testing packages</a>.</p>
</section>
<section id="reference-implementation">
<h2><a class="toc-backref" href="#reference-implementation" role="doc-backlink">Reference Implementation</a></h2>
<p>For building packages, <a class="reference external" href="https://github.com/pyodide/pyodide-build">pyodide build</a> and <a class="reference external" href="https://github.com/pypa/cibuildwheel/">cibuildwheel</a>.</p>
<p>For installers to decide whether a wheel tag is compatible with a Pyodide
interpreter, <a class="reference external" href="https://github.com/pypa/packaging/pull/804">pypa/packaging#804</a>.</p>
</section>
<section id="copyright">
<h2><a class="toc-backref" href="#copyright" role="doc-backlink">Copyright</a></h2>
<p>This document is placed in the public domain or under the
CC0-1.0-Universal license, whichever is more permissive.</p>
</section>
</section>
<hr class="docutils" />
<p>Source: <a class="reference external" href="https://github.com/python/peps/blob/main/peps/pep-0783.rst">https://github.com/python/peps/blob/main/peps/pep-0783.rst</a></p>
<p>Last modified: <a class="reference external" href="https://github.com/python/peps/commits/main/peps/pep-0783.rst">2025-04-07 10:40:17 GMT</a></p>

        </article>
        <nav id="pep-sidebar">
            <h2>Contents</h2>
            <ul>
<li><a class="reference internal" href="#abstract">Abstract</a></li>
<li><a class="reference internal" href="#motivation">Motivation</a></li>
<li><a class="reference internal" href="#rationale">Rationale</a></li>
<li><a class="reference internal" href="#specification">Specification</a><ul>
<li><a class="reference internal" href="#emscripten-wheel-abi">Emscripten Wheel ABI</a></li>
<li><a class="reference internal" href="#determining-the-abi-version">Determining the ABI version</a></li>
<li><a class="reference internal" href="#package-installers">Package Installers</a></li>
<li><a class="reference internal" href="#package-indexes">Package Indexes</a></li>
<li><a class="reference internal" href="#dependency-specifier-markers">Dependency Specifier Markers</a></li>
<li><a class="reference internal" href="#trove-classifier">Trove Classifier</a></li>
</ul>
</li>
<li><a class="reference internal" href="#backwards-compatibility">Backwards Compatibility</a></li>
<li><a class="reference internal" href="#security-implications">Security Implications</a></li>
<li><a class="reference internal" href="#how-to-teach-this">How to Teach This</a></li>
<li><a class="reference internal" href="#reference-implementation">Reference Implementation</a></li>
<li><a class="reference internal" href="#copyright">Copyright</a></li>
</ul>

            <br>
            <a id="source" href="https://github.com/python/peps/blob/main/peps/pep-0783.rst?plain=1">Page Source (GitHub)</a>
        </nav>
    </section>
    <script src="../_static/colour_scheme.js"></script>
    <script src="../_static/wrap_tables.js"></script>
    <script src="../_static/sticky_banner.js"></script>
    <script src="https://analytics.python.org/js/script.outbound-links.js"
            data-domain="peps.python.org" defer></script>
</body>
</html>