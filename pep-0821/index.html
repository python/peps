
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="color-scheme" content="light dark">
    <title>PEP 821 – Support for unpacking TypedDicts in Callable type hints | peps.python.org</title>
    <link rel="shortcut icon" href="../_static/py.png">
    <link rel="canonical" href="https://peps.python.org/pep-0821/">
    <link rel="stylesheet" href="../_static/style.css" type="text/css">
    <link rel="stylesheet" href="../_static/mq.css" type="text/css">
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" media="(prefers-color-scheme: light)" id="pyg-light">
    <link rel="stylesheet" href="../_static/pygments_dark.css" type="text/css" media="(prefers-color-scheme: dark)" id="pyg-dark">
    <link rel="alternate" type="application/rss+xml" title="Latest PEPs" href="https://peps.python.org/peps.rss">
    <meta property="og:title" content='PEP 821 – Support for unpacking TypedDicts in Callable type hints | peps.python.org'>
    <meta property="og:description" content="This PEP proposes allowing Unpack[TypedDict] in the parameter list inside Callable, enabling concise and type-safe ways to describe keyword-only callable signatures. Currently, Callable assumes positional-only parameters, and typing keyword-only functio...">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://peps.python.org/pep-0821/">
    <meta property="og:site_name" content="Python Enhancement Proposals (PEPs)">
    <meta property="og:image" content="https://peps.python.org/_static/og-image.png">
    <meta property="og:image:alt" content="Python PEPs">
    <meta property="og:image:width" content="200">
    <meta property="og:image:height" content="200">
    <meta name="description" content="This PEP proposes allowing Unpack[TypedDict] in the parameter list inside Callable, enabling concise and type-safe ways to describe keyword-only callable signatures. Currently, Callable assumes positional-only parameters, and typing keyword-only functio...">
    <meta name="theme-color" content="#3776ab">
</head>
<body>
    
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-sun-half" viewBox="0 0 24 24" pointer-events="all">
    <title>Following system colour scheme</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none"
         stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <circle cx="12" cy="12" r="9"></circle>
      <path d="M12 3v18m0-12l4.65-4.65M12 14.3l7.37-7.37M12 19.6l8.85-8.85"></path>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24" pointer-events="all">
    <title>Selected dark colour scheme</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none"
         stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z"></path>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24" pointer-events="all">
    <title>Selected light colour scheme</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none"
         stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
</svg>
    <script>

        document.documentElement.dataset.colour_scheme = localStorage.getItem("colour_scheme") || "auto"
    </script>
    <section id="pep-page-section">
        <header>
            <h1 data-pagefind-ignore>Python Enhancement Proposals</h1>
            <ul class="breadcrumbs">
                <li><a href="https://www.python.org/" title="The Python Programming Language">Python</a> &raquo; </li>
                <li><a href="../pep-0000/">PEP Index</a> &raquo; </li>
                <li>PEP 821</li>
            </ul>
            <button id="colour-scheme-cycler" onClick="setColourScheme(nextColourScheme())">
                <svg aria-hidden="true" class="colour-scheme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
                <svg aria-hidden="true" class="colour-scheme-icon-when-dark"><use href="#svg-moon"></use></svg>
                <svg aria-hidden="true" class="colour-scheme-icon-when-light"><use href="#svg-sun"></use></svg>
                <span class="visually-hidden">Toggle light / dark / auto colour theme</span>
            </button>
        </header>
        
        <div id="mobile-search" class="mobile-search-container"></div>
        
        <article data-pagefind-body>
            
            <span data-pagefind-meta="title:PEP 821 – Support for unpacking TypedDicts in Callable type hints" data-pagefind-weight="10" class="visually-hidden">PEP 821 – Support for unpacking TypedDicts in Callable type hints</span>
            <section id="pep-content">
<h1 class="page-title">PEP 821 – Support for unpacking TypedDicts in Callable type hints</h1>
<dl class="rfc2822 field-list simple">
<dt class="field-odd">Author<span class="colon">:</span></dt>
<dd class="field-odd">Daniel Sperber &lt;github.blurry&#32;&#97;t&#32;9ox.net&gt;</dd>
<dt class="field-even">Sponsor<span class="colon">:</span></dt>
<dd class="field-even">Jelle Zijlstra &lt;jelle.zijlstra&#32;&#97;t&#32;gmail.com&gt;</dd>
<dt class="field-odd">Discussions-To<span class="colon">:</span></dt>
<dd class="field-odd"><a class="reference external" href="https://discuss.python.org/t/105952">Discourse thread</a></dd>
<dt class="field-even">Status<span class="colon">:</span></dt>
<dd class="field-even"><abbr title="Proposal under active discussion and revision">Draft</abbr></dd>
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><abbr title="Normative PEP with a new feature for Python, implementation change for CPython or interoperability standard for the ecosystem">Standards Track</abbr></dd>
<dt class="field-even">Topic<span class="colon">:</span></dt>
<dd class="field-even"><a class="reference external" href="../topic/typing/">Typing</a></dd>
<dt class="field-odd">Created<span class="colon">:</span></dt>
<dd class="field-odd">12-Jan-2026</dd>
<dt class="field-even">Python-Version<span class="colon">:</span></dt>
<dd class="field-even">3.15</dd>
<dt class="field-odd">Post-History<span class="colon">:</span></dt>
<dd class="field-odd"><a class="reference external" href="https://discuss.python.org/t/96975" title="Discourse thread">28-Jun-2025</a>,
<a class="reference external" href="https://discuss.python.org/t/105952" title="Discourse thread">31-Jan-2026</a></dd>
</dl>
<hr class="docutils" />
<section id="contents">
<details><summary>Table of Contents</summary><ul class="simple">
<li><a class="reference internal" href="#abstract">Abstract</a></li>
<li><a class="reference internal" href="#motivation">Motivation</a></li>
<li><a class="reference internal" href="#rationale">Rationale</a><ul>
<li><a class="reference internal" href="#design-goals">Design goals</a></li>
<li><a class="reference internal" href="#alternatives-considered">Alternatives considered</a></li>
<li><a class="reference internal" href="#design-trade-offs-and-decisions">Design trade-offs and decisions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#specification">Specification</a><ul>
<li><a class="reference internal" href="#new-allowed-form">New allowed form</a></li>
<li><a class="reference internal" href="#semantics">Semantics</a></li>
<li><a class="reference internal" href="#examples">Examples</a></li>
<li><a class="reference internal" href="#optional-arguments">Optional arguments</a></li>
<li><a class="reference internal" href="#additional-keyword-arguments">Additional keyword arguments</a><ul>
<li><a class="reference internal" href="#default-behavior-no-extra-items-or-closed">Default Behavior (no <code class="docutils literal notranslate"><span class="pre">extra_items</span></code> or <code class="docutils literal notranslate"><span class="pre">closed</span></code>)</a></li>
<li><a class="reference internal" href="#closed-behavior-pep-728"><code class="docutils literal notranslate"><span class="pre">closed</span></code> behavior (PEP 728)</a></li>
<li><a class="reference internal" href="#interaction-with-extra-items-pep-728">Interaction with <code class="docutils literal notranslate"><span class="pre">extra_items</span></code> (PEP 728)</a></li>
<li><a class="reference internal" href="#interaction-with-paramspec-and-concatenate">Interaction with <code class="docutils literal notranslate"><span class="pre">ParamSpec</span></code> and <code class="docutils literal notranslate"><span class="pre">Concatenate</span></code></a></li>
<li><a class="reference internal" href="#combined-positional-parameters-and-unpack">Combined positional parameters and <code class="docutils literal notranslate"><span class="pre">Unpack</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#backwards-compatibility">Backwards Compatibility</a></li>
<li><a class="reference internal" href="#how-to-teach-this">How to Teach This</a></li>
<li><a class="reference internal" href="#reference-implementation">Reference Implementation</a></li>
<li><a class="reference internal" href="#rejected-ideas">Rejected Ideas</a></li>
<li><a class="reference internal" href="#open-questions">Open Questions</a></li>
<li><a class="reference internal" href="#acknowledgements">Acknowledgements</a></li>
<li><a class="reference internal" href="#references">References</a></li>
<li><a class="reference internal" href="#copyright">Copyright</a></li>
</ul>
</details></section>
<section id="abstract">
<h2><a class="toc-backref" href="#abstract" role="doc-backlink">Abstract</a></h2>
<p>This PEP proposes allowing <code class="docutils literal notranslate"><span class="pre">Unpack[TypedDict]</span></code> in the parameter list inside
<code class="docutils literal notranslate"><span class="pre">Callable</span></code>, enabling concise and type-safe ways to describe keyword-only
callable signatures. Currently, <code class="docutils literal notranslate"><span class="pre">Callable</span></code> assumes positional-only
parameters, and typing keyword-only functions requires verbose callback
protocols. With this proposal, the keyword structure defined by a <code class="docutils literal notranslate"><span class="pre">TypedDict</span></code>
can be reused directly in <code class="docutils literal notranslate"><span class="pre">Callable</span></code>.</p>
</section>
<section id="motivation">
<h2><a class="toc-backref" href="#motivation" role="doc-backlink">Motivation</a></h2>
<p>The <a class="reference external" href="https://typing.python.org/en/latest/spec/callables.html#callable" title="(in typing)"><span class="xref std std-ref">typing specification</span></a> states:</p>
<blockquote>
<div>“Parameters specified using Callable are assumed to be positional-only.
The Callable form provides no way to specify keyword-only parameters,
or default argument values. For these use cases, see the section on Callback
protocols.”</div></blockquote>
<p>This limitation makes it cumbersome to declare callables meant to be invoked
with keyword arguments. The existing solution is to define a <code class="docutils literal notranslate"><span class="pre">Protocol</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">KeywordTD</span><span class="p">(</span><span class="n">TypedDict</span><span class="p">,</span> <span class="n">closed</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="n">a</span><span class="p">:</span> <span class="nb">int</span>

<span class="k">class</span><span class="w"> </span><span class="nc">KwCallable</span><span class="p">(</span><span class="n">Protocol</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Unpack</span><span class="p">[</span><span class="n">KeywordTD</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span> <span class="o">...</span>

<span class="c1"># or</span>

<span class="k">class</span><span class="w"> </span><span class="nc">KwCallable</span><span class="p">(</span><span class="n">Protocol</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">a</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span> <span class="o">...</span>
</pre></div>
</div>
<p>This works but is verbose. The new syntax allows the equivalent to be written
more succinctly:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span> <span class="n">KwCallable</span> <span class="o">=</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Unpack</span><span class="p">[</span><span class="n">KeywordTD</span><span class="p">]],</span> <span class="n">Any</span><span class="p">]</span>
</pre></div>
</div>
</section>
<section id="rationale">
<h2><a class="toc-backref" href="#rationale" role="doc-backlink">Rationale</a></h2>
<section id="design-goals">
<h3><a class="toc-backref" href="#design-goals" role="doc-backlink">Design goals</a></h3>
<p>The primary goal is to make the common pattern of “callbacks that are intended
to be called with specific keyword arguments” straightforward to express with
<code class="docutils literal notranslate"><span class="pre">Callable</span></code>. Today, such callbacks must be written as a <code class="docutils literal notranslate"><span class="pre">Protocol</span></code> with a
<code class="docutils literal notranslate"><span class="pre">__call__</span></code> that uses <code class="docutils literal notranslate"><span class="pre">**kwargs:</span> <span class="pre">Unpack[...]</span></code> or includes each keyword
parameter explicitly. This approach is verbose and inconsistent
with how positional variadics are supported: per <a class="pep reference internal" href="../pep-0646/" title="PEP 646 – Variadic Generics">PEP 646</a>, <code class="docutils literal notranslate"><span class="pre">*args</span></code> can be
expressed as <code class="docutils literal notranslate"><span class="pre">*tuple[int,</span> <span class="pre">...]</span></code> inside <code class="docutils literal notranslate"><span class="pre">Callable</span></code>.</p>
<p>Allowing <code class="docutils literal notranslate"><span class="pre">Unpack[TypedDict]</span></code> inside <code class="docutils literal notranslate"><span class="pre">Callable</span></code> achieves the following:</p>
<ul class="simple">
<li>Preserves the familiar <code class="docutils literal notranslate"><span class="pre">Callable[[...],</span> <span class="pre">R]</span></code> shape while enabling
keyword-only parameter descriptions.</li>
<li>Provides a concise shorthand equivalent to Protocol-based callbacks with
<code class="docutils literal notranslate"><span class="pre">__call__(self,</span> <span class="pre">**kwargs:</span> <span class="pre">Unpack[TD])</span> <span class="pre">-&gt;</span> <span class="pre">R</span></code>.</li>
<li>Provides the intuitive analogue to positional variadics.</li>
<li>Reuses existing building blocks and keeps semantics predictable. It aligns
with existing semantics from <a class="pep reference internal" href="../pep-0692/" title="PEP 692 – Using TypedDict for more precise **kwargs typing">PEP 692</a> (<code class="docutils literal notranslate"><span class="pre">Unpack</span></code> for <code class="docutils literal notranslate"><span class="pre">**kwargs</span></code>) and
<a class="pep reference internal" href="../pep-0728/" title="PEP 728 – TypedDict with Typed Extra Items">PEP 728</a> (<code class="docutils literal notranslate"><span class="pre">extra_items</span></code> and <code class="docutils literal notranslate"><span class="pre">closed</span></code>).</li>
<li>Keeps the feature additive, backwards compatible, and stays mostly a
typing-specification change only.</li>
</ul>
</section>
<section id="alternatives-considered">
<h3><a class="toc-backref" href="#alternatives-considered" role="doc-backlink">Alternatives considered</a></h3>
<ol class="arabic simple">
<li>Continue recommending <code class="docutils literal notranslate"><span class="pre">Protocol</span></code>-based callbacks only.
This keeps the status quo and avoids changing <code class="docutils literal notranslate"><span class="pre">Callable</span></code>. However, it is
syntactically heavier and duplicates concepts already present in
<code class="docutils literal notranslate"><span class="pre">Callable</span></code>.</li>
<li>Introduce a new <code class="docutils literal notranslate"><span class="pre">Callable</span></code> syntax for keywords (e.g., dedicated keyword
parameter markers inside <code class="docutils literal notranslate"><span class="pre">Callable</span></code>).
This would require extending the callable parameter grammar with new
constructs, creating fresh semantics for optionality, defaults, and extra
keywords. The design space overlaps with <code class="docutils literal notranslate"><span class="pre">TypedDict</span></code> and <a class="pep reference internal" href="../pep-0692/" title="PEP 692 – Using TypedDict for more precise **kwargs typing">PEP 692</a> and
risks divergent behavior from existing <code class="docutils literal notranslate"><span class="pre">**kwargs</span></code> typing.</li>
<li>Adopt callback literal syntax (cf. <a class="pep reference internal" href="../pep-0677/" title="PEP 677 – Callable Type Syntax">PEP 677</a>) to express rich signatures
inline. Literal syntax can improve readability but introduces a larger,
orthogonal change. This PEP seeks a focused, minimal extension that works
within <code class="docutils literal notranslate"><span class="pre">Callable</span></code> and existing typing semantics.</li>
</ol>
</section>
<section id="design-trade-offs-and-decisions">
<h3><a class="toc-backref" href="#design-trade-offs-and-decisions" role="doc-backlink">Design trade-offs and decisions</a></h3>
<ul class="simple">
<li>Positional parameters: Allowing positional parameters to precede
<code class="docutils literal notranslate"><span class="pre">Unpack[TD]</span></code> retains existing <code class="docutils literal notranslate"><span class="pre">Callable</span></code> semantics and mirrors real
Python functions where positional and keyword-only parameters coexist.</li>
<li><code class="docutils literal notranslate"><span class="pre">Concatenate</span></code>: Combining <code class="docutils literal notranslate"><span class="pre">Unpack[TD]</span></code> with <code class="docutils literal notranslate"><span class="pre">Concatenate</span></code> would enable
interspersed keyword-only parameters among <code class="docutils literal notranslate"><span class="pre">*args</span></code> and <code class="docutils literal notranslate"><span class="pre">**kwargs</span></code>. This
increases complexity and is not proposed here.</li>
</ul>
</section>
</section>
<section id="specification">
<h2><a class="toc-backref" href="#specification" role="doc-backlink">Specification</a></h2>
<section id="new-allowed-form">
<h3><a class="toc-backref" href="#new-allowed-form" role="doc-backlink">New allowed form</a></h3>
<p>It becomes valid to write:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Callable</span><span class="p">[[</span><span class="n">Unpack</span><span class="p">[</span><span class="n">TD</span><span class="p">]],</span> <span class="n">R</span><span class="p">]</span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">TD</span></code> is a <code class="docutils literal notranslate"><span class="pre">TypedDict</span></code>. A shorter form is also allowed:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Callable</span><span class="p">[</span><span class="n">Unpack</span><span class="p">[</span><span class="n">TD</span><span class="p">],</span> <span class="n">R</span><span class="p">]</span>
</pre></div>
</div>
<p>Additionally, positional parameters may be combined with an unpacked
<code class="docutils literal notranslate"><span class="pre">TypedDict</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Callable</span><span class="p">[[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">Unpack</span><span class="p">[</span><span class="n">TD</span><span class="p">]],</span> <span class="n">R</span><span class="p">]</span>
</pre></div>
</div>
</section>
<section id="semantics">
<h3><a class="toc-backref" href="#semantics" role="doc-backlink">Semantics</a></h3>
<p>For type-checking purposes, <code class="docutils literal notranslate"><span class="pre">Callable[[Unpack[TD]],</span> <span class="pre">R]</span></code> behaves as if it were
specified via a callback protocol whose <code class="docutils literal notranslate"><span class="pre">__call__</span></code> method has
<code class="docutils literal notranslate"><span class="pre">**kwargs:</span> <span class="pre">Unpack[TD]</span></code>.
The semantics of <code class="docutils literal notranslate"><span class="pre">Unpack</span></code> itself are exactly those described in the typing
specification’s <a class="reference external" href="https://typing.python.org/en/latest/spec/callables.html#unpack-for-keyword-arguments">Unpack for keyword arguments</a>
section and <a class="pep reference internal" href="../pep-0692/" title="PEP 692 – Using TypedDict for more precise **kwargs typing">PEP 692</a>, together with <a class="pep reference internal" href="../pep-0728/" title="PEP 728 – TypedDict with Typed Extra Items">PEP 728</a> for <code class="docutils literal notranslate"><span class="pre">extra_items</span></code> and
<code class="docutils literal notranslate"><span class="pre">closed</span></code>.</p>
<p>This PEP only adds the following Callable-specific rules:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">Unpack[TD]</span></code> may appear inside the parameter list of
<code class="docutils literal notranslate"><span class="pre">Callable</span></code>.</li>
<li>Positional parameters may appear in <code class="docutils literal notranslate"><span class="pre">Callable</span></code> before <code class="docutils literal notranslate"><span class="pre">Unpack[TD]</span></code> and
follow existing <code class="docutils literal notranslate"><span class="pre">Callable</span></code> semantics.</li>
<li>Only a <code class="docutils literal notranslate"><span class="pre">ParamSpec</span></code> may be substituted by an unpacked <code class="docutils literal notranslate"><span class="pre">TypedDict</span></code> within a
<code class="docutils literal notranslate"><span class="pre">Callable</span></code>.</li>
</ul>
</section>
<section id="examples">
<h3><a class="toc-backref" href="#examples" role="doc-backlink">Examples</a></h3>
<p>The following examples illustrate how unpacking a <code class="docutils literal notranslate"><span class="pre">TypedDict</span></code> into a
<code class="docutils literal notranslate"><span class="pre">Callable</span></code> enforces acceptance of specific keyword parameters. A function is
compatible if it can be called with the required keywords (even if they are
also accepted positionally); positional-only parameters for those keys are
rejected:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">TypedDict</span><span class="p">,</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">Unpack</span><span class="p">,</span> <span class="n">Any</span><span class="p">,</span> <span class="n">NotRequired</span>

<span class="k">class</span><span class="w"> </span><span class="nc">KeywordTD</span><span class="p">(</span><span class="n">TypedDict</span><span class="p">):</span>
    <span class="n">a</span><span class="p">:</span> <span class="nb">int</span>

<span class="nb">type</span> <span class="n">IntKwCallable</span> <span class="o">=</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Unpack</span><span class="p">[</span><span class="n">KeywordTD</span><span class="p">]],</span> <span class="n">Any</span><span class="p">]</span>

<span class="k">def</span><span class="w"> </span><span class="nf">normal</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span> <span class="o">...</span>
<span class="k">def</span><span class="w"> </span><span class="nf">kw_only</span><span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="n">a</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span> <span class="o">...</span>
<span class="k">def</span><span class="w"> </span><span class="nf">pos_only</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="o">/</span><span class="p">):</span> <span class="o">...</span>
<span class="k">def</span><span class="w"> </span><span class="nf">different</span><span class="p">(</span><span class="n">bar</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span> <span class="o">...</span>

<span class="n">f1</span><span class="p">:</span> <span class="n">IntKwCallable</span> <span class="o">=</span> <span class="n">normal</span>     <span class="c1"># Accepted</span>
<span class="n">f2</span><span class="p">:</span> <span class="n">IntKwCallable</span> <span class="o">=</span> <span class="n">kw_only</span>    <span class="c1"># Accepted</span>
<span class="n">f3</span><span class="p">:</span> <span class="n">IntKwCallable</span> <span class="o">=</span> <span class="n">pos_only</span>   <span class="c1"># Rejected</span>
<span class="n">f4</span><span class="p">:</span> <span class="n">IntKwCallable</span> <span class="o">=</span> <span class="n">different</span>  <span class="c1"># Rejected</span>
</pre></div>
</div>
</section>
<section id="optional-arguments">
<h3><a class="toc-backref" href="#optional-arguments" role="doc-backlink">Optional arguments</a></h3>
<p>Keys marked <code class="docutils literal notranslate"><span class="pre">NotRequired</span></code> in the <code class="docutils literal notranslate"><span class="pre">TypedDict</span></code> correspond to optional
keyword arguments.
This means that the callable must accept them, but callers may omit them.
Functions that accept the keyword argument must also provide a default value
that is compatible; functions that omit the parameter entirely are rejected:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">OptionalKws</span><span class="p">(</span><span class="n">TypedDict</span><span class="p">):</span>
    <span class="n">a</span><span class="p">:</span> <span class="n">NotRequired</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>

<span class="nb">type</span> <span class="n">OptCallable</span> <span class="o">=</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Unpack</span><span class="p">[</span><span class="n">OptionalKws</span><span class="p">]],</span> <span class="n">Any</span><span class="p">]</span>

<span class="k">def</span><span class="w"> </span><span class="nf">defaulted</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">):</span> <span class="o">...</span>
<span class="k">def</span><span class="w"> </span><span class="nf">kw_default</span><span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="n">a</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">):</span> <span class="o">...</span>
<span class="k">def</span><span class="w"> </span><span class="nf">no_params</span><span class="p">():</span> <span class="o">...</span>
<span class="k">def</span><span class="w"> </span><span class="nf">required</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span> <span class="o">...</span>

<span class="n">g1</span><span class="p">:</span> <span class="n">OptCallable</span> <span class="o">=</span> <span class="n">defaulted</span>    <span class="c1"># Accepted</span>
<span class="n">g2</span><span class="p">:</span> <span class="n">OptCallable</span> <span class="o">=</span> <span class="n">kw_default</span>   <span class="c1"># Accepted</span>
<span class="n">g3</span><span class="p">:</span> <span class="n">OptCallable</span> <span class="o">=</span> <span class="n">no_params</span>    <span class="c1"># Rejected</span>
<span class="n">g4</span><span class="p">:</span> <span class="n">OptCallable</span> <span class="o">=</span> <span class="n">required</span>     <span class="c1"># Rejected</span>
</pre></div>
</div>
</section>
<section id="additional-keyword-arguments">
<h3><a class="toc-backref" href="#additional-keyword-arguments" role="doc-backlink">Additional keyword arguments</a></h3>
<section id="default-behavior-no-extra-items-or-closed">
<h4><a class="toc-backref" href="#default-behavior-no-extra-items-or-closed" role="doc-backlink">Default Behavior (no <code class="docutils literal notranslate"><span class="pre">extra_items</span></code> or <code class="docutils literal notranslate"><span class="pre">closed</span></code>)</a></h4>
<p>If the <code class="docutils literal notranslate"><span class="pre">TypedDict</span></code> does not specify <code class="docutils literal notranslate"><span class="pre">extra_items</span></code> or <code class="docutils literal notranslate"><span class="pre">closed</span></code>, additional
keyword arguments are permitted with type <code class="docutils literal notranslate"><span class="pre">object</span></code>.
This is the default behavior:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># implies extra_items=object</span>
<span class="k">class</span><span class="w"> </span><span class="nc">DefaultTD</span><span class="p">(</span><span class="n">TypedDict</span><span class="p">):</span>
  <span class="n">a</span><span class="p">:</span> <span class="nb">int</span>

<span class="nb">type</span> <span class="n">DefaultCallable</span> <span class="o">=</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Unpack</span><span class="p">[</span><span class="n">DefaultTD</span><span class="p">]],</span> <span class="n">Any</span><span class="p">]</span>

<span class="k">def</span><span class="w"> </span><span class="nf">v_any</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="nb">object</span><span class="p">):</span> <span class="o">...</span>
<span class="k">def</span><span class="w"> </span><span class="nf">v_ints</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span> <span class="o">...</span>

<span class="n">d1</span><span class="p">:</span> <span class="n">DefaultCallable</span> <span class="o">=</span> <span class="n">v_any</span>   <span class="c1"># Accepted (implicit object for extras)</span>
<span class="n">d1</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;more&quot;</span><span class="p">)</span>             <span class="c1"># Accepted (extras allowed)</span>
<span class="n">d2</span><span class="p">:</span> <span class="n">DefaultCallable</span> <span class="o">=</span> <span class="n">v_ints</span>  <span class="c1"># Rejected (b: int is not a supertype of object)</span>
</pre></div>
</div>
</section>
<section id="closed-behavior-pep-728">
<h4><a class="toc-backref" href="#closed-behavior-pep-728" role="doc-backlink"><code class="docutils literal notranslate"><span class="pre">closed</span></code> behavior (PEP 728)</a></h4>
<p>If <code class="docutils literal notranslate"><span class="pre">closed=True</span></code> is specified on the <code class="docutils literal notranslate"><span class="pre">TypedDict</span></code>, no additional keyword
arguments beyond those declared are expected:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">ClosedTD</span><span class="p">(</span><span class="n">TypedDict</span><span class="p">,</span> <span class="n">closed</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
  <span class="n">a</span><span class="p">:</span> <span class="nb">int</span>

<span class="nb">type</span> <span class="n">ClosedCallable</span> <span class="o">=</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Unpack</span><span class="p">[</span><span class="n">ClosedTD</span><span class="p">]],</span> <span class="n">Any</span><span class="p">]</span>

<span class="k">def</span><span class="w"> </span><span class="nf">v_any</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="nb">object</span><span class="p">):</span> <span class="o">...</span>
<span class="k">def</span><span class="w"> </span><span class="nf">v_ints</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span> <span class="o">...</span>

<span class="n">c1</span><span class="p">:</span> <span class="n">ClosedCallable</span> <span class="o">=</span> <span class="n">v_any</span>   <span class="c1"># Accepted</span>
<span class="n">c1</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;more&quot;</span><span class="p">)</span>            <span class="c1"># Rejected (extra c not allowed)</span>
<span class="n">c2</span><span class="p">:</span> <span class="n">ClosedCallable</span> <span class="o">=</span> <span class="n">v_ints</span>  <span class="c1"># Accepted</span>
<span class="n">c2</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>                 <span class="c1"># Rejected (extra b not allowed)</span>
</pre></div>
</div>
</section>
<section id="interaction-with-extra-items-pep-728">
<h4><a class="toc-backref" href="#interaction-with-extra-items-pep-728" role="doc-backlink">Interaction with <code class="docutils literal notranslate"><span class="pre">extra_items</span></code> (PEP 728)</a></h4>
<p>If a <code class="docutils literal notranslate"><span class="pre">TypedDict</span></code> specifies the <code class="docutils literal notranslate"><span class="pre">extra_items</span></code> parameter (with the exception
of <code class="docutils literal notranslate"><span class="pre">extra_items=Never</span></code>), the corresponding <code class="docutils literal notranslate"><span class="pre">Callable</span></code>
must accept additional keyword arguments of the specified type.</p>
<p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">ExtraTD</span><span class="p">(</span><span class="n">TypedDict</span><span class="p">,</span> <span class="n">extra_items</span><span class="o">=</span><span class="nb">str</span><span class="p">):</span>
  <span class="n">a</span><span class="p">:</span> <span class="nb">int</span>

<span class="nb">type</span> <span class="n">ExtraCallable</span> <span class="o">=</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Unpack</span><span class="p">[</span><span class="n">ExtraTD</span><span class="p">]],</span> <span class="n">Any</span><span class="p">]</span>

<span class="k">def</span><span class="w"> </span><span class="nf">accepts_str</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span> <span class="o">...</span>
<span class="k">def</span><span class="w"> </span><span class="nf">accepts_object</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="nb">object</span><span class="p">):</span> <span class="o">...</span>
<span class="k">def</span><span class="w"> </span><span class="nf">accepts_int</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span> <span class="o">...</span>

<span class="n">e1</span><span class="p">:</span> <span class="n">ExtraCallable</span> <span class="o">=</span> <span class="n">accepts_str</span>     <span class="c1"># Accepted (matches extra_items type)</span>
<span class="n">e2</span><span class="p">:</span> <span class="n">ExtraCallable</span> <span class="o">=</span> <span class="n">accepts_object</span>  <span class="c1"># Accepted (object is a supertype of str)</span>
<span class="n">e3</span><span class="p">:</span> <span class="n">ExtraCallable</span> <span class="o">=</span> <span class="n">accepts_int</span>     <span class="c1"># Rejected (int is not a supertype of str)</span>

<span class="n">e1</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="s2">&quot;foo&quot;</span><span class="p">)</span>   <span class="c1"># Accepted</span>
<span class="n">e1</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>       <span class="c1"># Rejected (b must be str)</span>
</pre></div>
</div>
</section>
<section id="interaction-with-paramspec-and-concatenate">
<h4><a class="toc-backref" href="#interaction-with-paramspec-and-concatenate" role="doc-backlink">Interaction with <code class="docutils literal notranslate"><span class="pre">ParamSpec</span></code> and <code class="docutils literal notranslate"><span class="pre">Concatenate</span></code></a></h4>
<p>A <code class="docutils literal notranslate"><span class="pre">ParamSpec</span></code> can be substituted by <code class="docutils literal notranslate"><span class="pre">Unpack[KeywordTD]</span></code> to define a
parameterized callable alias. Substituting <code class="docutils literal notranslate"><span class="pre">Unpack[KeywordTD]</span></code> produces the
same effect as writing the callable with an unpacked <code class="docutils literal notranslate"><span class="pre">TypedDict</span></code> directly.
Using a <code class="docutils literal notranslate"><span class="pre">TypedDict</span></code> within <code class="docutils literal notranslate"><span class="pre">Concatenate</span></code> is not allowed.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span> <span class="n">CallableP</span><span class="p">[</span><span class="o">**</span><span class="n">P</span><span class="p">]</span> <span class="o">=</span> <span class="n">Callable</span><span class="p">[</span><span class="n">P</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>

<span class="n">h</span><span class="p">:</span> <span class="n">CallableP</span><span class="p">[</span><span class="n">Unpack</span><span class="p">[</span><span class="n">KeywordTD</span><span class="p">]]</span> <span class="o">=</span> <span class="n">normal</span>   <span class="c1"># Accepted</span>
<span class="n">h2</span><span class="p">:</span> <span class="n">CallableP</span><span class="p">[</span><span class="n">Unpack</span><span class="p">[</span><span class="n">KeywordTD</span><span class="p">]]</span> <span class="o">=</span> <span class="n">kw_only</span> <span class="c1"># Accepted</span>
<span class="n">h3</span><span class="p">:</span> <span class="n">CallableP</span><span class="p">[</span><span class="n">Unpack</span><span class="p">[</span><span class="n">KeywordTD</span><span class="p">]]</span> <span class="o">=</span> <span class="n">pos_only</span> <span class="c1"># Rejected</span>
</pre></div>
</div>
<p>The current implementation needs to be updated to allow subscripting with a
generic <code class="docutils literal notranslate"><span class="pre">Unpack[TypedDict]</span></code> without extra brackets;
see <a class="reference internal" href="#backwards-compatibility">Backwards Compatibility</a>.</p>
</section>
<section id="combined-positional-parameters-and-unpack">
<h4><a class="toc-backref" href="#combined-positional-parameters-and-unpack" role="doc-backlink">Combined positional parameters and <code class="docutils literal notranslate"><span class="pre">Unpack</span></code></a></h4>
<p>Positional parameters may precede an unpacked <code class="docutils literal notranslate"><span class="pre">TypedDict</span></code> inside <code class="docutils literal notranslate"><span class="pre">Callable</span></code>.
Functions that accept the required positional arguments and can be called with
the specified keyword(s) are compatible; making the keyword positional-only is
rejected:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">TypedDict</span><span class="p">,</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">Unpack</span><span class="p">,</span> <span class="n">Any</span>

<span class="k">class</span><span class="w"> </span><span class="nc">KeywordTD</span><span class="p">(</span><span class="n">TypedDict</span><span class="p">):</span>
    <span class="n">a</span><span class="p">:</span> <span class="nb">int</span>

<span class="nb">type</span> <span class="n">IntKwPosCallable</span> <span class="o">=</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">Unpack</span><span class="p">[</span><span class="n">KeywordTD</span><span class="p">]],</span> <span class="n">Any</span><span class="p">]</span>

<span class="k">def</span><span class="w"> </span><span class="nf">mixed_kwonly</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">a</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span> <span class="o">...</span>
<span class="k">def</span><span class="w"> </span><span class="nf">mixed_poskw</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">a</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span> <span class="o">...</span>
<span class="k">def</span><span class="w"> </span><span class="nf">mixed_posonly</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">a</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="o">/</span><span class="p">):</span> <span class="o">...</span>

<span class="n">m1</span><span class="p">:</span> <span class="n">IntKwPosCallable</span> <span class="o">=</span> <span class="n">mixed_kwonly</span>  <span class="c1"># Accepted</span>
<span class="n">m2</span><span class="p">:</span> <span class="n">IntKwPosCallable</span> <span class="o">=</span> <span class="n">mixed_poskw</span>   <span class="c1"># Accepted</span>
<span class="n">m3</span><span class="p">:</span> <span class="n">IntKwPosCallable</span> <span class="o">=</span> <span class="n">mixed_posonly</span> <span class="c1"># Rejected</span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="backwards-compatibility">
<h2><a class="toc-backref" href="#backwards-compatibility" role="doc-backlink">Backwards Compatibility</a></h2>
<p>This feature is mostly an additive typing-only feature. It does not affect
existing code.
Subscripting a <code class="docutils literal notranslate"><span class="pre">ParamSpec</span></code> with a generic <code class="docutils literal notranslate"><span class="pre">Unpack</span></code> of a <code class="docutils literal notranslate"><span class="pre">TypedDict</span></code> is
only backwards compatible when placed inside extra brackets; a <code class="docutils literal notranslate"><span class="pre">TypeAliasType</span></code>
is not affected by this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">TypedDict</span><span class="p">,</span> <span class="n">ParamSpec</span><span class="p">,</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">Unpack</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">TypeAliasType</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Config</span><span class="p">[</span><span class="n">T</span><span class="p">](</span><span class="n">TypedDict</span><span class="p">):</span>
    <span class="n">setting</span><span class="p">:</span> <span class="n">T</span>

<span class="nb">type</span> <span class="n">CallP1</span><span class="p">[</span><span class="o">**</span><span class="n">P</span><span class="p">]</span> <span class="o">=</span> <span class="n">Callable</span><span class="p">[</span><span class="n">P</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
<span class="n">CallP1_SubbedB</span> <span class="o">=</span> <span class="n">CallP1</span><span class="p">[</span><span class="n">Unpack</span><span class="p">[</span><span class="n">Config</span><span class="p">[</span><span class="nb">int</span><span class="p">]]]</span>    <span class="c1"># OK</span>

<span class="n">P</span> <span class="o">=</span> <span class="n">ParamSpec</span><span class="p">(</span><span class="s2">&quot;P&quot;</span><span class="p">)</span>
<span class="n">CallP2</span> <span class="o">=</span> <span class="n">Callable</span><span class="p">[</span><span class="n">P</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
<span class="n">CallP2_SubbedA</span> <span class="o">=</span> <span class="n">CallP2</span><span class="p">[[</span><span class="n">Unpack</span><span class="p">[</span><span class="n">Config</span><span class="p">[</span><span class="nb">int</span><span class="p">]]]]</span>  <span class="c1"># OK</span>
<span class="n">CallP2_SubbedB</span> <span class="o">=</span> <span class="n">CallP2</span><span class="p">[</span><span class="n">Unpack</span><span class="p">[</span><span class="n">Config</span><span class="p">[</span><span class="nb">int</span><span class="p">]]]</span>    <span class="c1"># currently TypeError</span>
</pre></div>
</div>
</section>
<section id="how-to-teach-this">
<h2><a class="toc-backref" href="#how-to-teach-this" role="doc-backlink">How to Teach This</a></h2>
<p>This feature is a shorthand for Protocol-based callbacks. Users should be
taught that with</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">KeywordTD</span><span class="p">(</span><span class="n">TypedDict</span><span class="p">):</span>
    <span class="n">a</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">b</span><span class="p">:</span> <span class="n">NotRequired</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</pre></div>
</div>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">Callable[[Unpack[KeywordTD]],</span> <span class="pre">R]</span></code> is equivalent to defining a Protocol with
<code class="docutils literal notranslate"><span class="pre">__call__(self,</span> <span class="pre">**kwargs:</span> <span class="pre">Unpack[KeywordTD])</span> <span class="pre">-&gt;</span> <span class="pre">R</span></code>
or
<code class="docutils literal notranslate"><span class="pre">__call__(self,</span> <span class="pre">a:</span> <span class="pre">int,</span> <span class="pre">b:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">...,</span> <span class="pre">**kwargs:</span> <span class="pre">object)</span> <span class="pre">-&gt;</span> <span class="pre">R</span></code>.</li>
<li>Teachers might want to introduce the concept of <code class="docutils literal notranslate"><span class="pre">TypedDict</span></code> with
<code class="docutils literal notranslate"><span class="pre">Callable</span></code> first before introducing <code class="docutils literal notranslate"><span class="pre">Protocol</span></code>.</li>
<li>The implicit addition of <code class="docutils literal notranslate"><span class="pre">**kwargs:</span> <span class="pre">object</span></code> might be surprising to users;
using <code class="docutils literal notranslate"><span class="pre">closed=True</span></code> for definitions will create the more intuitive
equivalence of <code class="docutils literal notranslate"><span class="pre">__call__(self,</span> <span class="pre">a:</span> <span class="pre">int,</span> <span class="pre">b:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">...)</span> <span class="pre">-&gt;</span> <span class="pre">R</span></code></li>
<li>Users should be made aware of the interaction with <code class="docutils literal notranslate"><span class="pre">extra_items</span></code> from
<a class="pep reference internal" href="../pep-0728/" title="PEP 728 – TypedDict with Typed Extra Items">PEP 728</a>.</li>
</ul>
</section>
<section id="reference-implementation">
<h2><a class="toc-backref" href="#reference-implementation" role="doc-backlink">Reference Implementation</a></h2>
<p>A prototype exists in mypy:
<a class="reference external" href="https://github.com/python/mypy/pull/16083">python/mypy#16083</a>.</p>
</section>
<section id="rejected-ideas">
<h2><a class="toc-backref" href="#rejected-ideas" role="doc-backlink">Rejected Ideas</a></h2>
<ul class="simple">
<li>Combining <code class="docutils literal notranslate"><span class="pre">Unpack[TD]</span></code> with <code class="docutils literal notranslate"><span class="pre">Concatenate</span></code>. With such support, one could
write <code class="docutils literal notranslate"><span class="pre">Callable[Concatenate[int,</span> <span class="pre">Unpack[TD],</span> <span class="pre">P],</span> <span class="pre">R]</span></code> which in turn would
allow a keyword-only parameter between <code class="docutils literal notranslate"><span class="pre">*args</span></code> and <code class="docutils literal notranslate"><span class="pre">**kwargs</span></code>, i.e.
<code class="docutils literal notranslate"><span class="pre">def</span> <span class="pre">func(*args:</span> <span class="pre">Any,</span> <span class="pre">a:</span> <span class="pre">int,</span> <span class="pre">**kwargs:</span> <span class="pre">Any)</span> <span class="pre">-&gt;</span> <span class="pre">R:</span> <span class="pre">...</span></code>
which is currently not allowed per <a class="pep reference internal" href="../pep-0612/" title="PEP 612 – Parameter Specification Variables">PEP 612</a>.
To keep the initial implementation simple, this PEP does not propose such
support.</li>
</ul>
</section>
<section id="open-questions">
<h2><a class="toc-backref" href="#open-questions" role="doc-backlink">Open Questions</a></h2>
<ul class="simple">
<li>Should multiple <code class="docutils literal notranslate"><span class="pre">TypedDict</span></code> unpacks be allowed to form a union, and if so,
how to handle overlapping keys of non-identical types? Which restrictions
should apply in such a case? Should the order matter?</li>
<li>Should we allow the shorter form <code class="docutils literal notranslate"><span class="pre">Callable[Unpack[TD],</span> <span class="pre">R]</span></code> in addition to
<code class="docutils literal notranslate"><span class="pre">Callable[[Unpack[TD]],</span> <span class="pre">R]</span></code>?</li>
<li>Is there a necessity to differentiate between normal and <code class="docutils literal notranslate"><span class="pre">ReadOnly</span></code> keys?</li>
</ul>
</section>
<section id="acknowledgements">
<h2><a class="toc-backref" href="#acknowledgements" role="doc-backlink">Acknowledgements</a></h2>
<p>Thanks to Jelle Zijlstra for sponsoring this PEP and his valuable review
feedback.</p>
<p>Hugo van Kemenade, for helpful feedback on the draft and PR of this PEP.</p>
<p>Eric Traut, for feedback on the initial idea and discussions.</p>
</section>
<section id="references">
<h2><a class="toc-backref" href="#references" role="doc-backlink">References</a></h2>
<ul class="simple">
<li><a class="pep reference internal" href="../pep-0692/" title="PEP 692 – Using TypedDict for more precise **kwargs typing">PEP 692</a> - Using <code class="docutils literal notranslate"><span class="pre">Unpack</span></code> with <code class="docutils literal notranslate"><span class="pre">**kwargs</span></code></li>
<li><a class="pep reference internal" href="../pep-0728/" title="PEP 728 – TypedDict with Typed Extra Items">PEP 728</a> - <code class="docutils literal notranslate"><span class="pre">extra_items</span></code> in <code class="docutils literal notranslate"><span class="pre">TypedDict</span></code></li>
<li><a class="reference external" href="https://github.com/python/mypy/pull/16083">mypy PR #16083 - Prototype support</a></li>
<li>Revisiting PEP 677 (<a class="reference external" href="https://discuss.python.org/t/pep-677-with-an-easier-to-parse-and-more-expressive-syntax/98408/33">discussion thread</a>)</li>
</ul>
</section>
<section id="copyright">
<h2><a class="toc-backref" href="#copyright" role="doc-backlink">Copyright</a></h2>
<p>This document is placed in the public domain or under the CC0-1.0-Universal
license, whichever is more permissive.</p>
</section>
</section>
<hr class="docutils" />
<p>Source: <a class="reference external" href="https://github.com/python/peps/blob/main/peps/pep-0821.rst">https://github.com/python/peps/blob/main/peps/pep-0821.rst</a></p>
<p>Last modified: <a class="reference external" href="https://github.com/python/peps/commits/main/peps/pep-0821.rst">2026-01-31 20:25:24 GMT</a></p>

        </article>
        <nav id="pep-sidebar">
            <div id="search"></div>
            <h2>Contents</h2>
            <ul>
<li><a class="reference internal" href="#abstract">Abstract</a></li>
<li><a class="reference internal" href="#motivation">Motivation</a></li>
<li><a class="reference internal" href="#rationale">Rationale</a><ul>
<li><a class="reference internal" href="#design-goals">Design goals</a></li>
<li><a class="reference internal" href="#alternatives-considered">Alternatives considered</a></li>
<li><a class="reference internal" href="#design-trade-offs-and-decisions">Design trade-offs and decisions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#specification">Specification</a><ul>
<li><a class="reference internal" href="#new-allowed-form">New allowed form</a></li>
<li><a class="reference internal" href="#semantics">Semantics</a></li>
<li><a class="reference internal" href="#examples">Examples</a></li>
<li><a class="reference internal" href="#optional-arguments">Optional arguments</a></li>
<li><a class="reference internal" href="#additional-keyword-arguments">Additional keyword arguments</a><ul>
<li><a class="reference internal" href="#default-behavior-no-extra-items-or-closed">Default Behavior (no <code class="docutils literal notranslate"><span class="pre">extra_items</span></code> or <code class="docutils literal notranslate"><span class="pre">closed</span></code>)</a></li>
<li><a class="reference internal" href="#closed-behavior-pep-728"><code class="docutils literal notranslate"><span class="pre">closed</span></code> behavior (PEP 728)</a></li>
<li><a class="reference internal" href="#interaction-with-extra-items-pep-728">Interaction with <code class="docutils literal notranslate"><span class="pre">extra_items</span></code> (PEP 728)</a></li>
<li><a class="reference internal" href="#interaction-with-paramspec-and-concatenate">Interaction with <code class="docutils literal notranslate"><span class="pre">ParamSpec</span></code> and <code class="docutils literal notranslate"><span class="pre">Concatenate</span></code></a></li>
<li><a class="reference internal" href="#combined-positional-parameters-and-unpack">Combined positional parameters and <code class="docutils literal notranslate"><span class="pre">Unpack</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#backwards-compatibility">Backwards Compatibility</a></li>
<li><a class="reference internal" href="#how-to-teach-this">How to Teach This</a></li>
<li><a class="reference internal" href="#reference-implementation">Reference Implementation</a></li>
<li><a class="reference internal" href="#rejected-ideas">Rejected Ideas</a></li>
<li><a class="reference internal" href="#open-questions">Open Questions</a></li>
<li><a class="reference internal" href="#acknowledgements">Acknowledgements</a></li>
<li><a class="reference internal" href="#references">References</a></li>
<li><a class="reference internal" href="#copyright">Copyright</a></li>
</ul>

            <br>
            <a id="source" href="https://github.com/python/peps/blob/main/peps/pep-0821.rst?plain=1">Page Source (GitHub)</a>
        </nav>
    </section>
    <script src="../_static/colour_scheme.js"></script>
    <script src="../_static/wrap_tables.js"></script>
    <script src="../_static/sticky_banner.js"></script>
    <script src="https://analytics.python.org/js/script.outbound-links.js"
            data-domain="peps.python.org" defer></script>
    <script src="/pagefind/pagefind-ui.js"></script>
    <script>
        window.addEventListener('DOMContentLoaded', (event) => {
            // Ranking configuration to boost exact title matches
            const searchOptions = {
                ranking: {
                    termSimilarity: 9.0, // Higher values favor exact matches
                    termFrequency: 0.5, // Lower values reduce penalty for low term frequency
                    pageLength: 0.2, // Lower values reduce the impact of page length
                }
            };

            // Initialize pagefind for either mobile or desktop, not both
            if (window.innerWidth <= 640) {
                new PagefindUI({ element: "#mobile-search", ...searchOptions, showSubResults: false });
            } else {
                new PagefindUI({ element: "#search", ...searchOptions, showSubResults: true });
            }
        });
    </script>
</body>
</html>