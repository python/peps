
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="color-scheme" content="light dark">
    <title>PEP 778 – Supporting Symlinks in Wheels | peps.python.org</title>
    <link rel="shortcut icon" href="../_static/py.png">
    <link rel="canonical" href="https://peps.python.org/pep-0778/">
    <link rel="stylesheet" href="../_static/style.css" type="text/css">
    <link rel="stylesheet" href="../_static/mq.css" type="text/css">
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" media="(prefers-color-scheme: light)" id="pyg-light">
    <link rel="stylesheet" href="../_static/pygments_dark.css" type="text/css" media="(prefers-color-scheme: dark)" id="pyg-dark">
    <link rel="alternate" type="application/rss+xml" title="Latest PEPs" href="https://peps.python.org/peps.rss">
    <meta property="og:title" content='PEP 778 – Supporting Symlinks in Wheels | peps.python.org'>
    <meta property="og:description" content="Wheels currently do not handle symlinks well, copying content instead of making symlinks when installed. To properly handle distributing libraries in wheels, we propose a new LINKS metadata file to handle symlinks in a platform portable manner. This spe...">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://peps.python.org/pep-0778/">
    <meta property="og:site_name" content="Python Enhancement Proposals (PEPs)">
    <meta property="og:image" content="https://peps.python.org/_static/og-image.png">
    <meta property="og:image:alt" content="Python PEPs">
    <meta property="og:image:width" content="200">
    <meta property="og:image:height" content="200">
    <meta name="description" content="Wheels currently do not handle symlinks well, copying content instead of making symlinks when installed. To properly handle distributing libraries in wheels, we propose a new LINKS metadata file to handle symlinks in a platform portable manner. This spe...">
    <meta name="theme-color" content="#3776ab">
</head>
<body>
    
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-sun-half" viewBox="0 0 24 24" pointer-events="all">
    <title>Following system colour scheme</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none"
         stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <circle cx="12" cy="12" r="9"></circle>
      <path d="M12 3v18m0-12l4.65-4.65M12 14.3l7.37-7.37M12 19.6l8.85-8.85"></path>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24" pointer-events="all">
    <title>Selected dark colour scheme</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none"
         stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z"></path>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24" pointer-events="all">
    <title>Selected light colour scheme</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none"
         stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
</svg>
    <script>

        document.documentElement.dataset.colour_scheme = localStorage.getItem("colour_scheme") || "auto"
    </script>
    <section id="pep-page-section">
        <header>
            <h1 data-pagefind-ignore>Python Enhancement Proposals</h1>
            <ul class="breadcrumbs">
                <li><a href="https://www.python.org/" title="The Python Programming Language">Python</a> &raquo; </li>
                <li><a href="../pep-0000/">PEP Index</a> &raquo; </li>
                <li>PEP 778</li>
            </ul>
            <button id="colour-scheme-cycler" onClick="setColourScheme(nextColourScheme())">
                <svg aria-hidden="true" class="colour-scheme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
                <svg aria-hidden="true" class="colour-scheme-icon-when-dark"><use href="#svg-moon"></use></svg>
                <svg aria-hidden="true" class="colour-scheme-icon-when-light"><use href="#svg-sun"></use></svg>
                <span class="visually-hidden">Toggle light / dark / auto colour theme</span>
            </button>
        </header>
        
        <div id="mobile-search" class="mobile-search-container"></div>
        
        <article data-pagefind-body>
            
            <span data-pagefind-meta="title:PEP 778 – Supporting Symlinks in Wheels" data-pagefind-weight="10" class="visually-hidden">PEP 778 – Supporting Symlinks in Wheels</span>
            <section id="pep-content">
<h1 class="page-title">PEP 778 – Supporting Symlinks in Wheels</h1>
<dl class="rfc2822 field-list simple">
<dt class="field-odd">Author<span class="colon">:</span></dt>
<dd class="field-odd">Emma Harper Smith &lt;emma&#32;&#97;t&#32;python.org&gt;</dd>
<dt class="field-even">Sponsor<span class="colon">:</span></dt>
<dd class="field-even">Barry Warsaw &lt;barry&#32;&#97;t&#32;python.org&gt;</dd>
<dt class="field-odd">PEP-Delegate<span class="colon">:</span></dt>
<dd class="field-odd">Paul Moore &lt;p.f.moore&#32;&#97;t&#32;gmail.com&gt;</dd>
<dt class="field-even">Discussions-To<span class="colon">:</span></dt>
<dd class="field-even"><a class="reference external" href="https://discuss.python.org/t/pep-778-supporting-symlinks-in-wheels/53824">Discourse thread</a></dd>
<dt class="field-odd">Status<span class="colon">:</span></dt>
<dd class="field-odd"><abbr title="Inactive draft that may be taken up again at a later time">Deferred</abbr></dd>
<dt class="field-even">Type<span class="colon">:</span></dt>
<dd class="field-even"><abbr title="Normative PEP with a new feature for Python, implementation change for CPython or interoperability standard for the ecosystem">Standards Track</abbr></dd>
<dt class="field-odd">Topic<span class="colon">:</span></dt>
<dd class="field-odd"><a class="reference external" href="../topic/packaging/">Packaging</a></dd>
<dt class="field-even">Requires<span class="colon">:</span></dt>
<dd class="field-even"><a class="reference external" href="../pep-0777/">777</a></dd>
<dt class="field-odd">Created<span class="colon">:</span></dt>
<dd class="field-odd">18-May-2024</dd>
<dt class="field-even">Post-History<span class="colon">:</span></dt>
<dd class="field-even"><a class="reference external" href="https://discuss.python.org/t/pep-778-supporting-symlinks-in-wheels/53824" title="Discourse thread">10-Oct-2024</a></dd>
</dl>
<hr class="docutils" />
<section id="contents">
<details><summary>Table of Contents</summary><ul class="simple">
<li><a class="reference internal" href="#abstract">Abstract</a></li>
<li><a class="reference internal" href="#pep-deferral">PEP Deferral</a></li>
<li><a class="reference internal" href="#motivation">Motivation</a></li>
<li><a class="reference internal" href="#rationale">Rationale</a></li>
<li><a class="reference internal" href="#specification">Specification</a><ul>
<li><a class="reference internal" href="#wheel-major-version-bump">Wheel Major Version Bump</a></li>
<li><a class="reference internal" href="#new-links-metadata-file">New <code class="docutils literal notranslate"><span class="pre">LINKS</span></code> Metadata File</a></li>
<li><a class="reference internal" href="#installer-behavior-specification">Installer Behavior Specification</a></li>
<li><a class="reference internal" href="#build-backend-specification">Build Backend Specification</a></li>
</ul>
</li>
<li><a class="reference internal" href="#backwards-compatibility">Backwards Compatibility</a></li>
<li><a class="reference internal" href="#security-implications">Security Implications</a></li>
<li><a class="reference internal" href="#how-to-teach-this">How to Teach This</a></li>
<li><a class="reference internal" href="#reference-implementation">Reference Implementation</a></li>
<li><a class="reference internal" href="#rejected-ideas">Rejected Ideas</a><ul>
<li><a class="reference internal" href="#just-use-posix-symlinks-everywhere">Just Use POSIX Symlinks Everywhere</a></li>
<li><a class="reference internal" href="#don-t-use-junctions-in-links">Don’t Use Junctions in <code class="docutils literal notranslate"><span class="pre">LINKS</span></code></a></li>
<li><a class="reference internal" href="#put-symlinks-in-the-record-metadata-file">Put symlinks in the <code class="docutils literal notranslate"><span class="pre">RECORD</span></code> Metadata File</a></li>
<li><a class="reference internal" href="#library-maintainers-should-use-python-to-locate-libraries">Library Maintainers Should Use Python to Locate Libraries</a></li>
<li><a class="reference internal" href="#include-support-for-hardlinks">Include Support for Hardlinks</a></li>
</ul>
</li>
<li><a class="reference internal" href="#open-issues">Open Issues</a><ul>
<li><a class="reference internal" href="#pep-660-and-deferring-editable-installation-support">PEP 660 and Deferring Editable Installation Support</a></li>
<li><a class="reference internal" href="#security">Security</a></li>
<li><a class="reference internal" href="#allow-inter-package-symlinks">Allow inter-package symlinks</a></li>
<li><a class="reference internal" href="#the-format-of-links">The Format of <code class="docutils literal notranslate"><span class="pre">LINKS</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#previous-discussion">Previous Discussion</a></li>
<li><a class="reference internal" href="#copyright">Copyright</a></li>
</ul>
</details></section>
<section id="abstract">
<h2><a class="toc-backref" href="#abstract" role="doc-backlink">Abstract</a></h2>
<p>Wheels currently do not handle symlinks well, copying content instead of making symlinks when
installed. To properly handle distributing libraries in wheels, we propose a new <code class="docutils literal notranslate"><span class="pre">LINKS</span></code>
metadata file to handle symlinks in a platform portable manner. This specification requires
a new wheel major version, discussed in <a class="pep reference internal" href="../pep-0777/" title="PEP 777 – How to Re-invent the Wheel">PEP 777</a>.</p>
</section>
<section id="pep-deferral">
<h2><a class="toc-backref" href="#pep-deferral" role="doc-backlink">PEP Deferral</a></h2>
<p>This PEP has been deferred until a better compatibility story for major changes to the wheel
format is established. Once a compatibility story is established for wheels which allows backwards
incompatible behavior in an unobtrusive way, the following points should be addressed in this PEP:</p>
<ul class="simple">
<li>Re-focus this topic to just symlinks for shared libraries on POSIX platforms, perhaps tied to
platform tags?</li>
<li>Should the symlinks be materialized as file attributes in the archive or a <code class="docutils literal notranslate"><span class="pre">LINKS</span></code> file?
Could it be encoded in <code class="docutils literal notranslate"><span class="pre">RECORD</span></code>?</li>
<li>Clarify that this PEP is insufficient to be useful for <a class="pep reference internal" href="../pep-0660/" title="PEP 660 – Editable installs for pyproject.toml based builds (wheel based)">PEP 660</a> editable installs since it will no
longer be cross platform.</li>
<li>Describe fallback behavior in instances where symlinks are unavailable on POSIX platforms.</li>
</ul>
</section>
<section id="motivation">
<h2><a class="toc-backref" href="#motivation" role="doc-backlink">Motivation</a></h2>
<p>Today, symlinks in wheels get created as copies of files, as <a class="reference external" href="https://docs.python.org/3/library/zipfile.html">the zipfile module</a> in CPython <a class="reference external" href="https://github.com/python/cpython/issues/82102">does not support handling symlinks
in-place</a> for security reasons.</p>
<p>This <a class="reference external" href="https://pypackaging-native.github.io/other_issues/#lack-of-support-for-symlinks-in-wheels">presents problems to projects that would like to ship large compiled libraries</a> in
wheels, as they must choose to either greatly increase the install size of the project on disk,
or omit the symlink and potentially break some downstream use cases.</p>
<p>To ship a library that can properly be loaded for runtime use or build time linking on POSIX, a
library should follow the conventions of POSIX-style loader and linker search. The two main file names for
the loader to use is the “soname” and the “real name”. The “soname” is a file like
<code class="docutils literal notranslate"><span class="pre">libfoo.so.3</span></code> where <code class="docutils literal notranslate"><span class="pre">3</span></code> is a number that is incremented when the interface of the library
changes. The “real name” is a file named like <code class="docutils literal notranslate"><span class="pre">libfoo.so.3.1.4</span></code>, where the extra version
information lets the loader find a specific version of a library. Finally, when compiling code to
link against a library, the linker searches for a “linker name”, named like <code class="docutils literal notranslate"><span class="pre">libfoo.so</span></code>. A more
detailed description is available in <a class="reference external" href="https://tldp.org/HOWTO/Program-Library-HOWTO/shared-libraries.html">this Linux documentation on shared libraries</a>. To fully support all
runtime and build time use cases, a project requires shipping all 3 files. Normally, this is
handled on POSIX platforms by using symlinks, so that the library is not duplicated on disk 3 times.</p>
<p>Returning to Python packaging, there are many popular projects which ship binary libraries, such as
<code class="docutils literal notranslate"><span class="pre">numpy</span></code>, <code class="docutils literal notranslate"><span class="pre">scipy</span></code>, and <code class="docutils literal notranslate"><span class="pre">pyarrow</span></code>. Other site-packages <code class="docutils literal notranslate"><span class="pre">dlopen</span></code> libraries in other wheels, such as
<code class="docutils literal notranslate"><span class="pre">pytorch</span></code> and <code class="docutils literal notranslate"><span class="pre">jax</span></code>. These projects currently rely on a single library in the wheel, but
this can cause the linker to find the wrong library if there are system libraries that have a
“real name” library version available.</p>
<p>There is also the potential benefit that symlinks in wheels would allow for simpler editable
installs by simply placing a symlink in the user’s <code class="docutils literal notranslate"><span class="pre">site-packages</span></code> directory, but this PEP
leaves that as an open question to be explored in a future PEP.</p>
</section>
<section id="rationale">
<h2><a class="toc-backref" href="#rationale" role="doc-backlink">Rationale</a></h2>
<p>To support the 3 main namings of a library used in loading and library linking on POSIX, we
propose adding support for symlinks in Python wheels. To allow for tracking symlinks made, and to
potentially support other platforms that may not support POSIX symlinks directly, we propose the
use of a new wheel metadata file <code class="docutils literal notranslate"><span class="pre">LINKS</span></code>, which will exist in the <code class="docutils literal notranslate"><span class="pre">.dist-info</span></code> directory alongside
<code class="docutils literal notranslate"><span class="pre">METADATA</span></code>, <code class="docutils literal notranslate"><span class="pre">RECORD</span></code>, and other metadata files.</p>
<p>Using a <code class="docutils literal notranslate"><span class="pre">LINKS</span></code> file will allow for more cross-platform uses of symlink-like usage. On Windows,
symlinks require either <a class="reference external" href="https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/security-policy-settings/create-symbolic-links">a group policy allowing the user to make symlinks</a>
(e.g. by enabling <a class="reference external" href="https://learn.microsoft.com/en-us/windows/apps/get-started/enable-your-device-for-development">Dev Mode</a>)
or Administrative permissions. This means that it may be the case that symlinks are unsupported on
some user systems. By using a <code class="docutils literal notranslate"><span class="pre">LINKS</span></code> file, installers will be able to potentially use other
methods for handling symlinks, such as junctions on Windows, where otherwise the installer would
have to fail.</p>
<p>This PEP also describes checks that installers must make when installing an updated wheel. These
checks exist to handle security risks from allowing wheels to install symlinks. For more
information on why these checks are important, see <a class="reference internal" href="#security-implications">Security Implications</a>.</p>
</section>
<section id="specification">
<h2><a class="toc-backref" href="#specification" role="doc-backlink">Specification</a></h2>
<section id="wheel-major-version-bump">
<h3><a class="toc-backref" href="#wheel-major-version-bump" role="doc-backlink">Wheel Major Version Bump</a></h3>
<p>This PEP requires a wheel major version bump, so the <code class="docutils literal notranslate"><span class="pre">Wheel-Version</span></code> for wheels generated with
<code class="docutils literal notranslate"><span class="pre">LINKS</span></code> <strong>MUST</strong> be at least version <code class="docutils literal notranslate"><span class="pre">2.0</span></code>, so that older installers do not silently fail to
install symlinks and break user environments. For more see <a class="pep reference internal" href="../pep-0777/" title="PEP 777 – How to Re-invent the Wheel">PEP 777</a>.</p>
</section>
<section id="new-links-metadata-file">
<h3><a class="toc-backref" href="#new-links-metadata-file" role="doc-backlink">New <code class="docutils literal notranslate"><span class="pre">LINKS</span></code> Metadata File</a></h3>
<p>To enable cross-platform symlinks, this PEP introduces a new wheel metadata file, <code class="docutils literal notranslate"><span class="pre">LINKS</span></code>. An
example of a <code class="docutils literal notranslate"><span class="pre">LINKS</span></code> file is below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">my_package</span><span class="o">/</span><span class="n">libfoo</span><span class="o">.</span><span class="n">so</span><span class="mf">.3.1.4</span><span class="p">,</span><span class="n">my_package</span><span class="o">/</span><span class="n">libfoo</span><span class="o">.</span><span class="n">so</span><span class="mf">.3</span>
<span class="n">my_package</span><span class="o">/</span><span class="n">libfoo</span><span class="o">.</span><span class="n">so</span><span class="mf">.3</span><span class="p">,</span><span class="n">my_package</span><span class="o">/</span><span class="n">libfoo</span><span class="o">.</span><span class="n">so</span>
</pre></div>
</div>
<p>The format of <code class="docutils literal notranslate"><span class="pre">LINKS</span></code>, as can seen above, is <code class="docutils literal notranslate"><span class="pre">source_path,target_path</span></code> where <code class="docutils literal notranslate"><span class="pre">source_path</span></code>
is a path relative to the root of any namespace or package root in the wheel. <code class="docutils literal notranslate"><span class="pre">target_path</span></code> is a
<em>non-dangling</em> path (i.e. a path that exists on the filesystem after the wheel’s contents are
extracted) in a package or namespace of any package in the wheel. This means that if a wheel
contains multiple packages, all paths in packages in the wheel are acceptable.</p>
</section>
<section id="installer-behavior-specification">
<h3><a class="toc-backref" href="#installer-behavior-specification" role="doc-backlink">Installer Behavior Specification</a></h3>
<p>Installers <strong>MUST</strong> resolve the paths of any link contained in the <code class="docutils literal notranslate"><span class="pre">LINKS</span></code> file <em>before</em>
deciding if any <code class="docutils literal notranslate"><span class="pre">source_path</span></code> or <code class="docutils literal notranslate"><span class="pre">target_path</span></code> are valid. Installers <strong>MUST</strong> verify that
<code class="docutils literal notranslate"><span class="pre">source_path</span></code> and <code class="docutils literal notranslate"><span class="pre">target_path</span></code> are located inside any namespace or package coming from the
wheel.  Installers <strong>MUST</strong> reject cyclic symlinks in wheels. Installers <strong>MAY</strong> error if a long
chain of symlinks (symlinks pointing to symlinks many times repeated) exceeds a limit set by the
installer.</p>
<p>Installers <strong>MUST</strong> follow the following steps when handling a wheel with symlinks:</p>
<ol class="arabic simple">
<li>Check for the existence of a <code class="docutils literal notranslate"><span class="pre">LINKS</span></code> file in the <code class="docutils literal notranslate"><span class="pre">.dist-info</span></code>. If it does not exist,
no further steps are required.</li>
<li>Extract all files in the wheel packages and data directory as in wheel 1.x.</li>
<li>Verify that for each <code class="docutils literal notranslate"><span class="pre">source_path</span></code> and <code class="docutils literal notranslate"><span class="pre">target_path</span></code> pairs, the <code class="docutils literal notranslate"><span class="pre">target_path</span></code> exists in
one of the package namespaces just extracted.</li>
<li>Next, check that the installer can make some kind of link for each pair in the site directory.
If the installer cannot make a link for the file/folder <code class="docutils literal notranslate"><span class="pre">target_path</span></code> for the current
platform, an error <strong>MUST</strong> be raised. An example of a failure mode would be a POSIX symlink to
a file target, where the installer is running on Windows and the installer cannot make
symlinks but can make junctions. In this case the installer <strong>MUST</strong> error because it cannot
handle the link.</li>
<li>Finally, the installer <strong>MUST</strong> add a platform-relevant link between <code class="docutils literal notranslate"><span class="pre">source_path</span></code> and
<code class="docutils literal notranslate"><span class="pre">target_path</span></code>.</li>
</ol>
<p>Installers <strong>MUST NOT</strong> by default copy files instead of generating a symlink when handling
symlinks. Installers <strong>MAY</strong> have such behavior available under an alternate configuration or
command line flag.</p>
</section>
<section id="build-backend-specification">
<h3><a class="toc-backref" href="#build-backend-specification" role="doc-backlink">Build Backend Specification</a></h3>
<p>When creating a wheel, build backends <strong>MUST</strong> treat symlinks in the same way as its target when
deciding whether to include the symlink in a wheel. Build backends <strong>MUST</strong> verify that there are
no dangling symlinks in the <code class="docutils literal notranslate"><span class="pre">LINKS</span></code> file. Build backends <strong>SHOULD</strong> recognize platform-relevant
symlinks that would be included in builds. On POSIX systems this is typically symlinks, on Windows this
includes symlinks and junctions.</p>
</section>
</section>
<section id="backwards-compatibility">
<h2><a class="toc-backref" href="#backwards-compatibility" role="doc-backlink">Backwards Compatibility</a></h2>
<p>Introducing symlinks would require an increment to the wheel format major version. This would mean
new wheels that use the new wheel format would raise an error on older installer tools, per the
<a class="reference external" href="https://packaging.python.org/en/latest/specifications/binary-distribution-format/#file-contents">wheel specification</a>.</p>
<p>Please see <a class="pep reference internal" href="../pep-0777/" title="PEP 777 – How to Re-invent the Wheel">PEP 777</a> on “Wheel 2.0”.</p>
</section>
<section id="security-implications">
<h2><a class="toc-backref" href="#security-implications" role="doc-backlink">Security Implications</a></h2>
<p>Symlinks can be quite dangerous if not handled carefully. A simple example would be if a user were
to run <code class="docutils literal notranslate"><span class="pre">sudo</span> <span class="pre">pip</span> <span class="pre">install</span> <span class="pre">malicious</span></code>, and there were no protections, then the malicious package
could overwrite <code class="docutils literal notranslate"><span class="pre">/etc/shadow</span></code> and replace the password hash on the system, allowing malicious
logins.</p>
<p>This PEP lists several requirements on checks to run by installers on symlinks in wheels to ensure
attacks like the one described above cannot happen. This means it is <strong>critical</strong> that installers
carefully implement these security safeguards and prevent malicious use on package installation.</p>
<p>In particular, the following checks <strong>MUST</strong> be made by installers:</p>
<ol class="arabic simple">
<li>That the symlinks do not point outside of any packages or namespaces coming from the wheel</li>
<li>That the symlinks are not dangling (the target exists at install time)</li>
<li>That the symlinks are not cyclical, stopping after a certain depth of checking to avoid denial
of service requests</li>
</ol>
<p>Do not follow symlinks on removal.</p>
</section>
<section id="how-to-teach-this">
<h2><a class="toc-backref" href="#how-to-teach-this" role="doc-backlink">How to Teach This</a></h2>
<p>End users should, once the changes have propagated through the ecosystem, transparently experience
the benefits of symlinks in wheels. It is important for installers to give clear error messages if
symlinks are unsupported on the platform, and explain why installation has failed.</p>
<p>For people building libraries, documentation on <code class="docutils literal notranslate"><span class="pre">packaging.python.org</span></code> should describe the use
cases and caveats (especially platform support) of symlinks in wheels. Otherwise it should be
handled transparently by build backends in the same way any normal file would be handled.</p>
</section>
<section id="reference-implementation">
<h2><a class="toc-backref" href="#reference-implementation" role="doc-backlink">Reference Implementation</a></h2>
<p>TODO</p>
</section>
<section id="rejected-ideas">
<h2><a class="toc-backref" href="#rejected-ideas" role="doc-backlink">Rejected Ideas</a></h2>
<section id="just-use-posix-symlinks-everywhere">
<h3><a class="toc-backref" href="#just-use-posix-symlinks-everywhere" role="doc-backlink">Just Use POSIX Symlinks Everywhere</a></h3>
<p>This PEP wants to allow for <code class="docutils literal notranslate"><span class="pre">LINKS</span></code> to be used for a potential future <a class="pep reference internal" href="../pep-0660/" title="PEP 660 – Editable installs for pyproject.toml based builds (wheel based)">PEP 660</a> editable
installation. This future PEP should support Windows, so it may need to use junctions.</p>
</section>
<section id="don-t-use-junctions-in-links">
<h3><a class="toc-backref" href="#don-t-use-junctions-in-links" role="doc-backlink">Don’t Use Junctions in <code class="docutils literal notranslate"><span class="pre">LINKS</span></code></a></h3>
<p>Junctions are a limited way to support symlinks between folders on Windows. They do not support
files. This PEP allows for junctions as users may wish to only link folders to a different
location, and future <a class="pep reference internal" href="../pep-0660/" title="PEP 660 – Editable installs for pyproject.toml based builds (wheel based)">PEP 660</a> implementations may need to rely on this feature.</p>
</section>
<section id="put-symlinks-in-the-record-metadata-file">
<h3><a class="toc-backref" href="#put-symlinks-in-the-record-metadata-file" role="doc-backlink">Put symlinks in the <code class="docutils literal notranslate"><span class="pre">RECORD</span></code> Metadata File</a></h3>
<p>While this could be done, it would clutter the <code class="docutils literal notranslate"><span class="pre">RECORD</span></code> file. Furthermore the most
straightforward implementation would place the target at the end of the record. This would
make it harder to scan across the line and visually see what symlinks exist in the wheel.</p>
</section>
<section id="library-maintainers-should-use-python-to-locate-libraries">
<h3><a class="toc-backref" href="#library-maintainers-should-use-python-to-locate-libraries" role="doc-backlink">Library Maintainers Should Use Python to Locate Libraries</a></h3>
<p>Using Python to locate libraries would be much easier. However, some libraries like <code class="docutils literal notranslate"><span class="pre">libtorch</span></code>
are used by extension modules and themselves require loading dependencies. Some compiled libraries
cannot use Python to find their loader dependencies.</p>
</section>
<section id="include-support-for-hardlinks">
<h3><a class="toc-backref" href="#include-support-for-hardlinks" role="doc-backlink">Include Support for Hardlinks</a></h3>
<p>This PEP does not specify any behavior around hardlinks. This is intentional. This is left as an
extension to a future PEP.</p>
</section>
</section>
<section id="open-issues">
<h2><a class="toc-backref" href="#open-issues" role="doc-backlink">Open Issues</a></h2>
<section id="pep-660-and-deferring-editable-installation-support">
<h3><a class="toc-backref" href="#pep-660-and-deferring-editable-installation-support" role="doc-backlink">PEP 660 and Deferring Editable Installation Support</a></h3>
<p>This PEP leaves the specification and implementation of a <a class="pep reference internal" href="../pep-0660/" title="PEP 660 – Editable installs for pyproject.toml based builds (wheel based)">PEP 660</a> editable installation
mechanism as unresolved for a later PEP; should that be specified in this PEP?</p>
</section>
<section id="security">
<h3><a class="toc-backref" href="#security" role="doc-backlink">Security</a></h3>
<p>This PEP needs to be reviewed to make sure it would not allow for new security vulnerabilities.
Are there other restrictions we should place on the source or target of symlinks to protect users?</p>
</section>
<section id="allow-inter-package-symlinks">
<h3><a class="toc-backref" href="#allow-inter-package-symlinks" role="doc-backlink">Allow inter-package symlinks</a></h3>
<p>This could be useful for projects that want to shard dependencies such as large libraries between
wheels but make them available in the main parent wheel.</p>
</section>
<section id="the-format-of-links">
<h3><a class="toc-backref" href="#the-format-of-links" role="doc-backlink">The Format of <code class="docutils literal notranslate"><span class="pre">LINKS</span></code></a></h3>
<p>Currently the format is derived from <code class="docutils literal notranslate"><span class="pre">RECORD</span></code>, but perhaps a better format exists.</p>
</section>
</section>
<section id="previous-discussion">
<h2><a class="toc-backref" href="#previous-discussion" role="doc-backlink">Previous Discussion</a></h2>
<p><a class="reference external" href="https://discuss.python.org/t/symbolic-links-in-wheels/1945/25">https://discuss.python.org/t/symbolic-links-in-wheels/1945/25</a></p>
</section>
<section id="copyright">
<h2><a class="toc-backref" href="#copyright" role="doc-backlink">Copyright</a></h2>
<p>This document is placed in the public domain or under the
CC0-1.0-Universal license, whichever is more permissive.</p>
</section>
</section>
<hr class="docutils" />
<p>Source: <a class="reference external" href="https://github.com/python/peps/blob/main/peps/pep-0778.rst">https://github.com/python/peps/blob/main/peps/pep-0778.rst</a></p>
<p>Last modified: <a class="reference external" href="https://github.com/python/peps/commits/main/peps/pep-0778.rst">2025-07-09 03:07:54 GMT</a></p>

        </article>
        <nav id="pep-sidebar">
            <div id="search"></div>
            <h2>Contents</h2>
            <ul>
<li><a class="reference internal" href="#abstract">Abstract</a></li>
<li><a class="reference internal" href="#pep-deferral">PEP Deferral</a></li>
<li><a class="reference internal" href="#motivation">Motivation</a></li>
<li><a class="reference internal" href="#rationale">Rationale</a></li>
<li><a class="reference internal" href="#specification">Specification</a><ul>
<li><a class="reference internal" href="#wheel-major-version-bump">Wheel Major Version Bump</a></li>
<li><a class="reference internal" href="#new-links-metadata-file">New <code class="docutils literal notranslate"><span class="pre">LINKS</span></code> Metadata File</a></li>
<li><a class="reference internal" href="#installer-behavior-specification">Installer Behavior Specification</a></li>
<li><a class="reference internal" href="#build-backend-specification">Build Backend Specification</a></li>
</ul>
</li>
<li><a class="reference internal" href="#backwards-compatibility">Backwards Compatibility</a></li>
<li><a class="reference internal" href="#security-implications">Security Implications</a></li>
<li><a class="reference internal" href="#how-to-teach-this">How to Teach This</a></li>
<li><a class="reference internal" href="#reference-implementation">Reference Implementation</a></li>
<li><a class="reference internal" href="#rejected-ideas">Rejected Ideas</a><ul>
<li><a class="reference internal" href="#just-use-posix-symlinks-everywhere">Just Use POSIX Symlinks Everywhere</a></li>
<li><a class="reference internal" href="#don-t-use-junctions-in-links">Don’t Use Junctions in <code class="docutils literal notranslate"><span class="pre">LINKS</span></code></a></li>
<li><a class="reference internal" href="#put-symlinks-in-the-record-metadata-file">Put symlinks in the <code class="docutils literal notranslate"><span class="pre">RECORD</span></code> Metadata File</a></li>
<li><a class="reference internal" href="#library-maintainers-should-use-python-to-locate-libraries">Library Maintainers Should Use Python to Locate Libraries</a></li>
<li><a class="reference internal" href="#include-support-for-hardlinks">Include Support for Hardlinks</a></li>
</ul>
</li>
<li><a class="reference internal" href="#open-issues">Open Issues</a><ul>
<li><a class="reference internal" href="#pep-660-and-deferring-editable-installation-support">PEP 660 and Deferring Editable Installation Support</a></li>
<li><a class="reference internal" href="#security">Security</a></li>
<li><a class="reference internal" href="#allow-inter-package-symlinks">Allow inter-package symlinks</a></li>
<li><a class="reference internal" href="#the-format-of-links">The Format of <code class="docutils literal notranslate"><span class="pre">LINKS</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#previous-discussion">Previous Discussion</a></li>
<li><a class="reference internal" href="#copyright">Copyright</a></li>
</ul>

            <br>
            <a id="source" href="https://github.com/python/peps/blob/main/peps/pep-0778.rst?plain=1">Page Source (GitHub)</a>
        </nav>
    </section>
    <script src="../_static/colour_scheme.js"></script>
    <script src="../_static/wrap_tables.js"></script>
    <script src="../_static/sticky_banner.js"></script>
    <script src="https://analytics.python.org/js/script.outbound-links.js"
            data-domain="peps.python.org" defer></script>
    <script src="/pagefind/pagefind-ui.js"></script>
    <script>
        window.addEventListener('DOMContentLoaded', (event) => {
            // Ranking configuration to boost exact title matches
            const searchOptions = {
                ranking: {
                    termSimilarity: 9.0, // Higher values favor exact matches
                    termFrequency: 0.5, // Lower values reduce penalty for low term frequency
                    pageLength: 0.2, // Lower values reduce the impact of page length
                }
            };

            // Initialize pagefind for either mobile or desktop, not both
            if (window.innerWidth <= 640) {
                new PagefindUI({ element: "#mobile-search", ...searchOptions, showSubResults: false });
            } else {
                new PagefindUI({ element: "#search", ...searchOptions, showSubResults: true });
            }
        });
    </script>
</body>
</html>