
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="color-scheme" content="light dark">
    <title>PEP 237 – Unifying Long Integers and Integers | peps.python.org</title>
    <link rel="shortcut icon" href="../_static/py.png">
    <link rel="canonical" href="https://peps.python.org/pep-0237/">
    <link rel="stylesheet" href="../_static/style.css" type="text/css">
    <link rel="stylesheet" href="../_static/mq.css" type="text/css">
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" media="(prefers-color-scheme: light)" id="pyg-light">
    <link rel="stylesheet" href="../_static/pygments_dark.css" type="text/css" media="(prefers-color-scheme: dark)" id="pyg-dark">
    <link rel="alternate" type="application/rss+xml" title="Latest PEPs" href="https://peps.python.org/peps.rss">
    <meta property="og:title" content='PEP 237 – Unifying Long Integers and Integers | peps.python.org'>
    <meta property="og:description" content="Python currently distinguishes between two kinds of integers (ints): regular or short ints, limited by the size of a C long (typically 32 or 64 bits), and long ints, which are limited only by available memory.  When operations on short ints yield result...">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://peps.python.org/pep-0237/">
    <meta property="og:site_name" content="Python Enhancement Proposals (PEPs)">
    <meta property="og:image" content="https://peps.python.org/_static/og-image.png">
    <meta property="og:image:alt" content="Python PEPs">
    <meta property="og:image:width" content="200">
    <meta property="og:image:height" content="200">
    <meta name="description" content="Python currently distinguishes between two kinds of integers (ints): regular or short ints, limited by the size of a C long (typically 32 or 64 bits), and long ints, which are limited only by available memory.  When operations on short ints yield result...">
    <meta name="theme-color" content="#3776ab">
</head>
<body>
    
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-sun-half" viewBox="0 0 24 24" pointer-events="all">
    <title>Following system colour scheme</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none"
         stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <circle cx="12" cy="12" r="9"></circle>
      <path d="M12 3v18m0-12l4.65-4.65M12 14.3l7.37-7.37M12 19.6l8.85-8.85"></path>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24" pointer-events="all">
    <title>Selected dark colour scheme</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none"
         stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z"></path>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24" pointer-events="all">
    <title>Selected light colour scheme</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none"
         stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
</svg>
    <script>

        document.documentElement.dataset.colour_scheme = localStorage.getItem("colour_scheme") || "auto"
    </script>
    <section id="pep-page-section">
        <header>
            <h1>Python Enhancement Proposals</h1>
            <ul class="breadcrumbs">
                <li><a href="https://www.python.org/" title="The Python Programming Language">Python</a> &raquo; </li>
                <li><a href="../pep-0000/">PEP Index</a> &raquo; </li>
                <li>PEP 237</li>
            </ul>
            <button id="colour-scheme-cycler" onClick="setColourScheme(nextColourScheme())">
                <svg aria-hidden="true" class="colour-scheme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
                <svg aria-hidden="true" class="colour-scheme-icon-when-dark"><use href="#svg-moon"></use></svg>
                <svg aria-hidden="true" class="colour-scheme-icon-when-light"><use href="#svg-sun"></use></svg>
                <span class="visually-hidden">Toggle light / dark / auto colour theme</span>
            </button>
        </header>
        <article>
            <section id="pep-content">
<h1 class="page-title">PEP 237 – Unifying Long Integers and Integers</h1>
<dl class="rfc2822 field-list simple">
<dt class="field-odd">Author<span class="colon">:</span></dt>
<dd class="field-odd">Moshe Zadka, Guido van Rossum</dd>
<dt class="field-even">Status<span class="colon">:</span></dt>
<dd class="field-even"><abbr title="Accepted and implementation complete, or no longer active">Final</abbr></dd>
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><abbr title="Normative PEP with a new feature for Python, implementation change for CPython or interoperability standard for the ecosystem">Standards Track</abbr></dd>
<dt class="field-even">Created<span class="colon">:</span></dt>
<dd class="field-even">11-Mar-2001</dd>
<dt class="field-odd">Python-Version<span class="colon">:</span></dt>
<dd class="field-odd">2.2</dd>
<dt class="field-even">Post-History<span class="colon">:</span></dt>
<dd class="field-even">16-Mar-2001, 14-Aug-2001, 23-Aug-2001</dd>
</dl>
<hr class="docutils" />
<section id="contents">
<details><summary>Table of Contents</summary><ul class="simple">
<li><a class="reference internal" href="#abstract">Abstract</a></li>
<li><a class="reference internal" href="#rationale">Rationale</a></li>
<li><a class="reference internal" href="#implementation">Implementation</a></li>
<li><a class="reference internal" href="#incompatibilities">Incompatibilities</a></li>
<li><a class="reference internal" href="#literals">Literals</a></li>
<li><a class="reference internal" href="#built-in-functions">Built-in Functions</a></li>
<li><a class="reference internal" href="#c-api">C API</a></li>
<li><a class="reference internal" href="#transition">Transition</a></li>
<li><a class="reference internal" href="#overflowwarning">OverflowWarning</a></li>
<li><a class="reference internal" href="#example">Example</a></li>
<li><a class="reference internal" href="#resolved-issues">Resolved Issues</a></li>
<li><a class="reference internal" href="#id1">Implementation</a></li>
<li><a class="reference internal" href="#copyright">Copyright</a></li>
</ul>
</details></section>
<section id="abstract">
<h2><a class="toc-backref" href="#abstract" role="doc-backlink">Abstract</a></h2>
<p>Python currently distinguishes between two kinds of integers (ints): regular
or short ints, limited by the size of a C long (typically 32 or 64 bits), and
long ints, which are limited only by available memory.  When operations on
short ints yield results that don’t fit in a C long, they raise an error.
There are some other distinctions too.  This PEP proposes to do away with most
of the differences in semantics, unifying the two types from the perspective
of the Python user.</p>
</section>
<section id="rationale">
<h2><a class="toc-backref" href="#rationale" role="doc-backlink">Rationale</a></h2>
<p>Many programs find a need to deal with larger numbers after the fact, and
changing the algorithms later is bothersome.  It can hinder performance in the
normal case, when all arithmetic is performed using long ints whether or not
they are needed.</p>
<p>Having the machine word size exposed to the language hinders portability.  For
examples Python source files and .pyc’s are not portable between 32-bit and
64-bit machines because of this.</p>
<p>There is also the general desire to hide unnecessary details from the Python
user when they are irrelevant for most applications. An example is memory
allocation, which is explicit in C but automatic in Python, giving us the
convenience of unlimited sizes on strings, lists, etc.  It makes sense to
extend this convenience to numbers.</p>
<p>It will give new Python programmers (whether they are new to programming in
general or not) one less thing to learn before they can start using the
language.</p>
</section>
<section id="implementation">
<h2><a class="toc-backref" href="#implementation" role="doc-backlink">Implementation</a></h2>
<p>Initially, two alternative implementations were proposed (one by each author):</p>
<ol class="arabic">
<li>The <code class="docutils literal notranslate"><span class="pre">PyInt</span></code> type’s slot for a C long will be turned into a:<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">union</span> <span class="p">{</span>
    <span class="n">long</span> <span class="n">i</span><span class="p">;</span>
    <span class="n">struct</span> <span class="p">{</span>
        <span class="n">unsigned</span> <span class="n">long</span> <span class="n">length</span><span class="p">;</span>
        <span class="n">digit</span> <span class="n">digits</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
    <span class="p">}</span> <span class="n">bignum</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>
</div>
<p>Only the <code class="docutils literal notranslate"><span class="pre">n-1</span></code> lower bits of the <code class="docutils literal notranslate"><span class="pre">long</span></code> have any meaning; the top bit
is always set.  This distinguishes the <code class="docutils literal notranslate"><span class="pre">union</span></code>.  All <code class="docutils literal notranslate"><span class="pre">PyInt</span></code> functions
will check this bit before deciding which types of operations to use.</p>
</li>
<li>The existing short and long int types remain, but operations return
a long int instead of raising <code class="docutils literal notranslate"><span class="pre">OverflowError</span></code> when a result cannot be
represented as a short int.  A new type, <code class="docutils literal notranslate"><span class="pre">integer</span></code>, may be introduced
that is an abstract base type of which both the <code class="docutils literal notranslate"><span class="pre">int</span></code> and <code class="docutils literal notranslate"><span class="pre">long</span></code>
implementation types are subclassed.  This is useful so that programs can
check integer-ness with a single test:<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">integer</span><span class="p">):</span> <span class="o">...</span>
</pre></div>
</div>
</li>
</ol>
<p>After some consideration, the second implementation plan was selected, since
it is far easier to implement, is backwards compatible at the C API level, and
in addition can be implemented partially as a transitional measure.</p>
</section>
<section id="incompatibilities">
<h2><a class="toc-backref" href="#incompatibilities" role="doc-backlink">Incompatibilities</a></h2>
<p>The following operations have (usually subtly) different semantics for short
and for long integers, and one or the other will have to be changed somehow.
This is intended to be an exhaustive list. If you know of any other operation
that differ in outcome depending on whether a short or a long int with the same
value is passed, please write the second author.</p>
<ul class="simple">
<li>Currently, all arithmetic operators on short ints except <code class="docutils literal notranslate"><span class="pre">&lt;&lt;</span></code> raise
<code class="docutils literal notranslate"><span class="pre">OverflowError</span></code> if the result cannot be represented as a short int.  This
will be changed to return a long int instead. The following operators can
currently raise <code class="docutils literal notranslate"><span class="pre">OverflowError</span></code>: <code class="docutils literal notranslate"><span class="pre">x+y</span></code>, <code class="docutils literal notranslate"><span class="pre">x-y</span></code>, <code class="docutils literal notranslate"><span class="pre">x*y</span></code>, <code class="docutils literal notranslate"><span class="pre">x**y</span></code>,
<code class="docutils literal notranslate"><span class="pre">divmod(x,</span> <span class="pre">y)</span></code>, <code class="docutils literal notranslate"><span class="pre">x/y</span></code>, <code class="docutils literal notranslate"><span class="pre">x%y</span></code>, and <code class="docutils literal notranslate"><span class="pre">-x</span></code>.  (The last four can only
overflow when the value <code class="docutils literal notranslate"><span class="pre">-sys.maxint-1</span></code> is involved.)</li>
<li>Currently, <code class="docutils literal notranslate"><span class="pre">x&lt;&lt;n</span></code> can lose bits for short ints.  This will be changed to
return a long int containing all the shifted-out bits, if returning a short
int would lose bits (where changing sign is considered a special case of
losing bits).</li>
<li>Currently, hex and oct literals for short ints may specify negative values;
for example <code class="docutils literal notranslate"><span class="pre">0xffffffff</span> <span class="pre">==</span> <span class="pre">-1</span></code> on a 32-bit machine.  This will be changed
to equal <code class="docutils literal notranslate"><span class="pre">0xffffffffL</span></code> (<code class="docutils literal notranslate"><span class="pre">2**32-1</span></code>).</li>
<li>Currently, the <code class="docutils literal notranslate"><span class="pre">%u</span></code>, <code class="docutils literal notranslate"><span class="pre">%x</span></code>, <code class="docutils literal notranslate"><span class="pre">%X</span></code> and <code class="docutils literal notranslate"><span class="pre">%o</span></code> string formatting operators
and the <code class="docutils literal notranslate"><span class="pre">hex()</span></code> and <code class="docutils literal notranslate"><span class="pre">oct()</span></code> built-in functions behave differently for
negative numbers: negative short ints are formatted as unsigned C long,
while negative long ints are formatted with a minus sign.  This will be
changed to use the long int semantics in all cases (but without the trailing
<em>L</em> that currently distinguishes the output of <code class="docutils literal notranslate"><span class="pre">hex()</span></code> and <code class="docutils literal notranslate"><span class="pre">oct()</span></code> for
long ints).  Note that this means that <code class="docutils literal notranslate"><span class="pre">%u</span></code> becomes an alias for <code class="docutils literal notranslate"><span class="pre">%d</span></code>.
It will eventually be removed.</li>
<li>Currently, <code class="docutils literal notranslate"><span class="pre">repr()</span></code> of a long int returns a string ending in <em>L</em> while
<code class="docutils literal notranslate"><span class="pre">repr()</span></code> of a short int doesn’t.  The <em>L</em> will be dropped; but not before
Python 3.0.</li>
<li>Currently, an operation with long operands will never return a short int.
This <em>may</em> change, since it allows some optimization.  (No changes have been
made in this area yet, and none are planned.)</li>
<li>The expression <code class="docutils literal notranslate"><span class="pre">type(x).__name__</span></code> depends on whether <em>x</em> is a short or a
long int.  Since implementation alternative 2 is chosen, this difference
will remain.  (In Python 3.0, we <em>may</em> be able to deploy a trick to hide the
difference, because it <em>is</em> annoying to reveal the difference to user code,
and more so as the difference between the two types is less visible.)</li>
<li>Long and short ints are handled different by the <code class="docutils literal notranslate"><span class="pre">marshal</span></code> module, and by
the <code class="docutils literal notranslate"><span class="pre">pickle</span></code> and <code class="docutils literal notranslate"><span class="pre">cPickle</span></code> modules.  This difference will remain (at
least until Python 3.0).</li>
<li>Short ints with small values (typically between -1 and 99 inclusive) are
<em>interned</em> – whenever a result has such a value, an existing short int with
the same value is returned.  This is not done for long ints with the same
values.  This difference will remain.  (Since there is no guarantee of this
interning, it is debatable whether this is a semantic difference – but code
may exist that uses <code class="docutils literal notranslate"><span class="pre">is</span></code> for comparisons of short ints and happens to work
because of this interning.  Such code may fail if used with long ints.)</li>
</ul>
</section>
<section id="literals">
<h2><a class="toc-backref" href="#literals" role="doc-backlink">Literals</a></h2>
<p>A trailing <em>L</em> at the end of an integer literal will stop having any
meaning, and will be eventually become illegal.  The compiler will choose the
appropriate type solely based on the value. (Until Python 3.0, it will force
the literal to be a long; but literals without a trailing <em>L</em> may also be
long, if they are not representable as short ints.)</p>
</section>
<section id="built-in-functions">
<h2><a class="toc-backref" href="#built-in-functions" role="doc-backlink">Built-in Functions</a></h2>
<p>The function <code class="docutils literal notranslate"><span class="pre">int()</span></code> will return a short or a long int depending on the
argument value.  In Python 3.0, the function <code class="docutils literal notranslate"><span class="pre">long()</span></code> will call the function
<code class="docutils literal notranslate"><span class="pre">int()</span></code>; before then, it will continue to force the result to be a long int,
but otherwise work the same way as <code class="docutils literal notranslate"><span class="pre">int()</span></code>. The built-in name <code class="docutils literal notranslate"><span class="pre">long</span></code> will
remain in the language to represent the long implementation type (unless it is
completely eradicated in Python 3.0), but using the <code class="docutils literal notranslate"><span class="pre">int()</span></code> function is
still recommended, since it will automatically return a long when needed.</p>
</section>
<section id="c-api">
<h2><a class="toc-backref" href="#c-api" role="doc-backlink">C API</a></h2>
<p>The C API remains unchanged; C code will still need to be aware of the
difference between short and long ints.  (The Python 3.0 C API will probably
be completely incompatible.)</p>
<p>The <code class="docutils literal notranslate"><span class="pre">PyArg_Parse*()</span></code> APIs already accept long ints, as long as they are
within the range representable by C ints or longs, so that functions taking C
int or long argument won’t have to worry about dealing with Python longs.</p>
</section>
<section id="transition">
<h2><a class="toc-backref" href="#transition" role="doc-backlink">Transition</a></h2>
<p>There are three major phases to the transition:</p>
<ol class="arabic simple">
<li>Short int operations that currently raise <code class="docutils literal notranslate"><span class="pre">OverflowError</span></code> return a long
int value instead.  This is the only change in this phase.  Literals will
still distinguish between short and long ints.  The other semantic
differences listed above (including the behavior of <code class="docutils literal notranslate"><span class="pre">&lt;&lt;</span></code>) will remain.
Because this phase only changes situations that currently raise
<code class="docutils literal notranslate"><span class="pre">OverflowError</span></code>, it is assumed that this won’t break existing code.
(Code that depends on this exception would have to be too convoluted to be
concerned about it.)  For those concerned about extreme backwards
compatibility, a command line option (or a call to the warnings module)
will allow a warning or an error to be issued at this point, but this is
off by default.</li>
<li>The remaining semantic differences are addressed.  In all cases the long
int semantics will prevail.  Since this will introduce backwards
incompatibilities which will break some old code, this phase may require a
future statement and/or warnings, and a prolonged transition phase.  The
trailing <em>L</em> will continue to be used for longs as input and by
<code class="docutils literal notranslate"><span class="pre">repr()</span></code>.<ol class="upperalpha simple">
<li>Warnings are enabled about operations that will change their numeric
outcome in stage 2B, in particular <code class="docutils literal notranslate"><span class="pre">hex()</span></code> and <code class="docutils literal notranslate"><span class="pre">oct()</span></code>, <code class="docutils literal notranslate"><span class="pre">%u</span></code>,
<code class="docutils literal notranslate"><span class="pre">%x</span></code>, <code class="docutils literal notranslate"><span class="pre">%X</span></code> and <code class="docutils literal notranslate"><span class="pre">%o</span></code>, <code class="docutils literal notranslate"><span class="pre">hex</span></code> and <code class="docutils literal notranslate"><span class="pre">oct</span></code> literals in the
(inclusive) range <code class="docutils literal notranslate"><span class="pre">[sys.maxint+1,</span> <span class="pre">sys.maxint*2+1]</span></code>, and left shifts
losing bits.</li>
<li>The new semantic for these operations are implemented. Operations that
give different results than before will <em>not</em> issue a warning.</li>
</ol>
</li>
<li>The trailing <em>L</em> is dropped from <code class="docutils literal notranslate"><span class="pre">repr()</span></code>, and made illegal on input.
(If possible, the <code class="docutils literal notranslate"><span class="pre">long</span></code> type completely disappears.) The trailing <em>L</em>
is also dropped from <code class="docutils literal notranslate"><span class="pre">hex()</span></code> and <code class="docutils literal notranslate"><span class="pre">oct()</span></code>.</li>
</ol>
<p>Phase 1 will be implemented in Python 2.2.</p>
<p>Phase 2 will be implemented gradually, with 2A in Python 2.3 and 2B in
Python 2.4.</p>
<p>Phase 3 will be implemented in Python 3.0 (at least two years after Python 2.4
is released).</p>
</section>
<section id="overflowwarning">
<h2><a class="toc-backref" href="#overflowwarning" role="doc-backlink">OverflowWarning</a></h2>
<p>Here are the rules that guide warnings generated in situations that currently
raise <code class="docutils literal notranslate"><span class="pre">OverflowError</span></code>.  This applies to transition phase 1.  Historical
note: despite that phase 1 was completed in Python 2.2, and phase 2A in Python
2.3, nobody noticed that OverflowWarning was still generated in Python 2.3.
It was finally disabled in Python 2.4.  The Python builtin
<code class="docutils literal notranslate"><span class="pre">OverflowWarning</span></code>, and the corresponding C API <code class="docutils literal notranslate"><span class="pre">PyExc_OverflowWarning</span></code>,
are no longer generated or used in Python 2.4, but will remain for the
(unlikely) case of user code until Python 2.5.</p>
<ul>
<li>A new warning category is introduced, <code class="docutils literal notranslate"><span class="pre">OverflowWarning</span></code>.  This is a
built-in name.</li>
<li>If an int result overflows, an <code class="docutils literal notranslate"><span class="pre">OverflowWarning</span></code> warning is issued, with a
message argument indicating the operation, e.g. “integer addition”.  This
may or may not cause a warning message to be displayed on <code class="docutils literal notranslate"><span class="pre">sys.stderr</span></code>, or
may cause an exception to be raised, all under control of the <code class="docutils literal notranslate"><span class="pre">-W</span></code> command
line and the warnings module.</li>
<li>The <code class="docutils literal notranslate"><span class="pre">OverflowWarning</span></code> warning is ignored by default.</li>
<li>The <code class="docutils literal notranslate"><span class="pre">OverflowWarning</span></code> warning can be controlled like all warnings, via the
<code class="docutils literal notranslate"><span class="pre">-W</span></code> command line option or via the <code class="docutils literal notranslate"><span class="pre">warnings.filterwarnings()</span></code> call.
For example:<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">-</span><span class="n">Wdefault</span><span class="p">::</span><span class="n">OverflowWarning</span>
</pre></div>
</div>
<p>cause the <code class="docutils literal notranslate"><span class="pre">OverflowWarning</span></code> to be displayed the first time it occurs at a
particular source line, and:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">-</span><span class="n">Werror</span><span class="p">::</span><span class="n">OverflowWarning</span>
</pre></div>
</div>
<p>cause the <code class="docutils literal notranslate"><span class="pre">OverflowWarning</span></code> to be turned into an exception whenever it
happens.  The following code enables the warning from inside the program:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;default&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">OverflowWarning</span><span class="p">)</span>
</pre></div>
</div>
<p>See the python <code class="docutils literal notranslate"><span class="pre">man</span></code> page for the <code class="docutils literal notranslate"><span class="pre">-W</span></code> option and the <code class="docutils literal notranslate"><span class="pre">warnings</span></code>
module documentation for <code class="docutils literal notranslate"><span class="pre">filterwarnings()</span></code>.</p>
</li>
<li>If the <code class="docutils literal notranslate"><span class="pre">OverflowWarning</span></code> warning is turned into an error,
<code class="docutils literal notranslate"><span class="pre">OverflowError</span></code> is substituted.  This is needed for backwards
compatibility.</li>
<li>Unless the warning is turned into an exceptions, the result of the operation
(e.g., <code class="docutils literal notranslate"><span class="pre">x+y</span></code>) is recomputed after converting the arguments to long ints.</li>
</ul>
</section>
<section id="example">
<h2><a class="toc-backref" href="#example" role="doc-backlink">Example</a></h2>
<p>If you pass a long int to a C function or built-in operation that takes an
integer, it will be treated the same as a short int as long as the value fits
(by virtue of how <code class="docutils literal notranslate"><span class="pre">PyArg_ParseTuple()</span></code> is implemented).  If the long value
doesn’t fit, it will still raise an <code class="docutils literal notranslate"><span class="pre">OverflowError</span></code>.  For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">fact</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
    <span class="k">return</span> <span class="mi">1</span>
<span class="k">return</span> <span class="n">n</span><span class="o">*</span><span class="n">fact</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="n">A</span> <span class="o">=</span> <span class="s2">&quot;ABCDEFGHIJKLMNOPQ&quot;</span>
<span class="n">n</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Gimme an int: &quot;</span><span class="p">)</span>
<span class="nb">print</span> <span class="n">A</span><span class="p">[</span><span class="n">fact</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">%</span><span class="mi">17</span><span class="p">]</span>
</pre></div>
</div>
<p>For <code class="docutils literal notranslate"><span class="pre">n</span> <span class="pre">&gt;=</span> <span class="pre">13</span></code>, this currently raises <code class="docutils literal notranslate"><span class="pre">OverflowError</span></code> (unless the user
enters a trailing <em>L</em> as part of their input), even though the calculated
index would always be in <code class="docutils literal notranslate"><span class="pre">range(17)</span></code>.  With the new approach this code will
do the right thing: the index will be calculated as a long int, but its value
will be in range.</p>
</section>
<section id="resolved-issues">
<h2><a class="toc-backref" href="#resolved-issues" role="doc-backlink">Resolved Issues</a></h2>
<p>These issues, previously open, have been resolved.</p>
<ul>
<li><code class="docutils literal notranslate"><span class="pre">hex()</span></code> and <code class="docutils literal notranslate"><span class="pre">oct()</span></code> applied to longs will continue to produce a trailing
<em>L</em> until Python 3000.  The original text above wasn’t clear about this,
but since it didn’t happen in Python 2.4 it was thought better to leave it
alone.  BDFL pronouncement here:<p><a class="reference external" href="https://mail.python.org/pipermail/python-dev/2006-June/065918.html">https://mail.python.org/pipermail/python-dev/2006-June/065918.html</a></p>
</li>
<li>What to do about <code class="docutils literal notranslate"><span class="pre">sys.maxint</span></code>?  Leave it in, since it is still relevant
whenever the distinction between short and long ints is still relevant (e.g.
when inspecting the type of a value).</li>
<li>Should we remove <code class="docutils literal notranslate"><span class="pre">%u</span></code> completely?  Remove it.</li>
<li>Should we warn about <code class="docutils literal notranslate"><span class="pre">&lt;&lt;</span></code> not truncating integers?  Yes.</li>
<li>Should the overflow warning be on a portable maximum size?  No.</li>
</ul>
</section>
<section id="id1">
<h2><a class="toc-backref" href="#id1" role="doc-backlink">Implementation</a></h2>
<p>The implementation work for the Python 2.x line is completed; phase 1 was
released with Python 2.2, phase 2A with Python 2.3, and phase 2B will be
released with Python 2.4 (and is already in CVS).</p>
</section>
<section id="copyright">
<h2><a class="toc-backref" href="#copyright" role="doc-backlink">Copyright</a></h2>
<p>This document has been placed in the public domain.</p>
</section>
</section>
<hr class="docutils" />
<p>Source: <a class="reference external" href="https://github.com/python/peps/blob/main/peps/pep-0237.rst">https://github.com/python/peps/blob/main/peps/pep-0237.rst</a></p>
<p>Last modified: <a class="reference external" href="https://github.com/python/peps/commits/main/peps/pep-0237.rst">2025-02-01 08:59:27 GMT</a></p>

        </article>
        <nav id="pep-sidebar">
            <h2>Contents</h2>
            <ul>
<li><a class="reference internal" href="#abstract">Abstract</a></li>
<li><a class="reference internal" href="#rationale">Rationale</a></li>
<li><a class="reference internal" href="#implementation">Implementation</a></li>
<li><a class="reference internal" href="#incompatibilities">Incompatibilities</a></li>
<li><a class="reference internal" href="#literals">Literals</a></li>
<li><a class="reference internal" href="#built-in-functions">Built-in Functions</a></li>
<li><a class="reference internal" href="#c-api">C API</a></li>
<li><a class="reference internal" href="#transition">Transition</a></li>
<li><a class="reference internal" href="#overflowwarning">OverflowWarning</a></li>
<li><a class="reference internal" href="#example">Example</a></li>
<li><a class="reference internal" href="#resolved-issues">Resolved Issues</a></li>
<li><a class="reference internal" href="#id1">Implementation</a></li>
<li><a class="reference internal" href="#copyright">Copyright</a></li>
</ul>

            <br>
            <a id="source" href="https://github.com/python/peps/blob/main/peps/pep-0237.rst?plain=1">Page Source (GitHub)</a>
        </nav>
    </section>
    <script src="../_static/colour_scheme.js"></script>
    <script src="../_static/wrap_tables.js"></script>
    <script src="../_static/sticky_banner.js"></script>
    <script src="https://analytics.python.org/js/script.outbound-links.js"
            data-domain="peps.python.org" defer></script>
</body>
</html>