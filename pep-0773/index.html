
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="color-scheme" content="light dark">
    <title>PEP 773 – A Python Installation Manager for Windows | peps.python.org</title>
    <link rel="shortcut icon" href="../_static/py.png">
    <link rel="canonical" href="https://peps.python.org/pep-0773/">
    <link rel="stylesheet" href="../_static/style.css" type="text/css">
    <link rel="stylesheet" href="../_static/mq.css" type="text/css">
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" media="(prefers-color-scheme: light)" id="pyg-light">
    <link rel="stylesheet" href="../_static/pygments_dark.css" type="text/css" media="(prefers-color-scheme: dark)" id="pyg-dark">
    <link rel="alternate" type="application/rss+xml" title="Latest PEPs" href="https://peps.python.org/peps.rss">
    <meta property="og:title" content='PEP 773 – A Python Installation Manager for Windows | peps.python.org'>
    <meta property="og:description" content="Installation of the python.org Python distribution on Windows is complex. There are three main approaches with roughly equivalent levels of user experience, and yet all of these suffer from different limitations, including failing to satisfy modern usag...">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://peps.python.org/pep-0773/">
    <meta property="og:site_name" content="Python Enhancement Proposals (PEPs)">
    <meta property="og:image" content="https://peps.python.org/_static/og-image.png">
    <meta property="og:image:alt" content="Python PEPs">
    <meta property="og:image:width" content="200">
    <meta property="og:image:height" content="200">
    <meta name="description" content="Installation of the python.org Python distribution on Windows is complex. There are three main approaches with roughly equivalent levels of user experience, and yet all of these suffer from different limitations, including failing to satisfy modern usag...">
    <meta name="theme-color" content="#3776ab">
</head>
<body>
    
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-sun-half" viewBox="0 0 24 24" pointer-events="all">
    <title>Following system colour scheme</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none"
         stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <circle cx="12" cy="12" r="9"></circle>
      <path d="M12 3v18m0-12l4.65-4.65M12 14.3l7.37-7.37M12 19.6l8.85-8.85"></path>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24" pointer-events="all">
    <title>Selected dark colour scheme</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none"
         stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z"></path>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24" pointer-events="all">
    <title>Selected light colour scheme</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none"
         stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
</svg>
    <script>

        document.documentElement.dataset.colour_scheme = localStorage.getItem("colour_scheme") || "auto"
    </script>
    <section id="pep-page-section">
        <header>
            <h1>Python Enhancement Proposals</h1>
            <ul class="breadcrumbs">
                <li><a href="https://www.python.org/" title="The Python Programming Language">Python</a> &raquo; </li>
                <li><a href="../pep-0000/">PEP Index</a> &raquo; </li>
                <li>PEP 773</li>
            </ul>
            <button id="colour-scheme-cycler" onClick="setColourScheme(nextColourScheme())">
                <svg aria-hidden="true" class="colour-scheme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
                <svg aria-hidden="true" class="colour-scheme-icon-when-dark"><use href="#svg-moon"></use></svg>
                <svg aria-hidden="true" class="colour-scheme-icon-when-light"><use href="#svg-sun"></use></svg>
                <span class="visually-hidden">Toggle light / dark / auto colour theme</span>
            </button>
        </header>
        <article>
            <section id="pep-content">
<h1 class="page-title">PEP 773 – A Python Installation Manager for Windows</h1>
<dl class="rfc2822 field-list simple">
<dt class="field-odd">Author<span class="colon">:</span></dt>
<dd class="field-odd">Steve Dower</dd>
<dt class="field-even">Discussions-To<span class="colon">:</span></dt>
<dd class="field-even"><a class="reference external" href="https://discuss.python.org/t/77900/">Discourse thread</a></dd>
<dt class="field-odd">Status<span class="colon">:</span></dt>
<dd class="field-odd"><abbr title="Normative proposal accepted for implementation">Accepted</abbr></dd>
<dt class="field-even">Type<span class="colon">:</span></dt>
<dd class="field-even"><abbr title="Normative PEP with a new feature for Python, implementation change for CPython or interoperability standard for the ecosystem">Standards Track</abbr></dd>
<dt class="field-odd">Topic<span class="colon">:</span></dt>
<dd class="field-odd"><a class="reference external" href="../topic/release/">Release</a></dd>
<dt class="field-even">Created<span class="colon">:</span></dt>
<dd class="field-even">21-Jan-2025</dd>
<dt class="field-odd">Post-History<span class="colon">:</span></dt>
<dd class="field-odd"><a class="reference external" href="https://discuss.python.org/t/74556/" title="Discourse thread">18-Dec-2024</a>,
<a class="reference external" href="https://discuss.python.org/t/77900/" title="Discourse thread">21-Jan-2025</a></dd>
<dt class="field-even">Replaces<span class="colon">:</span></dt>
<dd class="field-even"><a class="reference external" href="../pep-0397/">397</a>, <a class="reference external" href="../pep-0486/">486</a></dd>
<dt class="field-odd">Resolution<span class="colon">:</span></dt>
<dd class="field-odd"><a class="reference external" href="https://discuss.python.org/t/77900/180">25-Apr-2025</a></dd>
</dl>
<hr class="docutils" />
<section id="contents">
<details><summary>Table of Contents</summary><ul class="simple">
<li><a class="reference internal" href="#abstract">Abstract</a><ul>
<li><a class="reference internal" href="#reader-s-note">Reader’s Note</a></li>
</ul>
</li>
<li><a class="reference internal" href="#background">Background</a><ul>
<li><a class="reference internal" href="#expectations">Expectations</a></li>
<li><a class="reference internal" href="#traditional-installer">Traditional Installer</a></li>
<li><a class="reference internal" href="#windows-store">Windows Store</a></li>
<li><a class="reference internal" href="#nuget-package">NuGet Package</a></li>
<li><a class="reference internal" href="#embeddable-package">Embeddable Package</a></li>
<li><a class="reference internal" href="#alternate-distributions">Alternate Distributions</a></li>
<li><a class="reference internal" href="#challenges">Challenges</a></li>
</ul>
</li>
<li><a class="reference internal" href="#overview-of-pymanager">Overview of PyManager</a><ul>
<li><a class="reference internal" href="#replacing-other-installers">Replacing other installers</a></li>
<li><a class="reference internal" href="#project-ownership-and-development">Project ownership and development</a></li>
</ul>
</li>
<li><a class="reference internal" href="#specification">Specification</a><ul>
<li><a class="reference internal" href="#exec-subcommand">Exec subcommand</a></li>
<li><a class="reference internal" href="#install-subcommand">Install subcommand</a></li>
<li><a class="reference internal" href="#uninstall-subcommand">Uninstall subcommand</a></li>
<li><a class="reference internal" href="#list-subcommand">List subcommand</a></li>
<li><a class="reference internal" href="#help-subcommand">Help subcommand</a></li>
<li><a class="reference internal" href="#environment-variables">Environment Variables</a></li>
<li><a class="reference internal" href="#start-menu-shortcuts">Start Menu Shortcuts</a></li>
<li><a class="reference internal" href="#file-associations">File Associations</a></li>
<li><a class="reference internal" href="#windowed-executables">Windowed Executables</a></li>
<li><a class="reference internal" href="#configuration">Configuration</a></li>
<li><a class="reference internal" href="#index-schema">Index Schema</a></li>
<li><a class="reference internal" href="#shebang-processing">Shebang Processing</a></li>
</ul>
</li>
<li><a class="reference internal" href="#rationale">Rationale</a><ul>
<li><a class="reference internal" href="#changing-the-python-exe-command">“Changing” the python.exe command</a></li>
<li><a class="reference internal" href="#replacing-py-exe">Replacing py.exe</a></li>
<li><a class="reference internal" href="#interaction-with-venv">Interaction with venv</a></li>
</ul>
</li>
<li><a class="reference internal" href="#backwards-compatibility">Backwards Compatibility</a><ul>
<li><a class="reference internal" href="#scripted-downloads">Scripted downloads</a></li>
<li><a class="reference internal" href="#scripted-installs">Scripted installs</a></li>
<li><a class="reference internal" href="#old-runtime-installed">Old runtime installed</a></li>
<li><a class="reference internal" href="#old-py-exe-launcher-installed">Old <code class="docutils literal notranslate"><span class="pre">py.exe</span></code> launcher installed</a></li>
<li><a class="reference internal" href="#misconfigured-venv-activated">Misconfigured venv activated</a></li>
<li><a class="reference internal" href="#old-version-availability">Old version availability</a></li>
<li><a class="reference internal" href="#administrator-installs">Administrator installs</a></li>
<li><a class="reference internal" href="#build-time-installs">Build-time installs</a></li>
<li><a class="reference internal" href="#single-architecture-installer">Single architecture installer</a></li>
<li><a class="reference internal" href="#test-suite-and-debug-symbols">Test suite and debug symbols</a></li>
<li><a class="reference internal" href="#global-pip-command">Global pip command</a></li>
</ul>
</li>
<li><a class="reference internal" href="#security-implications">Security Implications</a></li>
<li><a class="reference internal" href="#impact-on-existing-peps">Impact on Existing PEPs</a></li>
<li><a class="reference internal" href="#how-to-teach-this">How to Teach This</a><ul>
<li><a class="reference internal" href="#basic-use">Basic Use</a></li>
<li><a class="reference internal" href="#uninstallation">Uninstallation</a></li>
<li><a class="reference internal" href="#id1">Configuration</a></li>
<li><a class="reference internal" href="#custom-index">Custom Index</a></li>
</ul>
</li>
<li><a class="reference internal" href="#reference-implementation">Reference Implementation</a></li>
<li><a class="reference internal" href="#rejected-ideas">Rejected Ideas</a><ul>
<li><a class="reference internal" href="#make-pymanager-available-on-all-platforms">Make PyManager available on all platforms</a></li>
<li><a class="reference internal" href="#include-a-runtime-pre-installed-with-the-manager">Include a runtime pre-installed with the manager</a></li>
<li><a class="reference internal" href="#include-a-runtime-instead-of-the-manager">Include a runtime INSTEAD OF the manager</a></li>
<li><a class="reference internal" href="#use-a-built-in-module-rather-than-subcommands">Use a built-in module rather than subcommands</a></li>
<li><a class="reference internal" href="#use-a-new-command-line-option-rather-than-subcommands">Use a new command-line option rather than subcommands</a></li>
<li><a class="reference internal" href="#improving-the-current-traditional-installer-instead">Improving the current traditional installer instead</a></li>
<li><a class="reference internal" href="#delete-the-store-package-completely">Delete the Store package completely</a></li>
<li><a class="reference internal" href="#rely-on-winget-or-equivalents">Rely on WinGet or equivalents</a></li>
<li><a class="reference internal" href="#make-every-version-a-windows-store-package">Make every version a Windows Store package</a></li>
<li><a class="reference internal" href="#just-publish-the-plain-zip-file">Just publish the plain ZIP file</a></li>
<li><a class="reference internal" href="#only-publish-pymanager-to-one-place">Only publish PyManager to one place</a></li>
<li><a class="reference internal" href="#inline-script-metadata">Inline Script Metadata</a></li>
</ul>
</li>
<li><a class="reference internal" href="#copyright">Copyright</a></li>
</ul>
</details></section>
<section id="abstract">
<h2><a class="toc-backref" href="#abstract" role="doc-backlink">Abstract</a></h2>
<p>Installation of the python.org Python distribution on Windows is complex.
There are three main approaches with roughly equivalent levels of user
experience, and yet all of these suffer from different limitations, including
failing to satisfy modern usage scenarios. This PEP proposes a design for
a single Windows install workflow tool that satisfies all the needs of the
existing installers for the platform, while avoiding most of their limitations,
and provides the core team with the ability to manage releases for many years
to come.</p>
<p>With the new installer, the recommended command to launch the default Python on
Windows will be <code class="docutils literal notranslate"><span class="pre">python</span></code>, while the command for managing multiple versions
(including launching a specific one) will be <code class="docutils literal notranslate"><span class="pre">py</span></code>. Users can also opt-in to
having global <code class="docutils literal notranslate"><span class="pre">python3.x</span></code> commands by adding an extra entry to their <code class="docutils literal notranslate"><span class="pre">PATH</span></code>
environment variable. We recommend starting with the “How to teach this” section
for the most concise high-level overview of the features.</p>
<p>The existing <code class="docutils literal notranslate"><span class="pre">.exe</span></code> installer and <code class="docutils literal notranslate"><span class="pre">py</span></code> launcher will be deprecated and no
longer released from two years after this PEP is accepted. The existing
embeddable distro will no longer be listed as a download, but will be available
through the install manager. The Windows Store app will be immediately replaced
with the install manager.</p>
<section id="reader-s-note">
<h3><a class="toc-backref" href="#reader-s-note" role="doc-backlink">Reader’s Note</a></h3>
<p>This document is a detailed <em>proposal</em>, intended to assist in an “approve” or
“reject” decision on the replacement of the existing install formats for Python
on Windows with a new format. It is not intended to be a binding specification,
nor is it user documentation or an interoperability specification. The actual
implementation may vary over time as needs change, and that is not to be
considered a “violation” of this PEP. Any interfaces and protocols meant for
public use will be independently documented and maintained in accordance with
standard deprecation timelines.</p>
<p>Documentation on installing Python on Windows can be found at
<a class="reference external" href="https://docs.python.org/using/windows.html">docs.python.org/using/windows.html</a>.</p>
</section>
</section>
<section id="background">
<h2><a class="toc-backref" href="#background" role="doc-backlink">Background</a></h2>
<p>There are a large range of needs users may have that lead to them wanting
to install a Python runtime. Many, likely most, are interested in running
(perhaps writing) short scripts, such as those that perform a simple task,
or help teach someone a concept. Some users are looking for a specific version
to integrate with existing code or another application. Some are after a full
set of different interpreter versions to perform testing.</p>
<p>In this section, we discuss the expectations that users have of “installing
Python”, provide an overview of the existing installers for Windows, and
identify some of the gaps and challenges inherent in these offerings.</p>
<section id="expectations">
<h3><a class="toc-backref" href="#expectations" role="doc-backlink">Expectations</a></h3>
<p>Based on significant anecdotal experience and analysis of quantitative data
available (though not necessarily public), we make the following assertions
about the majority of Python users on Windows:</p>
<ul class="simple">
<li>most users just want the latest stable version</li>
<li>most users want a “one-click” (or fewer) install</li>
<li>most users do not want to use administrator privileges</li>
<li>most users will benefit from installing maintenance updates</li>
<li>most users expect the <code class="docutils literal notranslate"><span class="pre">python</span></code> command to work after installation</li>
</ul>
<p>The primary support for these assertions is that the most popular installers
actively chosen by users are the latest stable release on python.org, and
the latest stable release on the Windows Store, both of which meet these
requirements.</p>
<p>We make the following assumptions about other significant sets of users.
These may have some overlap between groups, and at least some users expect
all of them.</p>
<ul class="simple">
<li>some users want to install Python programmatically</li>
<li>some users want to install a particular version</li>
<li>some users want to install many versions</li>
<li>some users want to install for all users of their machine</li>
<li>some users do not want Start Menu shortcuts</li>
<li>some users want to install as part of their project’s build process</li>
<li>some users want to install as part of their project’s install process</li>
<li>some users intend to never update their install</li>
<li>some users expect the <code class="docutils literal notranslate"><span class="pre">py</span></code> command to work after installation</li>
</ul>
<p>These assumptions have all been demonstrated over time to exist, though the
relative importance has not been quantified. The <a class="reference external" href="https://docs.python.org/3/using/windows.html#windows-nuget" title="(in Python v3.14)"><span class="xref std std-ref">NuGet packages</span></a> and the <a class="reference external" href="https://docs.python.org/3/using/windows.html#windows-embeddable" title="(in Python v3.14)"><span class="xref std std-ref">embeddable distro</span></a> can meet most of these needs.</p>
</section>
<section id="traditional-installer">
<h3><a class="toc-backref" href="#traditional-installer" role="doc-backlink">Traditional Installer</a></h3>
<p>The traditional installer is an executable downloadable directly from
python.org that installs the entire development kit for Python. This includes
the CPython interpreter, the standard library, Python headers and import
libraries, builds of Tcl and Tk, the documentation as HTML files, the runtime
and standard library test suite, Start Menu shortcuts for Python and IDLE,
debugging symbols and debug builds of the binaries, the <code class="docutils literal notranslate"><span class="pre">py.exe</span></code> launcher
and its file associations, and functionality to modify the user’s <code class="docutils literal notranslate"><span class="pre">PATH</span></code>
environment variable, enable long-path support on their system, pre-generate
<code class="docutils literal notranslate"><span class="pre">.pyc</span></code> files for the standard library, and install pip.
As of 3.13, it also includes a set of experimental free-threaded binaries.
Many of these components are optional.</p>
<p>After downloading the executable, users are presented with a “quick install”
option, which installs into their user directory with most options enabled.
We believe that most users select this option.</p>
<p>A second option alongside the quick install takes the user to two pages worth
of options, listing the components that they need not install, as well as other
options such as the install directory and whether to install for all users.</p>
<p>All of these options may be specified on the command line, and there is also an
option to proceed with the install without displaying any UI.
Based on feedback and bug reports, all of these options are used by at least
some users. However, as we do not track install telemetry, we have no way to
know which options are more important than others.</p>
<p>Behind the scenes, the traditional installer is a Burn bundle, generated using
the Wix Toolset installer framework, containing one or more MSI files for each
feature. This framework is used extensively by Microsoft themselves, and
provides the most direct method of using Windows Installer. The bundle is a
custom C++ application, based on their template, which allows us to customise
the overall behaviour of the installer to determine precisely which MSI files
should actually be installed. The process of copying files, updating the
registry, and generating shortcuts is handled entirely by Windows Installer.</p>
<p>As well as the intended uses, it is understood that many users will (attempt to)
use the traditional installer for other scenarios, such as unregistered installs
and automated CI system installs. While better alternatives are available, they
are not as obvious, and the hope is that a future design would make these
scenarios easier.</p>
</section>
<section id="windows-store">
<h3><a class="toc-backref" href="#windows-store" role="doc-backlink">Windows Store</a></h3>
<p>The Windows Store packages for CPython are produced as part of our normal
release process using almost all identical binaries to the other packages.
Due to being in an app store package, the primary <code class="docutils literal notranslate"><span class="pre">python.exe</span></code> is enhanced
to be able to determine its location properly, and alternative <code class="docutils literal notranslate"><span class="pre">pip.exe</span></code> and
other shortcuts are included to make up for the lack of <code class="docutils literal notranslate"><span class="pre">PATH</span></code> environment
variable settings. These are implemented in <code class="file docutils literal notranslate"><span class="pre">PC\python_uwp.cpp</span></code> in our repo.</p>
<p>These packages are installed by searching for Python in the Microsoft Store
app, which will find results for each major version since 3.8. Users then have
to select a version and install it. These packages include the CPython
interpreter, standard library, Tcl/Tk, IDLE, and pip, and create file
associations, Start Menu shortcuts, and global commands for <code class="docutils literal notranslate"><span class="pre">python.exe</span></code>,
<code class="docutils literal notranslate"><span class="pre">python3.exe</span></code>, <code class="docutils literal notranslate"><span class="pre">python3.X.exe</span></code>, <code class="docutils literal notranslate"><span class="pre">pip[3[.X]].exe</span></code> and <code class="docutils literal notranslate"><span class="pre">idle[3[.X]].exe</span></code>.
No <code class="docutils literal notranslate"><span class="pre">PATH</span></code> modification is possible or required, though users may need to
manage their global shortcuts through the “Manage App Execution Alias” settings
page.</p>
<p>In addition, Microsoft has added to a clean Windows install a default
<code class="docutils literal notranslate"><span class="pre">python.exe</span></code> command. This captures attempts by users to launch Python on
a machine that has not yet installed it. When launched directly, the command
will open the Microsoft Store app to the page containing the recommended
Python app, typically the latest version. This app is entirely controlled by
Microsoft. Based on telemetry associated with the Python app (which <em>is</em>
controlled by the upstream Python project), approximately 300,000 installs
per month come through this redirector, making up about 90% of the total
installs of that version.</p>
<p>Behind the scenes, the Store package is based on Microsoft’s new installer
technology for apps known as APPX or MSIX. These are essentially plain ZIP
files with a small amount of metadata, except that installation is handled
by the operating system. They are always extracted to a fixed location,
accessible to all users but not modifiable by any, and automatically updated
to the latest release. The user’s own data is stored in an OS-managed location
in their user profile, and is able to be reset, backed-up and restored using
regular OS functionality.</p>
</section>
<section id="nuget-package">
<h3><a class="toc-backref" href="#nuget-package" role="doc-backlink">NuGet Package</a></h3>
<p>The NuGet packages for CPython are produced and published as part of our
normal release process. The contents are identical to the traditional
installer. A NuGet package is published to nuget.org, which is a package
manager typically associated with .NET languages, but highly integrated with
any project supported by Visual Studio. This makes it a nice format for users
who want a lightweight install of Python as part of their regular build process,
and can simplify embedding scenarios.</p>
<p>The packages are installed using any tool capable of using the NuGet API, or
may be downloaded directly once the URL of the package is known. The package is
a plain ZIP file with some metadata. It contains the CPython interpreter, the
standard library, development headers and import libraries, and pip. It does
not execute any code at install time, and users must locate the package
themselves in order to launch the <code class="docutils literal notranslate"><span class="pre">python.exe</span></code> contained within.</p>
</section>
<section id="embeddable-package">
<h3><a class="toc-backref" href="#embeddable-package" role="doc-backlink">Embeddable Package</a></h3>
<p>The embeddable package for CPython is produced and published as part of our
normal release process. It is published to python.org alongside the
traditional installer. The contents are identical, however, the layout is
changed to store all binaries at the top level, with the standard library
packed into a ZIP file. A <code class="docutils literal notranslate"><span class="pre">._pth</span></code> file is included to override <code class="docutils literal notranslate"><span class="pre">sys.path</span></code>
so that only the files that are part of the distro are used, and environment
variables or registry entries are ignored.</p>
<p>This package does not include pip, as the intention is for it to be embedded
into a broader application. Other libraries should be installed at build time,
since after distribution the runtime is meant to be an internal implementation
detail of the app it is a part of.</p>
<p>As well as its intended use, some users attempt to use this package as a
development kit rather than a runtime package. This is believed to be due to
those users preferring to avoid “heavyweight” installers, and believing that
this package is intended to be a “portable” install (extract and run), likely
because it is the only ZIP file option listed on the python.org download pages
(speaking to the importance of clarity and limiting options on those pages).
It is hoped that a future installer design will avoid or limit this confusion.</p>
</section>
<section id="alternate-distributions">
<h3><a class="toc-backref" href="#alternate-distributions" role="doc-backlink">Alternate Distributions</a></h3>
<p>While outside of our purview as the core team, alternate distributions of Python
for Windows often use a project, workflow or environment-centric model for
installation of the runtime. By this, we mean that the tool is installed first,
and is used to create a working space that includes a runtime, as well as other
dependencies. Examples of these tools include conda and uv.</p>
<p>Two observations are worth making about these tools. Firstly, they are often
praised for being low impact, in that they usually don’t install additional
entry points or files for the runtime, making the install fast and also isolated
to a single project. Secondly, their users often appreciate the ease of
selecting a particular version of a runtime, or alternatively, not having to
select at all because existing specifications (or constraints) can choose for
them.</p>
<p>These tools tend to meet many of the second set of expectations described above,
usually combining multiple tasks in a single command to reduce the cognitive
overhead of learning how to use and combine multiple commands.</p>
<p>It’s also worth pointing out that the core team does not view these alternate
distributions as competitors to any upstream distribution. They are a
fundamental part of how the open source ecosystem is intended to work. Our own
distributions are a convenience for those who choose to use them, as not all
scenarios are well served by a workflow tool or even a pre-built package.</p>
</section>
<section id="challenges">
<h3><a class="toc-backref" href="#challenges" role="doc-backlink">Challenges</a></h3>
<p>There are numerous challenges we face with the current set of installers,
which largely break down into two categories: mismatched or unachievable
user expectations, and general unreliability.</p>
<p>The traditional installer has the highest level of unreliability. The Windows
Installer technology is very old, and effectively no longer under development.
While its basic functionality is okay, interference may come from many sources,
such as virus scanners, other installers, system configuration, admin policies,
and even other files in the same directory as the installer. On top of this,
most of its advanced and beneficial functionality such as update patches,
incremental updates, and automatic rollback are unimportant for Python users.</p>
<p>Most user expectations are <em>defined</em> by the traditional installer, and so by
definition, it meets them. One primary gap is that it is not able to create an
“unmanaged” install - that is, the equivalent of only copying files onto the
user’s system without registration. If you have installed it once, and you
try to install it again, you will only even be able to manage (or upgrade) the
existing install. This can lead to installs moving on update, which will
break users.</p>
<p>Additionally, the <code class="docutils literal notranslate"><span class="pre">PATH</span></code> environment variable cannot be intelligently
modified - at best, we can prepend or append the install path. This usually
results in the most recent install of Python being the highest priority. For
example, if the user has Python 3.14 installed and then installs (or updates)
3.13, the <code class="docutils literal notranslate"><span class="pre">python</span></code> command will switch from the later version to the earlier
version.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">py.exe</span></code> launcher, defined in <a class="pep reference internal" href="../pep-0397/" title="PEP 397 – Python launcher for Windows">PEP 397</a> and implicitly updated by <a class="pep reference internal" href="../pep-0514/" title="PEP 514 – Python registration in the Windows registry">PEP 514</a>,
is an attempt to avoid this particular issue. It uses its own logic for finding
installed versions without relying on <code class="docutils literal notranslate"><span class="pre">PATH</span></code>. However, the PEP 514 logic does
not allow for prerelease or experimental builds to be treated specially, and so
<code class="docutils literal notranslate"><span class="pre">py.exe</span></code> often prefers these builds by default over the non-experimental
version expected by the user.</p>
<p>The Windows Store package is very reliable, with the exception of the global
shortcuts. Rather than modifying <code class="docutils literal notranslate"><span class="pre">PATH</span></code> to add its own directory, these
shortcuts are created in a single OS managed directory that has all the
shortcuts defined by any app. Users are able to modify their <code class="docutils literal notranslate"><span class="pre">PATH</span></code> to exclude
or de-prioritise this directory, leading to unreliable or inconsistent
behaviour, and historically we have also seen this caused by installers.
For example, installing Python from the Store followed by Python from the
traditional installer with its <code class="docutils literal notranslate"><span class="pre">PATH</span></code> modification enabled will almost always
shadow the Store package’s Python with the later install.</p>
<p>User expectations that are un-met by the Store package tend to be performance
and technical. Due to the overhead of launching an app, Python starts up slower.
Because apps are designed to be isolated from each other, it is more difficult
to use hidden directories (such as <code class="docutils literal notranslate"><span class="pre">AppData</span></code> or <code class="docutils literal notranslate"><span class="pre">TEMP</span></code>) to communicate
between different versions of Python, as each version has its own space. Apps
are subject to stricter security requirements that legacy applications usually
have disabled, such as DLL hijacking protection, which causes some libraries to fail.
The <code class="docutils literal notranslate"><span class="pre">python3</span></code> and <code class="docutils literal notranslate"><span class="pre">python</span></code> shortcuts are managed through system settings,
and the user interface is not very good (and not going to be improved, according
to Microsoft). Without managing these, it is relatively easy for an undesired
version to be launched, though in general the targets can only be changed
manually by the user, and not by merely installing another app.</p>
<p>Both the NuGet package and the embeddable distro are as simple and reliable to
install as extracting an archive file, though it’s worth noting that for many
Python users this is not a common task. They provide no install management at
all, and cannot be reliably updated other than by deleting and re-extracting.
User expectations that are un-met are almost always due to users selecting the
wrong installer. Both these packages are for specialised cases, and while they
are documented as such, the attraction of a plain ZIP file leads some users into
failure.</p>
</section>
</section>
<section id="overview-of-pymanager">
<h2><a class="toc-backref" href="#overview-of-pymanager" role="doc-backlink">Overview of PyManager</a></h2>
<p>PyManager is the internal name of our proposed replacement installer tool. It
will be distributed both in the Windows Store and on python.org as an MSIX
package. Downloading from either source will get an identical package, and
both will support automatic updates (through the Store) for new releases.</p>
<p>The user visible name will be “Python Install Manager”, published by the
Python Software Foundation. After publishing, we will request that Microsoft
adjust their <code class="docutils literal notranslate"><span class="pre">python.exe</span></code> stub to open to this new app.</p>
<p>This app does not directly provide a version of Python, but it does provide the
global commands that users expect to work, as well as file associations and
Start menu shortcuts. The OS will prompt users to launch the app after install,
which will trigger an automatic install of the current release of CPython and
then launch it. From the user’s perspective, they have the same initial
experience as today, with one added progress bar on first launch.</p>
<p>The global commands provided by the app must be static and bundled into the app
itself. They can only change their behaviour at runtime, and cannot be
redirected to different executables except by the user (and then only to another
installed app). So the commands to be provided by PyManager are <code class="docutils literal notranslate"><span class="pre">python.exe</span></code>,
<code class="docutils literal notranslate"><span class="pre">python3.exe</span></code>, <code class="docutils literal notranslate"><span class="pre">py.exe</span></code>, <code class="docutils literal notranslate"><span class="pre">pymanager.exe</span></code>. Each of these must have the
ability to inspect the user’s system and choose the correct runtime to launch.
Additionally, <code class="docutils literal notranslate"><span class="pre">py</span></code> and <code class="docutils literal notranslate"><span class="pre">pymanager</span></code> will have management subcommands to allow
adding and removing runtimes.</p>
<p>In line with <a class="pep reference internal" href="../pep-0394/" title="PEP 394 – The “python” Command on Unix-Like Systems">PEP 394</a> and the default behaviour of Windows, the recommended
command for launching Python is <code class="docutils literal notranslate"><span class="pre">python.exe</span></code>. As provided by PyManager, this
will locate an existing install, either among those that PyManager manages or
using <a class="pep reference internal" href="../pep-0514/" title="PEP 514 – Python registration in the Windows registry">PEP 514</a>, or it will install the latest available version of CPython and
select that. The <code class="docutils literal notranslate"><span class="pre">python3.exe</span></code> command behaves similarly, but is only allowed
to find 3.x installs from python.org.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">py.exe</span></code> command provided by PyManager will be recommended for most
management use, due to its brevity. <code class="docutils literal notranslate"><span class="pre">py</span> <span class="pre">install</span> <span class="pre">...</span></code>, <code class="docutils literal notranslate"><span class="pre">py</span> <span class="pre">list</span> <span class="pre">...</span></code> and so
on. The proposed commands are detailed later. The existing behaviour of the
<a class="pep reference internal" href="../pep-0397/" title="PEP 397 – Python launcher for Windows">PEP 397</a> launcher is preserved, however, launching through <code class="docutils literal notranslate"><span class="pre">py</span></code> will not
automatically install runtimes (by default). If one is requested but is not
installed, users will just get an error. The <code class="docutils literal notranslate"><span class="pre">py</span> <span class="pre">exec</span> <span class="pre">...</span></code> subcommand,
however, will install automatically, and supports the same options as bare
<code class="docutils literal notranslate"><span class="pre">py</span></code>.</p>
<p>These commands are added at very low priority in the user’s <code class="docutils literal notranslate"><span class="pre">PATH</span></code> by the OS.
Every existing configuration we may have created on a user’s machine will take
precedence over these commands, and so these are a last resort in place of an
error message. As a result, we can generally assume that a user is launching
these commands because they haven’t configured a stronger preference (for
example, a user who has activated an environment will never launch our
<code class="docutils literal notranslate"><span class="pre">python.exe</span></code>, because activation will put a different one ahead of it, and a
user who wants precisely the behaviour of the existing <code class="docutils literal notranslate"><span class="pre">py.exe</span></code> can just
install it and will never launch our new one).</p>
<p>The <code class="docutils literal notranslate"><span class="pre">pymanager.exe</span></code> command is to allow for handling ambiguous situations.
Existing installs of Python and the launcher may shadow <code class="docutils literal notranslate"><span class="pre">python.exe</span></code> and
<code class="docutils literal notranslate"><span class="pre">py.exe</span></code>, but in an automated environment, this can make administrative
scripts unreliable, and so the <code class="docutils literal notranslate"><span class="pre">pymanager</span></code> command is unlikely to refer to
something other than PyManager. It has all the subcommands, and launching it
with no command specified will print help for the user.</p>
<section id="replacing-other-installers">
<h3><a class="toc-backref" href="#replacing-other-installers" role="doc-backlink">Replacing other installers</a></h3>
<p>Our intent is to immediately stop publishing individual versions to the Windows
Store, and to deprecate and phase out the traditional installer by Python 3.16.
The embeddable distro will remain, but its listing on python.org download pages
will be phased out and it will be available only through PyManager. No changes
will be made to the NuGet packages.</p>
<p>PyManager will be made available as an app package downloadable manually from
python.org, and the double-click install experience is generally smooth. This
provides an equivalent to the current approach of downloading from our site.
It will bundle a recent (unspecified) version of CPython so that the download
can be moved to a non-internet connected machine and still provide a Python
runtime after install.</p>
<p>Some automated deployment scenarios do not work with the newer MSIX format, and
so a simple MSI will also be provided on python.org. This will have no options
or user interface, and require administrative privileges, which are typically
available for these kinds of scenarios. Additionally, the MSI will be required
by users on non-standard systems, such as Wine, that do not support the MSIX
format. While not officially supported, the MSI will enable these platforms to
continue using upstream distributions of CPython. The MSI would be discouraged
for most other users, and the MSIX is considered the default.</p>
<p>It’s worth noting that there is no way to make the MSI install fully compatible
with the MSIX, and users with both will likely encounter confusion or problems.
It is anticipated that only users without Store app support will use the MSI.</p>
<p>Our release processes will start publishing plain ZIP packages to python.org.
These will be available from the FTP pages, but will not be listed directly on
regular download pages.</p>
<p>Third-party tools that currently distribute their own builds of CPython will be
welcome to use ours, though will be expected to be the initial point of contact
for their users requiring support.</p>
</section>
<section id="project-ownership-and-development">
<h3><a class="toc-backref" href="#project-ownership-and-development" role="doc-backlink">Project ownership and development</a></h3>
<p>PyManager will be developed and maintained in its own repository adjacent to
the CPython repository, and under the same terms. The CPython CLA will apply,
and all (and only) core developers will have commit rights.</p>
<p>PyManager releases are independent from CPython releases. There is no need for
versions to match, or releases to be simultaneous. Unless otherwise arranged,
the PyManager release manager is whoever is the build manager for Windows.</p>
</section>
</section>
<section id="specification">
<h2><a class="toc-backref" href="#specification" role="doc-backlink">Specification</a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In this document, all command line options will be shown with one or two
hyphens. In implementation, all options will support one or two hyphens or a
forward slash, to be permissive of both Windows and UNIX conventions.</p>
</div>
<section id="exec-subcommand">
<h3><a class="toc-backref" href="#exec-subcommand" role="doc-backlink">Exec subcommand</a></h3>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>py [-V:&lt;TAG&gt;] [interpreter opts] [script.py|-m module|-c code] [script args]
py [-3.*] [interpreter opts] [script.py|-m module|-c code] [script args]
python ...
python3 ...
pymanager exec -V:tag ...
pymanager exec -3.* ...
</pre></div>
</div>
<p>This subcommand is used to select and launch a runtime. It is the default action
for the <code class="docutils literal notranslate"><span class="pre">py</span></code> command, and the only action supported by the <code class="docutils literal notranslate"><span class="pre">python</span></code> and
<code class="docutils literal notranslate"><span class="pre">python3</span></code> commands. The default options are subtly different in each case for
consistency with existing use of these commands.</p>
<p>This subcommand is available on both <code class="docutils literal notranslate"><span class="pre">py</span></code> and <code class="docutils literal notranslate"><span class="pre">pymanager</span></code>. However, since
<code class="docutils literal notranslate"><span class="pre">py</span></code> offers it by default, we would not expect users to use it there. The
intent is that the <code class="docutils literal notranslate"><span class="pre">py</span></code>, <code class="docutils literal notranslate"><span class="pre">python</span></code> and <code class="docutils literal notranslate"><span class="pre">python3</span></code> commands are the default
ways to launch a runtime, and <code class="docutils literal notranslate"><span class="pre">pymanager</span> <span class="pre">exec</span></code> is for advanced scenarios.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">-V:tag</span></code> command is used to request a specific runtime from the command
line. The tag is a <code class="docutils literal notranslate"><span class="pre">Company\\Tag</span></code> pair, or just <code class="docutils literal notranslate"><span class="pre">Tag</span></code> if no slash is
included, and is used as defined by PEP 514. The <code class="docutils literal notranslate"><span class="pre">-3.*</span></code> option is interpreted
as <code class="docutils literal notranslate"><span class="pre">-V:PythonCore\\3.*</span></code>. This option is only available for <code class="docutils literal notranslate"><span class="pre">py</span></code> and
<code class="docutils literal notranslate"><span class="pre">py</span> <span class="pre">exec</span></code> variants.</p>
<p>If no tag is specified on the command line, and a script file is specified,
the script will be inspected for a shebang. If one is found that matches a
recognised pattern, it will either provide the tag to be used for search, or it
will override all other processing and its specified executable will be launched
without further effort being made. This is to handle the (unfortunate) legacy
support of arbitrary Windows-specific paths being allowed in what was meant to
be a portability feature. In general, shebangs including simple patterns like
<code class="docutils literal notranslate"><span class="pre">/usr/bin/python3.13</span></code> are intended, while those that use <code class="docutils literal notranslate"><span class="pre">/usr/bin/env</span>
<span class="pre">python</span></code> are unlikely to be of benefit since the environment tends to be less
reliable than our search.</p>
<p>If no tag is yet requested, the <code class="docutils literal notranslate"><span class="pre">VIRTUAL_ENV</span></code> environment variable will be
consulted to see if an environment has been activated. If so, that will become
the request.</p>
<p>If a tag has been requested at this stage, the <code class="docutils literal notranslate"><span class="pre">python3</span></code> command will verify
that it matches <code class="docutils literal notranslate"><span class="pre">PythonCore\\3.*</span></code> and exit with an error if not. This allows
allows the <code class="docutils literal notranslate"><span class="pre">python3</span></code> command to be used in an active environment consistent
with other platforms, but not if the environment would not have included the
command. This applies to most existing versions of Python on Windows. (The
alternative to this behaviour is to make <code class="docutils literal notranslate"><span class="pre">python3</span></code> always error when an
environment is active, as anything else would behave inconsistently for the
user.)</p>
<p>If no tag is requested, the default will be consulted. For <code class="docutils literal notranslate"><span class="pre">python3</span></code>, this is
<code class="docutils literal notranslate"><span class="pre">PythonCore\\3</span></code>, but for all other commands it is read from configuration
(which might involve an environment variable). If it’s still empty, any tag will
be allowed.</p>
<p>The best installed runtime matching the tag is then selected and launched with
the remaining command line.</p>
<p>If no matching runtime is found, the <code class="docutils literal notranslate"><span class="pre">py</span> <span class="pre">exec</span></code> and <code class="docutils literal notranslate"><span class="pre">pymanager</span> <span class="pre">exec</span></code> commands
will automatically install and launch one (user configuration permitting). The
<code class="docutils literal notranslate"><span class="pre">py</span></code>, <code class="docutils literal notranslate"><span class="pre">python</span></code> and <code class="docutils literal notranslate"><span class="pre">python3</span></code> commands will report and error and exit.
However, in the case where no runtimes are available at all, including none
detected from other installers, the first runtime will be automatically
installed. This provides a useful first-launch experience, where a new user who
has just installed PyManager will directly launch the latest (or requested)
version of CPython. After this first time, errors will again be reported when a
requested runtime is not found.</p>
</section>
<section id="install-subcommand">
<h3><a class="toc-backref" href="#install-subcommand" role="doc-backlink">Install subcommand</a></h3>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>py install [-s|--source &lt;URL&gt;] [-f|--force] [-u|--upgrade] tag [...]
py install [-s|--source &lt;URL&gt;] [-t|--target &lt;DIR&gt;] tag
py install [-s|--source &lt;URL&gt;] [-d|--download &lt;DIR&gt;] tag [...]
py install --refresh
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This and all later subcommands are also available under <code class="docutils literal notranslate"><span class="pre">pymanager</span></code>.
However, as we intend for <code class="docutils literal notranslate"><span class="pre">py</span></code> to be the usual command, we only show that
one.</p>
</div>
<p>This subcommand will install one or more runtimes onto the current machine.
The tags are <code class="docutils literal notranslate"><span class="pre">Company\\Tag</span></code> pairs (or just <code class="docutils literal notranslate"><span class="pre">Tag</span></code> if no slash is included),
and are used to search the index file. Company names match as case-insensitive
prefixes, preferring a full match over a prefix, and tags use case-insensitive,
number-aware matches, with dotted numbers treated as versions. Tags must match
one of the listed “install for” tags, and entries list multiple such tags to
handle abbreviated requests. The special tag <code class="docutils literal notranslate"><span class="pre">default</span></code> resolves to the user’s
configured default (typically <code class="docutils literal notranslate"><span class="pre">3</span></code>; see Configuration later for details on
configuring settings).</p>
<p>Tags may also be specified as a constraint, using <code class="docutils literal notranslate"><span class="pre">&gt;</span></code>, <code class="docutils literal notranslate"><span class="pre">&gt;=</span></code>, <code class="docutils literal notranslate"><span class="pre">&lt;</span></code>, <code class="docutils literal notranslate"><span class="pre">&lt;=</span></code>
or <code class="docutils literal notranslate"><span class="pre">!=</span></code> followed by the <code class="docutils literal notranslate"><span class="pre">Company\\Tag</span></code> or <code class="docutils literal notranslate"><span class="pre">Tag</span></code> value. When matching a
constraint only the primary tag metadata is used for comparisons. Since the
comparisons are version-aware, constraints such as <code class="docutils literal notranslate"><span class="pre">&gt;3.10</span></code> will select
3.11 as a minimum, while <code class="docutils literal notranslate"><span class="pre">&gt;3.10.0</span></code> may select 3.10.1.</p>
<p>The behaviour of constraints against arbitrary tags is likely to be unintuitive
in some circumstances. It is anticipated that constraints will mainly be used
with upstream releases, which typically use version-shaped tags, and primarily
for cases where other metadata such as <code class="docutils literal notranslate"><span class="pre">Requires-Python</span></code> are being handled.
Users are expected to use shorter tags for convenience, rather than ranges.</p>
<p>The default index file is hosted on python.org, and contains install information
including package URLs and hashes for all installable versions. An alternate
index may be specified by the user using a configuration file or the
<code class="docutils literal notranslate"><span class="pre">--source</span></code> command line option, or their administrator through a configuration
file. The requested tag is matched against the index file, and if an exact match
is found the package will be selected. In the case of no exact match, a prefix
match will be used. In both cases, numbers in the tag are treated logically -
that is, <code class="docutils literal notranslate"><span class="pre">3.1</span></code> is a prefix of <code class="docutils literal notranslate"><span class="pre">3.1.2</span></code> but not of <code class="docutils literal notranslate"><span class="pre">3.10</span></code>. See Index Schema
below for information on exactly how install tags are specified in the index
file.</p>
<p>If a tag is already satisfied by an existing install, nothing will be installed.
The user must pass an <code class="docutils literal notranslate"><span class="pre">--upgrade</span></code> or <code class="docutils literal notranslate"><span class="pre">--force</span></code> option to replace the
existing install; the former will only replace it with a newer version, while
the latter will remove and replace even with the same version.</p>
<p>Calling the command without providing any tags will not install anything, but
will display the help text and an error (as for any invalid option). However,
passing <code class="docutils literal notranslate"><span class="pre">--upgrade</span></code> with no tags will attempt to upgrade all installs.</p>
<p>Passing <code class="docutils literal notranslate"><span class="pre">--refresh</span></code> will regenerate all metadata and shortcuts for all
installs. This is intentionally applied to all installs at once, as shortcut
prioritisation relies on all installs being consistent (for example, the latest
3.x version should get the <code class="docutils literal notranslate"><span class="pre">python3.exe</span></code> shortcut, which gets complicated if
users can choose to only refresh an older install).</p>
<p>If a <code class="docutils literal notranslate"><span class="pre">--target</span> <span class="pre">&lt;DIR&gt;</span></code> option is passed with only a single tag, that runtime
will be extracted to the specified directory without being registered as an
install (or generating aliases or shortcuts). This is intended to cover
embedding cases, or downloading the files for incompatible platforms. Passing
multiple tags with <code class="docutils literal notranslate"><span class="pre">--target</span></code> is an error.</p>
<p>If the <code class="docutils literal notranslate"><span class="pre">--download</span> <span class="pre">&lt;DIR&gt;</span></code> option is passed, runtime packages are downloaded
but not installed. They are stored in the specified directory as their source
packages, and an <code class="docutils literal notranslate"><span class="pre">index.json</span></code> is created that references these files. This
index can be used later to perform offline installs with <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">install</span>
<span class="pre">--source</span> <span class="pre">&lt;index.json&gt;</span> <span class="pre">[tag</span> <span class="pre">...]</span></code>.</p>
</section>
<section id="uninstall-subcommand">
<h3><a class="toc-backref" href="#uninstall-subcommand" role="doc-backlink">Uninstall subcommand</a></h3>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>py uninstall [-y|--yes] [--purge] [tag ...]
</pre></div>
</div>
<p>This subcommand will uninstall one or more runtimes on the current machine. Tags
are exactly as for the install command, including prefix matching, but only
inspect existing installs. Unless the <code class="docutils literal notranslate"><span class="pre">--yes</span></code> option is passed, the user will
be prompted before uninstalling each runtime.</p>
<p>If the <code class="docutils literal notranslate"><span class="pre">--purge</span></code> option is passed with no tags, then (after confirmation) all
runtimes will be removed, along with shortcuts and any cached files. Passing any
tags with <code class="docutils literal notranslate"><span class="pre">--purge</span></code> will produce an error.</p>
<p>Uninstalling PyManager does not uninstall any runtimes that were installed. For
technical reasons, this would not be reliably possible (we cannot run arbitrary
code at uninstall time), and so instead we deliberately ensure that anything
that has been installed will continue to work. Reinstalling PyManager allows
management of these installs to resume. Running <code class="docutils literal notranslate"><span class="pre">py</span> <span class="pre">uninstall</span> <span class="pre">--purge</span></code> before
uninstalling PyManager will perform a complete uninstall.</p>
</section>
<section id="list-subcommand">
<h3><a class="toc-backref" href="#list-subcommand" role="doc-backlink">List subcommand</a></h3>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>py list [-f|--format &lt;FMT&gt;] [-1|--one] [--only-managed] [tag ...]
py list [-f|--format &lt;FMT&gt;] [-1|--one] [--online] [--source &lt;URL&gt;] [tag ...]
py [--list|--list-paths|-0|-0p]
</pre></div>
</div>
<p>This subcommand will list any or all installs matching the specified tags or
ranges. If no tags are provided, lists all installs. Runtimes not managed by
PyManager (including an active virtual environment) may be listed separately.</p>
<p>The default format is user-friendly. Other formats will include machine-readable
and single string formats (e.g. <code class="docutils literal notranslate"><span class="pre">--format=prefix</span></code> simply prints <code class="docutils literal notranslate"><span class="pre">sys.prefix</span></code>
on a line by itself). The exact list of formats is left to the implementation.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">--one</span></code> is provided, only the best result is listed. This is to assist
shell scripts that want to locate the default (or a suitable) runtime without
launching it. (Note that “best” is loosely defined, but will always be the
user’s preferred default environment if it is included in the results.)</p>
<p>The <code class="docutils literal notranslate"><span class="pre">--only-managed</span></code> option omits runtimes that were discovered but are not
managed by PyManager, for example, those found using a regular PEP 514 lookup.</p>
<p>Passing <code class="docutils literal notranslate"><span class="pre">--source</span></code> (or <code class="docutils literal notranslate"><span class="pre">--online</span></code> to implicitly pass the default source)
will search an online index rather than currently installed runtimes. The option
is here rather than on the <code class="docutils literal notranslate"><span class="pre">install</span></code> subcommand because the filtering and
formatting options are already available on <code class="docutils literal notranslate"><span class="pre">list</span></code>.</p>
<p>The legacy <code class="docutils literal notranslate"><span class="pre">--list</span></code>, <code class="docutils literal notranslate"><span class="pre">--list-paths</span></code>, <code class="docutils literal notranslate"><span class="pre">-0</span></code> and <code class="docutils literal notranslate"><span class="pre">-0p</span></code> arguments from the
<code class="docutils literal notranslate"><span class="pre">py.exe</span></code> launcher will also be provided. However, they will not support the
new options listed here, and are limited to reproducing the output from the
existing launcher. Unmanaged installs are not distinguishable in this listing.</p>
</section>
<section id="help-subcommand">
<h3><a class="toc-backref" href="#help-subcommand" role="doc-backlink">Help subcommand</a></h3>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>py help &lt;COMMAND&gt;
</pre></div>
</div>
<p>This subcommand will display the help text for each specified command, or if
none specified, will show the list of commands. Specifying one command is the
equivalent of <code class="docutils literal notranslate"><span class="pre">py</span> <span class="pre">&lt;COMMAND&gt;</span> <span class="pre">--help</span></code>. Showing the list of subcommands is the
default action for the <code class="docutils literal notranslate"><span class="pre">pymanager</span></code> command.</p>
<p>The command is added primarily to offer a simple way to tell users how to find
more information: they can be told to run <code class="docutils literal notranslate"><span class="pre">py</span> <span class="pre">help</span></code>. This avoids having to
override or extend the <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">-?</span></code> output, which otherwise forwards to the
selected runtime and already prints at least one screen’s worth of text.</p>
<p>After an automatic install (e.g. running <code class="docutils literal notranslate"><span class="pre">python</span></code> with nothing installed), a
message will be displayed telling users that they can run <code class="docutils literal notranslate"><span class="pre">py</span> <span class="pre">help</span></code> for more
information on how to manage their installs.</p>
</section>
<section id="environment-variables">
<h3><a class="toc-backref" href="#environment-variables" role="doc-backlink">Environment Variables</a></h3>
<p>No environment variables can be updated automatically when installing a Store
app, and so no updates will be done automatically. The core commands should
already be available on a correctly functioning machine.</p>
<p>One directory within the user’s PyManager data directory is set aside for
generated aliases. If desired, the user can add this directory to their <code class="docutils literal notranslate"><span class="pre">PATH</span></code>
themselves. The contents of this directory will be managed by PyManager, and
will contain executables to directly launch installed runtimes (for example,
<code class="docutils literal notranslate"><span class="pre">python3.exe</span></code> and <code class="docutils literal notranslate"><span class="pre">python3.13.exe</span></code> for an install of Python 3.13). Whenever
aliases are added to this directory, <code class="docutils literal notranslate"><span class="pre">PATH</span></code> will be checked and if it is
missing, the user will be presented a message containing the path to add.</p>
<p>Scripts installed by packages installed into a runtime will be in yet another
directory. Due to the current design, we do not believe it is safe to have them
all install into a single directory, or a directory shared by multiple runtimes.
However, a future development may include a command for PyManager to generate
its own entry points based on metadata in installed packages.</p>
</section>
<section id="start-menu-shortcuts">
<h3><a class="toc-backref" href="#start-menu-shortcuts" role="doc-backlink">Start Menu Shortcuts</a></h3>
<p>A Start Menu shortcut will be added to launch PyManager documentation in the
user’s default web browser. No applications are added to the Start Menu.</p>
<p>When installing Python runtimes, the install definition may specify Start Menu
shortcuts to create for the install.</p>
</section>
<section id="file-associations">
<h3><a class="toc-backref" href="#file-associations" role="doc-backlink">File Associations</a></h3>
<p>Standard file associations will be created when installing PyManager, and will
launch scripts and packaged apps with PyManager’s global <code class="docutils literal notranslate"><span class="pre">python.exe</span></code> alias.
This provides sensible behaviour for users who are double-clicking on scripts or
<code class="docutils literal notranslate"><span class="pre">.pyz</span></code> files.</p>
</section>
<section id="windowed-executables">
<h3><a class="toc-backref" href="#windowed-executables" role="doc-backlink">Windowed Executables</a></h3>
<p>For each of the global aliases described earlier, a <code class="docutils literal notranslate"><span class="pre">*w.exe</span></code> also exists.
These launch without creating or attaching a console window, which typically
means they will only display UI created by the script. For example, IDLE always
launches using <code class="docutils literal notranslate"><span class="pre">pythonw.exe</span></code>, as this avoids an unnecessary native console.</p>
<p>These commands otherwise behave identically to their console counterparts.</p>
</section>
<section id="configuration">
<h3><a class="toc-backref" href="#configuration" role="doc-backlink">Configuration</a></h3>
<p>PyManager is configured using a hierarchy of JSON-based configuration files.
Command-line options always override configuration file options. Configuration
files in user editable locations may be disabled by a configuration or
command-line option.</p>
<p>In ascending order of priority, these will be located:</p>
<ul class="simple">
<li>within the app package</li>
<li>specified by admin-only configuration (see below)</li>
<li>in the <code class="docutils literal notranslate"><span class="pre">base_config</span></code> setting (default: none)</li>
<li>in the <code class="docutils literal notranslate"><span class="pre">user_config</span></code> setting (default: <code class="docutils literal notranslate"><span class="pre">%AppData%\\Python\\PyManager.json</span></code>)</li>
<li>in the <code class="docutils literal notranslate"><span class="pre">additional_config</span></code> setting (default: <code class="docutils literal notranslate"><span class="pre">%PYTHON_MANAGER_CONFIG%</span></code>)</li>
<li>specified with the <code class="docutils literal notranslate"><span class="pre">-c</span></code> command line option</li>
</ul>
<p>The specific behaviour of each configuration option is left to implementation.
However, a number of intended options are discussed in other sections.</p>
<p>App package configuration is provided to allow PyManager to be embedded in other
applications or packages. For example, an alternative distribution may want to
include PyManager but have it locate installs from their own index. The app
package configuration allows reusing our build and overriding the default
settings.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">user_config</span></code> and <code class="docutils literal notranslate"><span class="pre">additional_config</span></code> settings are pre-configured in
earlier configuration files, allowing them to be overridden by admin-only
configuration or an alternate root configuration. If a configuration file
overwrites the setting that caused the file to be loaded, it is ignored.
The <code class="docutils literal notranslate"><span class="pre">base_config</span></code> setting is similar, but starts empty and is intended for
easy overriding through admin configuration.</p>
<p>Admin-only configuration is provided to allow administrators to manage systems
under their control using existing tools, such as group policy or registry
updates. By design, these controls cannot be overridden, such that it is
possible for administrators to deploy policy that prevents or limits the use of
PyManager. These controls are essential to allow PyManager to be deployed safely
into certain environments, and without them, it would simply be disallowed and
those users would have no access to Python.</p>
<p>The intent is for the main admin-only configuration to be a path to a new
<code class="docutils literal notranslate"><span class="pre">base_config</span></code> configuration file that an administrator can deploy to any
controlled location. This allows a network administrator to control the source
of their users’ default Python runtimes, without forcibly restricting them, or
to override the other sources for configuration files (apart from the command
line option).</p>
</section>
<section id="index-schema">
<h3><a class="toc-backref" href="#index-schema" role="doc-backlink">Index Schema</a></h3>
<p>The index file is made available either online or locally, and provides
PyManager with all the information needed to find, select, install, and manage
any Python runtime.</p>
<p>The index is stored as JSON. The main top level key is <code class="docutils literal notranslate"><span class="pre">versions</span></code>, which
contains a list of objects. Each version object has its own schema version, and
there is no overall file schema version. Future changes may add additional
top-level keys to provide functionality that cannot be safely integrated into
an existing one.</p>
<p>Version objects may be split between the index file and a <code class="docutils literal notranslate"><span class="pre">__install__.json</span></code>
stored in the root of each package archive. The entries in the bundled file will
fill in any gaps from the index file. This is intended to allow the typically
large <code class="docutils literal notranslate"><span class="pre">shortcuts</span></code> key to be removed from the index file, but may also extend
to <code class="docutils literal notranslate"><span class="pre">alias</span></code>, <code class="docutils literal notranslate"><span class="pre">executable</span></code> and <code class="docutils literal notranslate"><span class="pre">executable_args</span></code>. Omitting other keys from
the index may result in problems installing the package. Ensuring correct
behaviour is left to the implementation - this is not an interoperability point,
and so we do not intend to specify the details here (beyond the normal compatibility
requirements that apply).</p>
<p>A second top-level key <code class="docutils literal notranslate"><span class="pre">next</span></code> contains an optional URL to another index. This
may be used if PyManager cannot find a suitable package in the included
versions. The intent is to allow for older indexes to be archived and only
accessed when required, reducing the size of the initial download without
cutting off users from older versions. When searching for a suitable install,
later indexes will not be searched if a viable candidate is found (in other
words, the first index consulted should have the latest versions in it).</p>
<p>The initial schema is shown below:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">SCHEMA</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;versions&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="c1"># Should be 1.</span>
            <span class="s2">&quot;schema&quot;</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>

            <span class="c1"># Unique ID used for install detection/side-by-side.</span>
            <span class="c1"># Must be valid as a filename.</span>
            <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>

            <span class="c1"># Name to display in the UI</span>
            <span class="s2">&quot;display-name&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>

            <span class="c1"># Version used to sort packages. Also determines prerelease status.</span>
            <span class="c1"># Should follow Python&#39;s format, but is only compared among releases</span>
            <span class="c1"># with the same Company.</span>
            <span class="s2">&quot;sort-version&quot;</span><span class="p">:</span> <span class="n">Version</span><span class="p">,</span>

            <span class="c1"># Specifies platforms to consider this package for.</span>
            <span class="c1"># Initially, &#39;win32&#39; is the only supported value. Others may be</span>
            <span class="c1"># defined in the future. This condition is evaluated silently, and</span>
            <span class="c1"># is not intended to replace platform requests in &quot;install-for&quot;.</span>
            <span class="s2">&quot;platform&quot;</span><span class="p">:</span> <span class="p">[</span><span class="nb">str</span><span class="p">],</span>

            <span class="c1"># Company field, used for filtering and displayed as the publisher.</span>
            <span class="s2">&quot;company&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>

            <span class="c1"># Default tag, mainly for UI purposes.</span>
            <span class="c1"># It should also be specified in &#39;install-for&#39; and &#39;run-for&#39;.</span>
            <span class="s2">&quot;tag&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>

            <span class="c1"># List of tags to install this package for. This does not have to be</span>
            <span class="c1"># unique across all installs; the first match will be selected.</span>
            <span class="c1"># For example, the 3.10.5 package may list &#39;3&#39;, &#39;3.10&#39; and</span>
            <span class="c1"># &#39;3.10.5&#39; so that any of those may be specified to install it.</span>
            <span class="c1"># Matches are number aware, so that 3.1 is not a prefix of 3.10.</span>
            <span class="s2">&quot;install-for&quot;</span><span class="p">:</span> <span class="p">[</span><span class="nb">str</span><span class="p">],</span>

            <span class="c1"># List of tags to run this package for. Does not have to be unique</span>
            <span class="c1"># across all installs; the first match will be selected. The target</span>
            <span class="c1"># is the executable path relative to the root of the archive.</span>
            <span class="c1"># Explicit args (optional) are inserted before user args.</span>
            <span class="s2">&quot;run-for&quot;</span><span class="p">:</span> <span class="p">[{</span><span class="s2">&quot;tag&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="s2">&quot;target&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="s2">&quot;args&quot;</span><span class="p">:</span> <span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="s2">&quot;windowed&quot;</span><span class="p">:</span> <span class="nb">int</span><span class="p">},</span> <span class="o">...</span><span class="p">],</span>

            <span class="c1"># List of global CLI aliases to create for this package. Does not</span>
            <span class="c1"># have to be unique across all installs; the first match will be</span>
            <span class="c1"># created.</span>
            <span class="s2">&quot;alias&quot;</span><span class="p">:</span> <span class="p">[{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="s2">&quot;target&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="s2">&quot;windowed&quot;</span><span class="p">:</span> <span class="nb">int</span><span class="p">},</span> <span class="o">...</span><span class="p">],</span>

            <span class="c1"># List of shortcuts to create for this package. Additional keys on</span>
            <span class="c1"># each instance are allowed based on the value of &#39;kind&#39;.</span>
            <span class="c1"># Initially, &#39;kind&#39; supports the following values:</span>
            <span class="c1"># * &#39;pep514&#39; - other keys define registry values to set</span>
            <span class="c1"># * &#39;start&#39; - generate shortcuts in the user&#39;s Start Menu</span>
            <span class="c1"># * &#39;uninstall&#39; - generate an Add/Remove Programs entry</span>
            <span class="s2">&quot;shortcuts&quot;</span><span class="p">:</span> <span class="p">[{</span><span class="s2">&quot;kind&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">...</span><span class="p">},</span> <span class="o">...</span><span class="p">]</span>

            <span class="c1"># Default executable path, relative to the root of the archive.</span>
            <span class="c1"># Usually the values from &#39;run-for&#39; will be used instead, and this</span>
            <span class="c1"># is mainly for display purposes.</span>
            <span class="s2">&quot;executable&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
            <span class="c1"># Default executable args</span>
            <span class="s2">&quot;executable_args&quot;</span><span class="p">:</span> <span class="p">[</span><span class="nb">str</span><span class="p">],</span>

            <span class="c1"># URL to download the package archive from</span>
            <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>

            <span class="c1"># Optional set of hashes to validate the download. Hashes are stored</span>
            <span class="c1"># as hex digests. Any hash supported by hashlib without OpenSSL is</span>
            <span class="c1"># permitted.</span>
            <span class="s2">&quot;hash&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;&lt;hash_name&gt;&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">],</span>

    <span class="c1"># URL (or relative path) to the next index file</span>
    <span class="s2">&quot;next&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="shebang-processing">
<h3><a class="toc-backref" href="#shebang-processing" role="doc-backlink">Shebang Processing</a></h3>
<p>For limited compatibility with scripts designed for sh-like shells, PyManager
will check scripts for a shebang line. A shebang line specifying a Python
command will be used (when not overridden on the command line) to select a
suitable runtime for the script.</p>
<p>Unlike the support currently in the <code class="docutils literal notranslate"><span class="pre">py.exe</span></code> launcher, we propose to reduce
this functionality to only support Python commands where the command matches
a global alias listed for an install, with anything not matching being treated
as an arbitrary executable path. In practice, this is expected to produce the
same (or better) results for non-contrived cases, but may result in subtle
changes where users are relying on unspecified edge case behaviours of the
existing launcher.</p>
<p>The specific patterns to be detected are left to the implementation, but should
be largely compatible with the existing launcher.</p>
</section>
</section>
<section id="rationale">
<h2><a class="toc-backref" href="#rationale" role="doc-backlink">Rationale</a></h2>
<section id="changing-the-python-exe-command">
<h3><a class="toc-backref" href="#changing-the-python-exe-command" role="doc-backlink">“Changing” the python.exe command</a></h3>
<p>It may be argued that the global <code class="docutils literal notranslate"><span class="pre">python.exe</span></code> alias provided by PyManager is
“not real Python” and so should use a different name. While this is strictly
true, there are three reasons we argue that it should be used.</p>
<p>Firstly, thousands of users <em>daily</em> install through the Store page after being
led there by having typed <code class="docutils literal notranslate"><span class="pre">python</span></code> at the terminal of a clean machine. Due to
how this redirection is implemented, if the app they install does not provide a
<code class="docutils literal notranslate"><span class="pre">python</span></code> command, then the redirection will remain in place. In order to
ensure that users do not get stuck always going back to the Store, we need to
provide this command. (The same applies to <code class="docutils literal notranslate"><span class="pre">python3</span></code>.)</p>
<p>Second, the alternative to the “not real” alias is not “the real” one. It’s
nothing. We don’t have the ability to replace the global static alias with one
that follows the user’s preference or installs, and so the alternative would be
to provide nothing and have <code class="docutils literal notranslate"><span class="pre">python</span></code> be an error in all cases. This is worse,
and in our opinion, actively harmful to Python’s reputation.</p>
<p>Third, although the underlying implementation of the <code class="docutils literal notranslate"><span class="pre">python</span></code> alias is more
complex than the default <code class="docutils literal notranslate"><span class="pre">Programs/python.c</span></code>, the experience of using it is
identical. The alias is only launched in the absence of another expressed
preference (that is, there’s nothing else on <code class="docutils literal notranslate"><span class="pre">PATH</span></code>), it respects any
indirect preferences (such as through configuration or shebangs), and it
launches the most appropriate version of Python available on the user’s machine.
This is much closer to the desired behaviour of the global <code class="docutils literal notranslate"><span class="pre">python</span></code> command
than any alternative.</p>
<p>It has been noted that Gentoo also distributes an intelligent <code class="docutils literal notranslate"><span class="pre">python</span></code>
command, in order to serve their users better than a simple symlink.</p>
</section>
<section id="replacing-py-exe">
<h3><a class="toc-backref" href="#replacing-py-exe" role="doc-backlink">Replacing py.exe</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">py.exe</span></code> launcher exists to provide some of the functionality that will be
replicated by PyManager - specifically, the ability to launch an already
installed runtime. Despite its long history, the launcher does not seem to have
become the preferred method for most users, with many preferring the global
modifications to the <code class="docutils literal notranslate"><span class="pre">PATH</span></code> environment variable. However, the command itself
has come to be relied upon, and should be preserved as long as possible. This is
achieved in two ways.</p>
<p>Firstly, we install our own <code class="docutils literal notranslate"><span class="pre">py.exe</span></code> alias with PyManager that provides the
same functionality, along with PyManager specific functionality. This is
intended to become the default/preferred install of <code class="docutils literal notranslate"><span class="pre">py.exe</span></code> over time.</p>
<p>Second, we generate PEP 514 metadata (when requested) for each install, which
allows a legacy <code class="docutils literal notranslate"><span class="pre">py.exe</span></code> to continue to work normally with installs managed by
PyManager.</p>
<p>Due to how the existing <code class="docutils literal notranslate"><span class="pre">py.exe</span></code> launcher configures itself, and how the MSIX
package for PyManager is constrained, it is not possible for PyManager’s <code class="docutils literal notranslate"><span class="pre">py</span></code>
alias to override the launcher. As a result, users who install the launcher will
always find <code class="docutils literal notranslate"><span class="pre">py</span></code> resolving to the launcher. Ultimately, the only way to
resolve this in favour of PyManager is to uninstall the launcher, which can be
done through the standard Installed Apps control panel.</p>
<p>We propose to update the existing launcher, which will continue to be released
with the traditional installer, to detect attempted use of the new subcommands
and provide a useful message for the user rather than the current error. These
warnings can also detect the unlikely case where a user is intentionally
launching extensionless files by those names and retain that behaviour, allowing
a viable alternative for users who cannot make other changes to their setup.</p>
</section>
<section id="interaction-with-venv">
<h3><a class="toc-backref" href="#interaction-with-venv" role="doc-backlink">Interaction with venv</a></h3>
<p>An activated virtual environment, as implemented by the standard library
<a class="reference external" href="https://docs.python.org/3/library/venv.html#module-venv" title="(in Python v3.14)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">venv</span></code></a> module, will modify the user’s <code class="docutils literal notranslate"><span class="pre">PATH</span></code> environment variable to ensure
that the venv launcher will take precedence over other executables. As a result,
when a venv has been activated, PyManager can only be launched by its aliases
other than <code class="docutils literal notranslate"><span class="pre">python</span></code>. When an active virtual environment is detected, it will
be treated as the user’s default runtime (except for uninstall), which ensures
that other commands will also behave as expected.</p>
<p>This means that working virtual environments will behave as they do today with
no additional support from PyManager.</p>
</section>
</section>
<section id="backwards-compatibility">
<h2><a class="toc-backref" href="#backwards-compatibility" role="doc-backlink">Backwards Compatibility</a></h2>
<p>In general, there are no compatibility guarantees to the install process between
minor versions (<code class="docutils literal notranslate"><span class="pre">3.x</span></code> to <code class="docutils literal notranslate"><span class="pre">3.y</span></code>), and so “having to use a different
installer” is not considered compatibility breakage. The versions of Python
installed are only impacted by this change to the extent that the install method
modified their behaviour. In general, most installs will be closer to the
behaviour of having been built from source by the user themselves.</p>
<p>That said, there are a number of changes that will impact certain users when
they do move to a new install process. This section outlines as many of these
changes as we are aware of, in no particular order, and will likely form the
basis of a migration guide.</p>
<section id="scripted-downloads">
<h3><a class="toc-backref" href="#scripted-downloads" role="doc-backlink">Scripted downloads</a></h3>
<p>Users who wrote scripts to generate the download filename of our old installer
will find those scripts are broken. These URLs were never guaranteed stable or
predictable, and so we have no recourse to do anything other than apologise and
suggest users use our own tooling for downloads.</p>
<p>The deprecation period for the traditional installer allows time for these users
to learn about the upcoming change. Where possible, we will add deprecation
warnings to the traditional installer.</p>
</section>
<section id="scripted-installs">
<h3><a class="toc-backref" href="#scripted-installs" role="doc-backlink">Scripted installs</a></h3>
<p>Users who wrote scripts to execute our installer with particular options will
have to change their script. Most options have been removed, to begin with, and
those that remain have new spelling. Since it is not possible to reach a state
where options for the old installer are being passed to the new without manual
intervention (that is, someone has to change the command already), this is
considered an acceptable change.</p>
<p>The deprecation period for the traditional installer allows time for these users
to learn about the upcoming change. Where possible, we will add deprecation
warnings to the traditional installer.</p>
</section>
<section id="old-runtime-installed">
<h3><a class="toc-backref" href="#old-runtime-installed" role="doc-backlink">Old runtime installed</a></h3>
<p>Users with existing runtimes installed will find them selected by PyManager and
its aliases, provided the registration is not corrupt.</p>
<p>The priority order among installed runtimes has changed to only include
prerelease versions when specifically requested (for example, <code class="docutils literal notranslate"><span class="pre">-V:3</span></code> will
match 3.14.0 rather than 3.15.0a1, but <code class="docutils literal notranslate"><span class="pre">-V:3.15</span></code> will match 3.15.0a1), and to
correctly sort text suffixes on tags (for example, 3.14t is now <em>lower</em>
priority than 3.14).</p>
<p>While it is possible to provide warnings in cases where this may be impacting a
user, such warnings would be considered very noisy (e.g. a message every time
you launch <code class="docutils literal notranslate"><span class="pre">python</span></code> because you have a prerelease installed that wasn’t
selected) and require complicating the selection logic unnecessarily. This
change will be documented only.</p>
</section>
<section id="old-py-exe-launcher-installed">
<h3><a class="toc-backref" href="#old-py-exe-launcher-installed" role="doc-backlink">Old <code class="docutils literal notranslate"><span class="pre">py.exe</span></code> launcher installed</a></h3>
<p>Users who do not manually uninstall an old <code class="docutils literal notranslate"><span class="pre">py.exe</span></code> launcher will find that
both their existing and new installs of Python are found, though where versions
match the existing install will take priority over the new install (whereas the
new <code class="docutils literal notranslate"><span class="pre">py</span></code> would select the new install).</p>
<p>They will also find that commands such as <code class="docutils literal notranslate"><span class="pre">py</span> <span class="pre">list</span></code> do not work. The solution
here is to use Windows Settings to uninstall the launcher.</p>
<p>There is no way to detect that a user has accidentally left an old <code class="docutils literal notranslate"><span class="pre">py</span></code>
installed, or to remove it for them. This change will be documented only.</p>
</section>
<section id="misconfigured-venv-activated">
<h3><a class="toc-backref" href="#misconfigured-venv-activated" role="doc-backlink">Misconfigured venv activated</a></h3>
<p>Users who activate a corrupt or misconfigured virtual environment that is either
missing its <code class="docutils literal notranslate"><span class="pre">python.exe</span></code> or has it not on <code class="docutils literal notranslate"><span class="pre">PATH</span></code> may receive a different
error from before.</p>
<p>PyManager’s global <code class="docutils literal notranslate"><span class="pre">python</span></code> alias will be found and executed instead,
suppressing any system “not found” error. As it fails to find the environment’s
actual runtime, it will then fail, though the code and message may be different.</p>
<p>As this scenario requires an already corrupt system, this change will be
documented only.</p>
</section>
<section id="old-version-availability">
<h3><a class="toc-backref" href="#old-version-availability" role="doc-backlink">Old version availability</a></h3>
<p>Python versions prior to the first release of PyManager can be backfilled into
the python.org index, either based on newly repackaged archives or using the
almost equivalent packages from NuGet (the latter does not include Tcl/Tk,
making them significantly incompatible for some users, but this is likely okay
for especially old versions).</p>
<p>As of this PEP’s acceptance, the plan is to create packages for all versions of
Python 3.10.0 onwards (including patch releases, but excluding pre-releases), so that all non-EOL releases can
be fully installed using PyManager. Versions from Python 3.5.0 onwards (excluding
pre-releases) will directly reference the packages on NuGet, making them easily
available in reduced form. Neither approach requires rebuilding the existing
releases, nor are any changes required to the sources of those releases.</p>
</section>
<section id="administrator-installs">
<h3><a class="toc-backref" href="#administrator-installs" role="doc-backlink">Administrator installs</a></h3>
<p>Installing a copy of Python for all users is no longer possible, as PyManager
will only install into the user’s own directory. No scenario has been presented
to show that per-machine installs are in line with our intent for the upstream
distribution, and so we will simply not provide an option for them. Third
parties who desire this functionality are encouraged to provide their own
distributions.</p>
<p>PyManager can only be installed for all users, though an MSIX does not require
administrative privileges to install, and can be extensively configured by an
administrator, including to constrain the actual runtimes which users may
install. Additionally, PyManager supports local extraction for bundling, and so
embedding apps can easily generate their own layout, which can be installed for
all users if they so desire.</p>
<p>As this scenario requires administrator intervention with or without any
changes, this will be documented only.</p>
</section>
<section id="build-time-installs">
<h3><a class="toc-backref" href="#build-time-installs" role="doc-backlink">Build-time installs</a></h3>
<p>Users using the embeddable distro may have to change to a new method for
discovering the URL to the packages, though the recommendation would be to use
PyManager to discover and install. No differences are anticipated due to the
change of installer, and the embeddable distro package would be identical to
today.</p>
<p>No changes to the NuGet packages are proposed.</p>
</section>
<section id="single-architecture-installer">
<h3><a class="toc-backref" href="#single-architecture-installer" role="doc-backlink">Single architecture installer</a></h3>
<p>The current proposal only makes an Intel 64-bit build of PyManager available.
This will prevent users on 32-bit only operating systems or CPUs from being able
to install PyManager. As this is a vanishingly small proportion of machines
today, and an even smaller proportion of developer machines (the target audience
for PyManager), we are not concerned about excluding users.</p>
<p>Windows ARM64 machines support running binaries built for Intel 64-bit through
efficient emulation. CPython 32-bit builds will still be available as they have
an important role in integrating with 32-bit executables, which does not allow
substitution of 64-bit binaries. As PyManager runs as a standalone executable,
this is not a necessary feature for the manager.</p>
</section>
<section id="test-suite-and-debug-symbols">
<h3><a class="toc-backref" href="#test-suite-and-debug-symbols" role="doc-backlink">Test suite and debug symbols</a></h3>
<p>The existing installer optionally allows installation of the Python standard
library test suite, and optional installation of debug symbols. Neither of these
are necessary for most users, but they are convenient for some. Preliminary
testing shows that omitting the test suite and debug symbols saves about 60% of
the size of the compressed package (from 46MB to 18MB).</p>
<p>The “default” CPython packages installed by PyManager will therefore not include
the test suite or the debug symbols. However, there will be a second set of
packages that do include these extras, grouped under <code class="docutils literal notranslate"><span class="pre">PythonTest</span></code> (as opposed
to the default, <code class="docutils literal notranslate"><span class="pre">PythonCore</span></code>). For example, where <code class="docutils literal notranslate"><span class="pre">py</span> <span class="pre">install</span> <span class="pre">3.13</span></code> would
install the default, <code class="docutils literal notranslate"><span class="pre">py</span> <span class="pre">install</span> <span class="pre">PythonTest\\3.13</span></code> would install a second
runtime with the additional files (which can either be launched with <code class="docutils literal notranslate"><span class="pre">py</span>
<span class="pre">-V:PythonTest\\3.13</span></code>, or simply <code class="docutils literal notranslate"><span class="pre">py</span> <span class="pre">-V:3.13</span></code> if no equivalent <code class="docutils literal notranslate"><span class="pre">PythonCore</span></code>
version is installed).</p>
<p>Debug binaries are no longer distributed, and all other optional features are
included by default.</p>
</section>
<section id="global-pip-command">
<h3><a class="toc-backref" href="#global-pip-command" role="doc-backlink">Global pip command</a></h3>
<p>Unlike the current Windows Store install, no global <code class="docutils literal notranslate"><span class="pre">pip</span></code> command is included
(the traditional installer also does not include a global <code class="docutils literal notranslate"><span class="pre">pip</span></code> command,
unless the options to modify <code class="docutils literal notranslate"><span class="pre">PATH</span></code> and to install pip are selected; the first
of these is off by default). This impacts global installation of packages, which
is already discouraged, but has no impact on activated virtual environments.</p>
<p>The existing recommendation remains, which is to run <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">-m</span> <span class="pre">pip</span></code> or
<code class="docutils literal notranslate"><span class="pre">py</span> <span class="pre">-V:&lt;TAG&gt;</span> <span class="pre">-m</span> <span class="pre">pip</span></code> to launch pip.</p>
</section>
</section>
<section id="security-implications">
<h2><a class="toc-backref" href="#security-implications" role="doc-backlink">Security Implications</a></h2>
<p>In this section we compare the security implications of the installer itself to
the existing installers. The implications of Python being installed on a machine
are out of scope, and the ability of a malicious user to execute the installer
is also out of scope.</p>
<p>The typical risk introduced by an installer is that an elevated install may make
changes to a system that allow a low-privileged user to later affect a
high-privilege user, for example, by inappropriately setting access control on
shared folders. PyManager only operates as the same privilege level as the user,
and therefore cannot introduce any escalation path.</p>
<p>An install using the MSI described earlier may introduce additional risks, due
to using older installer technology. Typical users are directed towards the MSIX
or Windows Store install paths, which are safe, and it is assumed that users
of the MSI are capable of ensuring the security of their install process (for
example, by correctly quoting their commands to launch the installer and
ensuring the initial system configuration is suitable).</p>
<p>Once PyManager is installed on a machine, it is likely that malicious users will
use it to install Python. The admin-only configuration described earlier in
“Configuration” is intended to control these scenarios. Ultimately though, an
attacker who can run PyManager is able to do whatever the user can do, and only
a complete application whitelisting approach can prevent the use of Python.</p>
<p>Acquisition of packages over HTTPS is protected by the connection security. We
use native Windows download mechanisms that support public and enterprise
certificates, as well as authenticated proxy servers. The feed may include
hashes for downloadable packages, which will be verified, but there is no
third-party hosted verification built into PyManager. This is consistent with
today’s model.</p>
<p>Runtime installs by PyManager are fully accessible by, and modifiable by, the
current user. This is equivalent to typical installs using the traditional
installer or a NuGet package, but is more vulnerable to tampering than a Store
install or a per-machine install with the traditional installer. It is not
possible to fully protect an install from the user who installed it.
Reinstalling or updating an install performs a clean install, which will revert
any tampering that may have occurred since the original install.</p>
<p>The aliases generated by PyManager when installing a runtime are designed to
use a signed, unmodified executable that uses an adjacent data file to launch
the correct target. This can be easily abused to direct the launcher to launch
an alternative, however, the only way to resolve this would sacrifice the trust
in the executable itself, making it trivial to replace it instead of the data.
Such risk already exists, and is equivalent to replacing the script that a user
may launch, or any part of the standard library. Importantly, since aliases are
not shared between users, there is no escalation of privilege along this route.</p>
<p>PyManager has no mechanism to perform a per-machine install. This may be useful
functionality to some users, as it would allow an install to be completely
unmodifiable by the regular user (excluding virtual environments and the user
site folders). Such functionality may be manually imitated by an administrator
using PyManager and other OS commands, but it is not considered a critical
workflow. The recommended alternative is for an administrator to provide
PyManager and override its configuration.</p>
</section>
<section id="impact-on-existing-peps">
<h2><a class="toc-backref" href="#impact-on-existing-peps" role="doc-backlink">Impact on Existing PEPs</a></h2>
<p>This proposal would effectively replace <a class="pep reference internal" href="../pep-0397/" title="PEP 397 – Python launcher for Windows">PEP 397</a> (“Python launcher for Windows”)
and <a class="pep reference internal" href="../pep-0486/" title="PEP 486 – Make the Python Launcher aware of virtual environments">PEP 486</a> (“Make the Python Launcher aware of virtual environments”) by
defining the same functionality as part of a new tool with the same name. Both
are already considered final, and the launcher is defined by its documentation
and normal compatibility processes. New functionality is based on the current
implementation, and not the original PEP text.</p>
<p>This proposal has no impact on <a class="pep reference internal" href="../pep-0394/" title="PEP 394 – The “python” Command on Unix-Like Systems">PEP 394</a> (“The “python” Command on Unix-Like
Systems”), and is believed to be consistent with it in devising an approach for
Windows that allows similar guidance to be given to users on all platforms.</p>
<p>This proposal has no impact on <a class="pep reference internal" href="../pep-0514/" title="PEP 514 – Python registration in the Windows registry">PEP 514</a> (“Python registration in the Windows
registry”), and in fact improves our ability to follow it with a more flexible
system for registering our own runtimes. Tools that follow PEP 514 will find any
runtimes that choose to use the registration, regardless of how they were
installed.</p>
</section>
<section id="how-to-teach-this">
<h2><a class="toc-backref" href="#how-to-teach-this" role="doc-backlink">How to Teach This</a></h2>
<section id="basic-use">
<h3><a class="toc-backref" href="#basic-use" role="doc-backlink">Basic Use</a></h3>
<p>A central goal of this proposal is that “type ‘python’ in your terminal” will be
sufficient instruction for the most basic cases. Thanks to the redirector added
by Microsoft, following this instruction will at least result in something
useful happening, and with PyManager we can ensure that “something useful” means
that the user is running the latest version.</p>
<p>To explain what is actually happening, we propose the following as introductory
text:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Python installs on Windows are managed using an installer tool. After it has
been installed, you can run ``python`` to launch the interpreter, and it will
choose the best version already installed, available online, or referenced by
the script you are launching (if any). If you have a preference for a
particular version, you can specify it with ``py -V:&lt;version&gt;`` followed
by the rest of your command.

To install a version of Python without running any command, use ``py install
&lt;version&gt;``. You can see all of your installs with ``py list`` and remove them
with ``py uninstall &lt;version&gt;``. Run ``py help`` to see all the options that
are available.

Because each version of Python will be shared by all your projects, we
recommend using virtual environments. This will usually be created for a
particular Python version by running ``py -V:&lt;version&gt; -m venv .venv``, and
activated with ``.venv\Scripts\Activate``. Now, rather than the install
manager, ``python`` or ``py`` will always launch your virtual environment, and
any packages you install are only available while this environment is active.
To get access to the manager again, you can ``deactivate`` the environment, or
use ``py &lt;command&gt;``.
</pre></div>
</div>
<p>Many Python projects include information about how to launch their projects as
part of their own README files. Historically, such information has been
complicated due to the range of options available to users. We propose that,
after the install manager is published, such guidance could be written along
these lines:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>To install and use our application, first install Python following the
guidance for your operating system at https://docs.python.org/using/. Then,
create a virtual environment and use &#39;pip&#39; to install.

``python3 -m venv .venv``
``source .venv/bin/activate`` or ``.venv\Scripts\Activate`` (on Windows)
``python -m pip install OurAwesomePackage``
...
</pre></div>
</div>
<p>If instructions will not include information about virtual environments, then
the <code class="docutils literal notranslate"><span class="pre">python</span></code> or <code class="docutils literal notranslate"><span class="pre">python3</span></code> command can be shown, and on Windows both will
operate as intended for users with the install manager.</p>
<p>Instructions currently referring to <code class="docutils literal notranslate"><span class="pre">py</span></code> for Windows can continue to do so, as
the install manager provides a practically equivalent command. Projects that
wish to provide Windows-specific instructions, such as by using the <code class="docutils literal notranslate"><span class="pre">-V:</span></code>
or <code class="docutils literal notranslate"><span class="pre">--install</span></code> options to install the correct version, should also link to the
<a class="reference external" href="https://docs.python.org/3/using/windows.html#using-on-windows" title="(in Python v3.14)"><span class="xref std std-ref">documentation</span></a> as guidance for
ensuring that the install manager is installed.</p>
</section>
<section id="uninstallation">
<h3><a class="toc-backref" href="#uninstallation" role="doc-backlink">Uninstallation</a></h3>
<p>Complete uninstallation is an important topic to cover before a user is likely
to consider removing the install manager. Since not all parts of installs can be
automatically cleaned up when removing the manager, we choose not to remove most
of them. So while the default <code class="docutils literal notranslate"><span class="pre">python</span></code> and <code class="docutils literal notranslate"><span class="pre">py</span></code> commands will go away, all
the runtimes that were installed are still present and usable.</p>
<p>We suggest an explanation like this:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Before you uninstall the Python install manager, you&#39;ll want to uninstall any
runtimes that you added. This can be done easily with the &quot;purge&quot; option:

``py uninstall --purge``

This will remove all installs and any shortcuts that would otherwise be left
behind. If you already removed the manager, you can reinstall it and run the
above uninstall command again to clean up. Individual runtimes can be
uninstalled by specifying the tag instead of ``--purge``. Tags can be found
by looking at ``python list``.
</pre></div>
</div>
</section>
<section id="id1">
<h3><a class="toc-backref" href="#id1" role="doc-backlink">Configuration</a></h3>
<p>Configuration files are a common feature that will be documented, but do not
need to be taught to regular users. Similarly, advanced deployment options, such
as those that might be used by system administrators or organisations wanting
their users to use a preferred index, are best covered in reference material.</p>
</section>
<section id="custom-index">
<h3><a class="toc-backref" href="#custom-index" role="doc-backlink">Custom Index</a></h3>
<p>We suggest that indexes only need to be introduced when instructing users to
install a specialised runtime or distribution. Administrators seeking to provide
an index are anticipated to actively seek out the relevant information in the
documentation.</p>
<p>To explain how and when to use an alternate index, we propose text along these
lines:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Our distribution can be installed on Windows using the Python Install Manager
(include link) by referencing our index:

``py install --source &lt;your index URL here&gt; latest``

This index contains all our versions. Use ``py list --source &lt;URL&gt;`` to
see everything that is available.
</pre></div>
</div>
</section>
</section>
<section id="reference-implementation">
<h2><a class="toc-backref" href="#reference-implementation" role="doc-backlink">Reference Implementation</a></h2>
<p>The reference implementation is available at <a class="reference external" href="https://github.com/zooba/pymanager/">the author’s repository</a>
with a precompiled MSIX package under <a class="reference external" href="https://github.com/zooba/pymanager/releases">Releases</a>. This sample includes a bundled
index, rather than a hosted one, and references a range of existing NuGet
packages to allow install testing.</p>
<p>Reference documentation can also be found in <a class="reference external" href="https://github.com/zooba/pymanager/blob/main/doc/using.rst">the same repository</a>.</p>
</section>
<section id="rejected-ideas">
<h2><a class="toc-backref" href="#rejected-ideas" role="doc-backlink">Rejected Ideas</a></h2>
<section id="make-pymanager-available-on-all-platforms">
<h3><a class="toc-backref" href="#make-pymanager-available-on-all-platforms" role="doc-backlink">Make PyManager available on all platforms</a></h3>
<p>While we are not inherently opposed to this idea, it relies on many more
components being aligned before it can become possible.</p>
<p>Firstly, as it stands, the reference implementation has a lot of
Windows-specific knowledge. Equivalent knowledge for other platforms would need
to be collated and implemented, as well as any additional behaviours specific to
non-Windows platforms.</p>
<p>Second, we need a source of pre-built, relocatable binaries that can be
extracted onto the system. While such sources do exist, due to our position in
the supply chain, we cannot justifiably use them (they should be using us). For
Windows, our own binaries already meet these criteria, so we can repackage them
without modification.</p>
<p>Third, the current implementation relies on a bundled Python runtime, which must
be isolated from any user interference for obvious reasons. This would also
require the relocatable binaries mentioned above, which we currently only have
for Windows.</p>
<p>Due to the additional steps needed to make this functional on other platforms,
and the fact that there isn’t a need to replace existing installers for those
platforms, we consider this idea out of scope for this PEP. It may be pursued in
the future (and the contributors most likely to do so have indicated that they
are looking into it and would be able to use a consistent interface).</p>
</section>
<section id="include-a-runtime-pre-installed-with-the-manager">
<h3><a class="toc-backref" href="#include-a-runtime-pre-installed-with-the-manager" role="doc-backlink">Include a runtime pre-installed with the manager</a></h3>
<p>The proposal is to have a full Python runtime included with PyManager, so that
its <code class="docutils literal notranslate"><span class="pre">python.exe</span></code> alias can refer directly to it rather than resolving to the
best available version dynamically.</p>
<p>It is very important for stability and updates that runtime releases are
fully independent of the manager. Updating the manager should be possible
without affecting any existing runtime installs, and likewise there should be
no requirement to update the manager to get a newer runtime.</p>
<p>Hypothetically, if we were to include Python 3.14.0 with the manager such that
it did not need to be installed, it would be a breaking change to later replace
that with 3.15.0. As we only have a single install for the manager, this would
result in the newest installs getting the oldest runtime.</p>
<p>This would also ignore the status of PyManager’s <code class="docutils literal notranslate"><span class="pre">python</span></code> alias as being of an
unspecified version - when the user is launching this alias, it’s because they
didn’t care what version they get enough to specify one. In that situation, we
ought to select the best available, and allow them the options to stabilise it
as is appropriate (whether through a shebang or an active environment).</p>
</section>
<section id="include-a-runtime-instead-of-the-manager">
<h3><a class="toc-backref" href="#include-a-runtime-instead-of-the-manager" role="doc-backlink">Include a runtime INSTEAD OF the manager</a></h3>
<p>This is the current situation, which we are trying to change. If you read this
far and still chose to make this argument, please go back and start again.</p>
</section>
<section id="use-a-built-in-module-rather-than-subcommands">
<h3><a class="toc-backref" href="#use-a-built-in-module-rather-than-subcommands" role="doc-backlink">Use a built-in module rather than subcommands</a></h3>
<p>Two alternatives to using commands like <code class="docutils literal notranslate"><span class="pre">py</span> <span class="pre">list</span></code> or <code class="docutils literal notranslate"><span class="pre">py</span> <span class="pre">install</span></code> that have
been proposed are to use either dedicated modules, invoked like <code class="docutils literal notranslate"><span class="pre">py</span> <span class="pre">-m</span> <span class="pre">list</span></code>
and <code class="docutils literal notranslate"><span class="pre">py</span> <span class="pre">-m</span> <span class="pre">install</span></code>, or a single dedicated module invoked like <code class="docutils literal notranslate"><span class="pre">py</span> <span class="pre">-m</span> <span class="pre">manage</span>
<span class="pre">list</span></code>. This idea is rejected on the basis that it attempts to reuse existing
semantics for a scenario that cannot be reliably implemented by those semantics,
and so will require a special case that is harder to explain, understand, and
maintain.</p>
<p>The main reason this idea is rejected is due to the interaction of two otherwise
desirable semantics: first, that the default <code class="docutils literal notranslate"><span class="pre">py</span></code> command should launch the
latest available runtime as if it were launched directly; and second, that the
behaviour of <code class="docutils literal notranslate"><span class="pre">-m</span></code> should not be treated as a special case in some
circumstances. If the first part were dropped, we would freely modify the
command to behave as users expect - nobody would be raising compatibility
concerns at all if we were agreed to completely break compatibility. However, if
the second constraint were dropped, users would bear the burden of the ensuring
confusion. (We aren’t proposing dropping either - this is a rejected idea, after
all - but it helps to illustrate what the options are.)</p>
<p>First, since one of the subcommands is intended to install your first runtime,
we cannot treat <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">-m</span> <span class="pre">[manage]</span> <span class="pre">install</span></code> as if it is running through the
default runtime - there isn’t one! It inherently requires special case handling
in order to read the command and execute it through a different program.</p>
<p>Additionally, Python allows other options to precede or mingle with the <code class="docutils literal notranslate"><span class="pre">-m</span></code>,
which would have to be supported by this special case.</p>
<p>Finally, the semantics of the <code class="docutils literal notranslate"><span class="pre">-m</span></code> option include searching the initial
<code class="docutils literal notranslate"><span class="pre">sys.path</span></code> for matching module names. This is a considerably more broad search
than a bare name. <code class="docutils literal notranslate"><span class="pre">py</span> <span class="pre">-m</span> <span class="pre">install</span></code> would gladly execute <code class="docutils literal notranslate"><span class="pre">install.py</span></code>,
<code class="docutils literal notranslate"><span class="pre">install.pyc</span></code>, <code class="docutils literal notranslate"><span class="pre">install.pyd</span></code>, <code class="docutils literal notranslate"><span class="pre">install\\__init__.py</span></code>, and more after
searching a number of directories found by inspecting the file system, the
environment, the registry, as well as any transitively included paths found in
those. Compared to <code class="docutils literal notranslate"><span class="pre">py</span> <span class="pre">install</span></code>, which would <em>only</em> look for a file called
precisely <code class="docutils literal notranslate"><span class="pre">install</span></code> in the current working directory, the <code class="docutils literal notranslate"><span class="pre">-m</span></code> behaviour is
far more likely to be already relied upon by real scenarios. (For example,
Django projects typically have a <code class="docutils literal notranslate"><span class="pre">manage.py</span></code> script, meaning that <code class="docutils literal notranslate"><span class="pre">py</span> <span class="pre">-m</span>
<span class="pre">manage</span></code> would always behave incorrectly.)</p>
<p>Changing <code class="docutils literal notranslate"><span class="pre">py</span> <span class="pre">-m</span> <span class="pre">install</span></code> to <em>not</em> behave like <code class="docutils literal notranslate"><span class="pre">-m</span></code>, but instead to execute
an internal command, is vastly more likely to break users than changing
<code class="docutils literal notranslate"><span class="pre">py</span> <span class="pre">install</span></code>. As such, this idea is rejected.</p>
</section>
<section id="use-a-new-command-line-option-rather-than-subcommands">
<h3><a class="toc-backref" href="#use-a-new-command-line-option-rather-than-subcommands" role="doc-backlink">Use a new command-line option rather than subcommands</a></h3>
<p>A reasonable alternative to subcommands is to specify their names with leading
punctuation, like an option rather than a subcommand. For example, this may look
like <code class="docutils literal notranslate"><span class="pre">py</span> <span class="pre">/install</span> <span class="pre">...</span></code> rather than <code class="docutils literal notranslate"><span class="pre">py</span> <span class="pre">install</span></code>, or <code class="docutils literal notranslate"><span class="pre">py</span> <span class="pre">--list</span></code>. Because
some of these are currently errors for a normal CPython interpreter, they
could be added without any backwards compatibility concern.</p>
<p>Notably, however, the typical Windows format of a leading slash is not an error
in CPython. Windows users therefore cannot directly transfer existing knowledge
and must learn a new way to specify options. As we are proposing a Windows
specific tool, this is a terrible start. Additionally, those users familiar with
Unix-style command lines will recognise the misuse of options as commands.</p>
<p>We desire to create a clean interface, and starting with a design that includes
obvious warts or learning challenges is counter to that goal. Modern tools
universally use subcommands for these purposes, and so the idea to use something
different is rejected.</p>
</section>
<section id="improving-the-current-traditional-installer-instead">
<h3><a class="toc-backref" href="#improving-the-current-traditional-installer-instead" role="doc-backlink">Improving the current traditional installer instead</a></h3>
<p>Rather than creating a new install mechanism, we could invest in maintaining the
current installer. At this stage, however, our current installer is based
entirely on retired technology. Windows is no longer developing the Windows
Installer service, and Wix are no longer improving the version of their toolset
that we use. Migrating to a newer Wix Toolset is a significant amount of work,
and ultimately still leaves us tied to old technologies.</p>
<p>As mentioned earlier, the most beneficial functionality provided by Windows
Installer is not used for CPython, and generally has caused more issues than it
has ever solved (for example, accidental downgrades due to automatically
collected file version information).</p>
<p>The implementation of the Burn bundle, which is our primary source of installer
logic, is in C++ and integrated into a framework that few core developers are
familiar with. This makes maintenance challenging, and is not a good long term
position to take. Migrating desired features such as registration-free installs
into the Burn bundle is not possible (without writing the end-to-end
reimplementation and integrating it as an afterthought).</p>
<p>Our view is that maintaining the current traditional installer is at least as
much effort as implementing a new installer, and would not provide meaningful
benefits for the core team or for our users. As such, this idea is rejected.</p>
</section>
<section id="delete-the-store-package-completely">
<h3><a class="toc-backref" href="#delete-the-store-package-completely" role="doc-backlink">Delete the Store package completely</a></h3>
<p>Removing the Store packages would reduce the number of options users face when
choosing a Python runtime. By all measures apart from reliability and security,
the traditional installer is entirely sufficient as a substitute. The effort to
migrate parts of the ecosystem to more secure settings (such as not relying on
DLL hijacking) has largely occurred, but some packages remain that still only
work with less secure configurations, and moving all users back to these
configurations would ensure that users of these packages would not face the
issues they face today.</p>
<p>However, the majority of users of the Store packages appear to have no
complaints. Anecdotally, they are often fully satisfied by the Store install,
and particularly appreciate the ease and reliability of installation. (And on a
personal note, this author has been using Store packages exclusively since
Python 3.8 with no blocking issues.)</p>
<p>The greatest number of issues have been caused by misconfigured <code class="docutils literal notranslate"><span class="pre">PATH</span></code>
variables and the default <code class="docutils literal notranslate"><span class="pre">python.exe</span></code> redirector installed by Microsoft. In
other words, entirely unrelated to our own package (though sometimes related to
unresolvable issues in our other installer). For the sake of the high number of
successful installs through this path, we consider the burden of diagnosing and
assisting impacted users to be worthwhile, and consider the idea to simply drop
the Store package rejected.</p>
<p>That said, when PyManager is published to the Store, we would plan to delist all
existing runtimes on the Store to ensure users find the manager. This only
impacts new installs, and anyone who has previously installed a particular
version (even on another machine, if they were logged in) will be able to
continue to use and install those versions.</p>
</section>
<section id="rely-on-winget-or-equivalents">
<h3><a class="toc-backref" href="#rely-on-winget-or-equivalents" role="doc-backlink">Rely on WinGet or equivalents</a></h3>
<p>WinGet, Chocolatey, and other similar tools are not installers in the sense that
we require. They use their own repository of metadata to download, validate, and
run installers. Without our own installer, they have nothing to run, and so
cannot be used.</p>
<p>It is possible that their metadata will not support installing PyManager and
then running it to install a particular runtime. If this is the case, they may
need to investigate using our binary packages directly.</p>
<p>Currently, none of these install tools are officially supported by CPython, and
so we have no obligation to make them work.</p>
</section>
<section id="make-every-version-a-windows-store-package">
<h3><a class="toc-backref" href="#make-every-version-a-windows-store-package" role="doc-backlink">Make every version a Windows Store package</a></h3>
<p>It is possible to release each version to the Windows Store as we currently do,
but make them unlisted and rely on an installer (potentially PyManager, WinGet,
or another tool that can install Store packages). This would avoid the risk of
overwhelming the user, while greatly simplifying our own reponsibilities for
package management.</p>
<p>This approach would leave a significant burden on whichever contributor has
access to the Store publishing interface, as updating packages is a manual
operation. Additionally, it would leave every Python runtime with the technical
limitations outlined earlier. As such, this idea is rejected.</p>
<p>Making every version a MSIX package rather than a ZIP, even though this avoids
the Store publishing interface, would still impose technical limitations on
users. It is also rejected.</p>
</section>
<section id="just-publish-the-plain-zip-file">
<h3><a class="toc-backref" href="#just-publish-the-plain-zip-file" role="doc-backlink">Just publish the plain ZIP file</a></h3>
<p>Publishing the plain ZIP file is part of the plan, however, it will not be
visibly listed (for example, on the python.org download pages, though they will
be visible in the FTP view). An alternative would be to publish and list these
packages, and expect users to download and manually extract and configure them.</p>
<p>Given the workflows we see, we believe that most users do not want to configure
a Python install at all. Not only do they not want to choose the install
location, they do not want to choose a version, or even have to search for a
download provider or instructions. However, they do want to be able to find an
install later, launch, update or remove it, or list all known installs.</p>
<p>It is also worth recognising that there will be more ZIP files than are
currently listed on the Download pages, and so the list of files will become
longer. Choosing the correct download is already challenging for users (those
who bypass the primary “Download” button and view the list of all available
versions and then files), and we have no desire to make it more challenging.</p>
<p>The index protocol and download list will be available for tools that wish to
use it, or for users who are willing to navigate JSON in order to find the URL.
The <code class="docutils literal notranslate"><span class="pre">--target</span></code> option on the install command also provides a trivial download
and extract operation, allowing users to have the same experience as a ZIP file.
And the <code class="docutils literal notranslate"><span class="pre">--download</span></code> option can give users the ZIP file still zipped.</p>
</section>
<section id="only-publish-pymanager-to-one-place">
<h3><a class="toc-backref" href="#only-publish-pymanager-to-one-place" role="doc-backlink">Only publish PyManager to one place</a></h3>
<p>Whether the Windows Store or python.org, it would be viable to publish to only
one location.</p>
<p>However, users strongly expect to be able to download <em>something</em> from
python.org. If we were to remove any option at all, we would inevitably hurt our
users. Without an MSIX available on python.org, users have no way to transfer
the package to another machine, or to fully script the initial install of the
manager.</p>
<p>Many users rely on the Windows Store app to install packages, and the built-in
redirector in Windows can only open to a Store page. As such, removing the Store
app is equivalent to denying hundreds of thousands of installs each month.</p>
<p>The two builds are practically identical. The only difference between the MSIX
we provide to the Store and the one that goes to python.org is package signing:
we sign the python.org package ourselves, while the Store package is signed as
part of the publish process. Otherwise, there is no additional cost to producing
and publishing both packages.</p>
</section>
<section id="inline-script-metadata">
<h3><a class="toc-backref" href="#inline-script-metadata" role="doc-backlink">Inline Script Metadata</a></h3>
<p>PEP 723 introduced inline script metadata, a structured comment intended for
third-party tools to interpret and then launch a Python script in the correct
environment. An example taken from that PEP:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># /// script</span>
<span class="c1"># requires-python = &quot;&gt;=3.11&quot;</span>
<span class="c1"># dependencies = [</span>
<span class="c1">#   &quot;requests&lt;3&quot;,</span>
<span class="c1">#   &quot;rich&quot;,</span>
<span class="c1"># ]</span>
<span class="c1"># ///</span>
</pre></div>
</div>
<p>PyManager has no integrated support for installing dependencies, and does not
propose adding any. As a result, we could not fully implement handling of this
metadata, and as we consider partial handling to be worse than nothing, we
choose not to implement any.</p>
<p>It is possible for a user to specify the constraint directly as an option, for
example, <code class="docutils literal notranslate"><span class="pre">py</span> <span class="pre">-V:&gt;=3.11</span> <span class="pre">my-script.py</span></code> to get the selection behaviour.</p>
<p>We could also detect the metadata and warn if the selected runtime does not
match its requirement, but this is not part of the initial proposal.</p>
</section>
</section>
<section id="copyright">
<h2><a class="toc-backref" href="#copyright" role="doc-backlink">Copyright</a></h2>
<p>This document is placed in the public domain or under the
CC0-1.0-Universal license, whichever is more permissive.</p>
</section>
</section>
<hr class="docutils" />
<p>Source: <a class="reference external" href="https://github.com/python/peps/blob/main/peps/pep-0773.rst">https://github.com/python/peps/blob/main/peps/pep-0773.rst</a></p>
<p>Last modified: <a class="reference external" href="https://github.com/python/peps/commits/main/peps/pep-0773.rst">2025-04-28 22:24:29 GMT</a></p>

        </article>
        <nav id="pep-sidebar">
            <h2>Contents</h2>
            <ul>
<li><a class="reference internal" href="#abstract">Abstract</a><ul>
<li><a class="reference internal" href="#reader-s-note">Reader’s Note</a></li>
</ul>
</li>
<li><a class="reference internal" href="#background">Background</a><ul>
<li><a class="reference internal" href="#expectations">Expectations</a></li>
<li><a class="reference internal" href="#traditional-installer">Traditional Installer</a></li>
<li><a class="reference internal" href="#windows-store">Windows Store</a></li>
<li><a class="reference internal" href="#nuget-package">NuGet Package</a></li>
<li><a class="reference internal" href="#embeddable-package">Embeddable Package</a></li>
<li><a class="reference internal" href="#alternate-distributions">Alternate Distributions</a></li>
<li><a class="reference internal" href="#challenges">Challenges</a></li>
</ul>
</li>
<li><a class="reference internal" href="#overview-of-pymanager">Overview of PyManager</a><ul>
<li><a class="reference internal" href="#replacing-other-installers">Replacing other installers</a></li>
<li><a class="reference internal" href="#project-ownership-and-development">Project ownership and development</a></li>
</ul>
</li>
<li><a class="reference internal" href="#specification">Specification</a><ul>
<li><a class="reference internal" href="#exec-subcommand">Exec subcommand</a></li>
<li><a class="reference internal" href="#install-subcommand">Install subcommand</a></li>
<li><a class="reference internal" href="#uninstall-subcommand">Uninstall subcommand</a></li>
<li><a class="reference internal" href="#list-subcommand">List subcommand</a></li>
<li><a class="reference internal" href="#help-subcommand">Help subcommand</a></li>
<li><a class="reference internal" href="#environment-variables">Environment Variables</a></li>
<li><a class="reference internal" href="#start-menu-shortcuts">Start Menu Shortcuts</a></li>
<li><a class="reference internal" href="#file-associations">File Associations</a></li>
<li><a class="reference internal" href="#windowed-executables">Windowed Executables</a></li>
<li><a class="reference internal" href="#configuration">Configuration</a></li>
<li><a class="reference internal" href="#index-schema">Index Schema</a></li>
<li><a class="reference internal" href="#shebang-processing">Shebang Processing</a></li>
</ul>
</li>
<li><a class="reference internal" href="#rationale">Rationale</a><ul>
<li><a class="reference internal" href="#changing-the-python-exe-command">“Changing” the python.exe command</a></li>
<li><a class="reference internal" href="#replacing-py-exe">Replacing py.exe</a></li>
<li><a class="reference internal" href="#interaction-with-venv">Interaction with venv</a></li>
</ul>
</li>
<li><a class="reference internal" href="#backwards-compatibility">Backwards Compatibility</a><ul>
<li><a class="reference internal" href="#scripted-downloads">Scripted downloads</a></li>
<li><a class="reference internal" href="#scripted-installs">Scripted installs</a></li>
<li><a class="reference internal" href="#old-runtime-installed">Old runtime installed</a></li>
<li><a class="reference internal" href="#old-py-exe-launcher-installed">Old <code class="docutils literal notranslate"><span class="pre">py.exe</span></code> launcher installed</a></li>
<li><a class="reference internal" href="#misconfigured-venv-activated">Misconfigured venv activated</a></li>
<li><a class="reference internal" href="#old-version-availability">Old version availability</a></li>
<li><a class="reference internal" href="#administrator-installs">Administrator installs</a></li>
<li><a class="reference internal" href="#build-time-installs">Build-time installs</a></li>
<li><a class="reference internal" href="#single-architecture-installer">Single architecture installer</a></li>
<li><a class="reference internal" href="#test-suite-and-debug-symbols">Test suite and debug symbols</a></li>
<li><a class="reference internal" href="#global-pip-command">Global pip command</a></li>
</ul>
</li>
<li><a class="reference internal" href="#security-implications">Security Implications</a></li>
<li><a class="reference internal" href="#impact-on-existing-peps">Impact on Existing PEPs</a></li>
<li><a class="reference internal" href="#how-to-teach-this">How to Teach This</a><ul>
<li><a class="reference internal" href="#basic-use">Basic Use</a></li>
<li><a class="reference internal" href="#uninstallation">Uninstallation</a></li>
<li><a class="reference internal" href="#id1">Configuration</a></li>
<li><a class="reference internal" href="#custom-index">Custom Index</a></li>
</ul>
</li>
<li><a class="reference internal" href="#reference-implementation">Reference Implementation</a></li>
<li><a class="reference internal" href="#rejected-ideas">Rejected Ideas</a><ul>
<li><a class="reference internal" href="#make-pymanager-available-on-all-platforms">Make PyManager available on all platforms</a></li>
<li><a class="reference internal" href="#include-a-runtime-pre-installed-with-the-manager">Include a runtime pre-installed with the manager</a></li>
<li><a class="reference internal" href="#include-a-runtime-instead-of-the-manager">Include a runtime INSTEAD OF the manager</a></li>
<li><a class="reference internal" href="#use-a-built-in-module-rather-than-subcommands">Use a built-in module rather than subcommands</a></li>
<li><a class="reference internal" href="#use-a-new-command-line-option-rather-than-subcommands">Use a new command-line option rather than subcommands</a></li>
<li><a class="reference internal" href="#improving-the-current-traditional-installer-instead">Improving the current traditional installer instead</a></li>
<li><a class="reference internal" href="#delete-the-store-package-completely">Delete the Store package completely</a></li>
<li><a class="reference internal" href="#rely-on-winget-or-equivalents">Rely on WinGet or equivalents</a></li>
<li><a class="reference internal" href="#make-every-version-a-windows-store-package">Make every version a Windows Store package</a></li>
<li><a class="reference internal" href="#just-publish-the-plain-zip-file">Just publish the plain ZIP file</a></li>
<li><a class="reference internal" href="#only-publish-pymanager-to-one-place">Only publish PyManager to one place</a></li>
<li><a class="reference internal" href="#inline-script-metadata">Inline Script Metadata</a></li>
</ul>
</li>
<li><a class="reference internal" href="#copyright">Copyright</a></li>
</ul>

            <br>
            <a id="source" href="https://github.com/python/peps/blob/main/peps/pep-0773.rst?plain=1">Page Source (GitHub)</a>
        </nav>
    </section>
    <script src="../_static/colour_scheme.js"></script>
    <script src="../_static/wrap_tables.js"></script>
    <script src="../_static/sticky_banner.js"></script>
    <script src="https://analytics.python.org/js/script.outbound-links.js"
            data-domain="peps.python.org" defer></script>
</body>
</html>