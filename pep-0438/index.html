
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="color-scheme" content="light dark">
    <title>PEP 438 – Transitioning to release-file hosting on PyPI | peps.python.org</title>
    <link rel="shortcut icon" href="../_static/py.png">
    <link rel="canonical" href="https://peps.python.org/pep-0438/">
    <link rel="stylesheet" href="../_static/style.css" type="text/css">
    <link rel="stylesheet" href="../_static/mq.css" type="text/css">
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" media="(prefers-color-scheme: light)" id="pyg-light">
    <link rel="stylesheet" href="../_static/pygments_dark.css" type="text/css" media="(prefers-color-scheme: dark)" id="pyg-dark">
    <link rel="alternate" type="application/rss+xml" title="Latest PEPs" href="https://peps.python.org/peps.rss">
    <meta property="og:title" content='PEP 438 – Transitioning to release-file hosting on PyPI | peps.python.org'>
    <meta property="og:description" content="This PEP proposes a backward-compatible two-phase transition process to speed up, simplify and robustify installing from the pypi.python.org (PyPI) package index.  To ease the transition and minimize client-side friction, no changes to distutils or exis...">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://peps.python.org/pep-0438/">
    <meta property="og:site_name" content="Python Enhancement Proposals (PEPs)">
    <meta property="og:image" content="https://peps.python.org/_static/og-image.png">
    <meta property="og:image:alt" content="Python PEPs">
    <meta property="og:image:width" content="200">
    <meta property="og:image:height" content="200">
    <meta name="description" content="This PEP proposes a backward-compatible two-phase transition process to speed up, simplify and robustify installing from the pypi.python.org (PyPI) package index.  To ease the transition and minimize client-side friction, no changes to distutils or exis...">
    <meta name="theme-color" content="#3776ab">
</head>
<body>
    
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-sun-half" viewBox="0 0 24 24" pointer-events="all">
    <title>Following system colour scheme</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none"
         stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <circle cx="12" cy="12" r="9"></circle>
      <path d="M12 3v18m0-12l4.65-4.65M12 14.3l7.37-7.37M12 19.6l8.85-8.85"></path>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24" pointer-events="all">
    <title>Selected dark colour scheme</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none"
         stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z"></path>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24" pointer-events="all">
    <title>Selected light colour scheme</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none"
         stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
</svg>
    <script>

        document.documentElement.dataset.colour_scheme = localStorage.getItem("colour_scheme") || "auto"
    </script>
    <section id="pep-page-section">
        <header>
            <h1 data-pagefind-ignore>Python Enhancement Proposals</h1>
            <ul class="breadcrumbs">
                <li><a href="https://www.python.org/" title="The Python Programming Language">Python</a> &raquo; </li>
                <li><a href="../pep-0000/">PEP Index</a> &raquo; </li>
                <li>PEP 438</li>
            </ul>
            <button id="colour-scheme-cycler" onClick="setColourScheme(nextColourScheme())">
                <svg aria-hidden="true" class="colour-scheme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
                <svg aria-hidden="true" class="colour-scheme-icon-when-dark"><use href="#svg-moon"></use></svg>
                <svg aria-hidden="true" class="colour-scheme-icon-when-light"><use href="#svg-sun"></use></svg>
                <span class="visually-hidden">Toggle light / dark / auto colour theme</span>
            </button>
        </header>
        
        <div id="mobile-search" class="mobile-search-container"></div>
        
        <article data-pagefind-body>
            
            <span data-pagefind-meta="title:PEP 438 – Transitioning to release-file hosting on PyPI" data-pagefind-weight="10" class="visually-hidden">PEP 438 – Transitioning to release-file hosting on PyPI</span>
            <section id="pep-content">
<h1 class="page-title">PEP 438 – Transitioning to release-file hosting on PyPI</h1>
<dl class="rfc2822 field-list simple">
<dt class="field-odd">Author<span class="colon">:</span></dt>
<dd class="field-odd">Holger Krekel &lt;holger&#32;&#97;t&#32;merlinux.eu&gt;, Carl Meyer &lt;carl&#32;&#97;t&#32;oddbird.net&gt;</dd>
<dt class="field-even">BDFL-Delegate<span class="colon">:</span></dt>
<dd class="field-even">Richard Jones &lt;richard&#32;&#97;t&#32;python.org&gt;</dd>
<dt class="field-odd">Discussions-To<span class="colon">:</span></dt>
<dd class="field-odd"><a class="reference external" href="https://mail.python.org/archives/list/distutils-sig&#64;python.org/">Distutils-SIG list</a></dd>
<dt class="field-even">Status<span class="colon">:</span></dt>
<dd class="field-even"><abbr title="Replaced by another succeeding PEP">Superseded</abbr></dd>
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><abbr title="Normative PEP describing or proposing a change to a Python community process, workflow or governance">Process</abbr></dd>
<dt class="field-even">Topic<span class="colon">:</span></dt>
<dd class="field-even"><a class="reference external" href="../topic/packaging/">Packaging</a></dd>
<dt class="field-odd">Created<span class="colon">:</span></dt>
<dd class="field-odd">15-Mar-2013</dd>
<dt class="field-even">Post-History<span class="colon">:</span></dt>
<dd class="field-even">19-May-2013</dd>
<dt class="field-odd">Superseded-By<span class="colon">:</span></dt>
<dd class="field-odd"><a class="reference external" href="../pep-0470/">470</a></dd>
<dt class="field-even">Resolution<span class="colon">:</span></dt>
<dd class="field-even"><a class="reference external" href="https://mail.python.org/pipermail/distutils-sig/2013-May/020773.html">Distutils-SIG message</a></dd>
</dl>
<hr class="docutils" />
<section id="contents">
<details><summary>Table of Contents</summary><ul class="simple">
<li><a class="reference internal" href="#abstract">Abstract</a></li>
<li><a class="reference internal" href="#rationale">Rationale</a><ul>
<li><a class="reference internal" href="#history-and-motivations-for-external-hosting">History and motivations for external hosting</a></li>
<li><a class="reference internal" href="#problem">Problem</a></li>
<li><a class="reference internal" href="#goals">Goals</a></li>
</ul>
</li>
<li><a class="reference internal" href="#solution-two-transition-phases">Solution / two transition phases</a></li>
<li><a class="reference internal" href="#implementation">Implementation</a><ul>
<li><a class="reference internal" href="#hosting-modes">Hosting modes</a></li>
<li><a class="reference internal" href="#first-transition-phase-pypi">First transition phase (PyPI)</a></li>
<li><a class="reference internal" href="#second-transition-phase-installer-tools">Second transition phase (installer tools)</a></li>
<li><a class="reference internal" href="#api-for-submitting-external-distribution-urls">API For Submitting External Distribution URLs</a></li>
</ul>
</li>
<li><a class="reference internal" href="#references">References</a></li>
<li><a class="reference internal" href="#acknowledgments">Acknowledgments</a></li>
<li><a class="reference internal" href="#copyright">Copyright</a></li>
</ul>
</details></section>
<section id="abstract">
<h2><a class="toc-backref" href="#abstract" role="doc-backlink">Abstract</a></h2>
<p>This PEP proposes a backward-compatible two-phase transition process
to speed up, simplify and robustify installing from the
pypi.python.org (PyPI) package index.  To ease the transition and
minimize client-side friction, <strong>no changes to distutils or existing
installation tools are required in order to benefit from the first
transition phase, which will result in faster, more reliable installs
for most existing packages</strong>.</p>
<p>The first transition phase implements easy and explicit means for a
package maintainer to control which release file links are served to
present-day installation tools.  The first phase also includes the
implementation of analysis tools for present-day packages, to support
communication with package maintainers and the automated setting of
default modes for controlling release file links.  The first phase
also will default newly-registered projects on PyPI to only serve
links to release files which were uploaded to PyPI.</p>
<p>The second transition phase concerns end-user installation tools,
which shall default to only install release files that are hosted on
PyPI and tell the user if external release files exist, offering a
choice to automatically use those external files.  External release
files shall in the future be registered together with a checksum
hash so that installation tools can verify the integrity of the
eventual download (PyPI-hosted release files always carry such
a checksum).</p>
<p>Alternative PyPI server implementations should implement the new
simple index serving behaviour of transition phase 1 to avoid
installation tools treating their release links as external ones in
phase 2.</p>
</section>
<section id="rationale">
<h2><a class="toc-backref" href="#rationale" role="doc-backlink">Rationale</a></h2>
<section id="history-and-motivations-for-external-hosting">
<span id="history"></span><h3><a class="toc-backref" href="#history-and-motivations-for-external-hosting" role="doc-backlink">History and motivations for external hosting</a></h3>
<p>When PyPI went online, it offered release registration but had no
facility to host release files itself.  When hosting was added, no
automated downloading tool existed yet.  When Phillip Eby implemented
automated downloading (through setuptools), he made the choice to
allow people to use download hosts of their choice.  The finding of
externally-hosted packages was implemented as follows:</p>
<ol class="arabic simple">
<li>The PyPI <code class="docutils literal notranslate"><span class="pre">simple/</span></code> index for a package contains all links found
by scraping them from that package’s long_description metadata for
any release. Links in the “Download-URL” and “Home-page” metadata
fields are given <code class="docutils literal notranslate"><span class="pre">rel=download</span></code> and <code class="docutils literal notranslate"><span class="pre">rel=homepage</span></code> attributes,
respectively.</li>
<li>Any of these links whose target is a file whose name appears to be
in the form of an installable source or binary distribution, with
name in the form “packagename-version.ARCHIVEEXT”, is considered a
potential installation candidate by installation tools.</li>
<li>Similarly, any links suffixed with an “#egg=packagename-version”
fragment are considered an installation candidate.</li>
<li>Additionally, the <code class="docutils literal notranslate"><span class="pre">rel=homepage</span></code> and <code class="docutils literal notranslate"><span class="pre">rel=download</span></code> links are
crawled by installation tools and, if HTML, are themselves scraped
for release-file links in the above formats.</li>
</ol>
<p>See the easy_install documentation for a complete description of this
behavior. <a class="footnote-reference brackets" href="#id7" id="id1">[1]</a></p>
<p>Today, most packages indexed on PyPI host their release files on
PyPI. Out of 29,117 total projects on PyPI, only 2,581 (less than 10%)
include any links to installable files that are available only
off-PyPI. <a class="footnote-reference brackets" href="#id8" id="id2">[2]</a></p>
<p>There are many reasons <a class="footnote-reference brackets" href="#id9" id="id3">[3]</a> why people have chosen external
hosting. To cite just a few:</p>
<ul class="simple">
<li>release processes and scripts have been developed already and upload
to external sites</li>
<li>it takes too long to upload large files from some places in the
world</li>
<li>export restrictions e.g. for crypto-related software</li>
<li>company policies which require offering open source packages through
own sites</li>
<li>problems with integrating uploading to PyPI into one’s release
process (because of release policies)</li>
<li>desiring download statistics different from those maintained by PyPI</li>
<li>perceived bad reliability of PyPI</li>
<li>not aware that PyPI offers file-hosting</li>
</ul>
<p>Irrespective of the present-day validity of these reasons, there
clearly is a history why people choose to host files externally and it
even was for some time the only way you could do things.  This PEP
takes the position that there remain some valid reasons for
external hosting even today.</p>
</section>
<section id="problem">
<h3><a class="toc-backref" href="#problem" role="doc-backlink">Problem</a></h3>
<p><strong>Today, python package installers (pip, easy_install, buildout, and
others) often need to query many non-PyPI URLs even if there are no
externally hosted files</strong>.  Apart from querying pypi.python.org’s
simple index pages, also all homepages and download pages ever
specified with any release of a package are crawled by an installer.
The need for installers to crawl external sites slows down
installation and makes for a brittle and unreliable installation
process.  Those sites and packages also don’t take part in the
<a class="pep reference internal" href="../pep-0381/" title="PEP 381 – Mirroring infrastructure for PyPI">PEP 381</a> mirroring infrastructure, further decreasing reliability
and speed of automated installation processes around the world.</p>
<p>Most packages are hosted directly on pypi.python.org <a class="footnote-reference brackets" href="#id8" id="id4">[2]</a>.  Even for
these packages, installers still crawl their homepage and
download-url, if specified.  Many package uploaders are not aware that
specifying the “homepage” or “download-url” in their package metadata
will needlessly slow down the installation process for all users.</p>
<p>Relying on third party sites also opens up more attack vectors for
injecting malicious packages into sites using automated installs.  A
simple attack might just involve getting hold of an old now-unused
homepage domain and placing malicious packages there.  Moreover,
performing a Man-in-The-Middle (MITM) attack between an installation
site and any of the download sites can inject malicious packages on
the installation site.  As many homepages and download locations are
using HTTP and not HTTPS, such attacks are not hard to launch.  Such
MITM attacks can easily happen even for packages which never intended
to host files externally as their homepages are contacted by
installers anyway.</p>
<p>There is currently no way for package maintainers to avoid
external-link crawling, other than removing all homepage/download url
metadata for all historic releases.  While a script <a class="footnote-reference brackets" href="#id10" id="id5">[4]</a> has been
written to perform this action, it is not a good general solution
because it removes useful metadata from PyPI releases.</p>
<p>Even if the sites referenced by “Homepage” and “Download-URL” links
were not scraped for further links, there is no obvious way under the
current system for a package owner to link to an installable file from
a long_description metadata field (which is shown as package
documentation on <code class="docutils literal notranslate"><span class="pre">/pypi/PKG</span></code>) without installation tools
automatically considering that file a candidate for installation.
Conversely, there is no way to explicitly register multiple external
release files without putting them in metadata fields.</p>
</section>
<section id="goals">
<h3><a class="toc-backref" href="#goals" role="doc-backlink">Goals</a></h3>
<p>These are the goals to be achieved by implementation of this PEP:</p>
<ul class="simple">
<li>Package owners should be able to explicitly control which files are
presented by PyPI to installer tools as installation
candidates. Installation should not be slowed and made less reliable
by extensive and unnecessary crawling of links that package owners
did not explicitly nominate as installation files.</li>
<li>It should remain possible for package owners to choose to host their
release files on their own hosting, external to PyPI. It should be
easy for a user to request the installation of such releases using
automated installer tools, especially if the external release files
were registered together with a checksum hash.</li>
<li>Automated installer tools should not install externally-hosted
packages <strong>by default</strong>, but require explicit authorization to do so
by the user. When tools refuse to install such a package by default,
they should tell the user exactly which external link(s) the
installer needs to follow, and what option(s) the user can provide
to authorize the tool to follow those links. PyPI should provide all
necessary metadata for installer tools to implement this easily and
within a single request/reply interaction.</li>
<li>Migration from the status quo to the above points should be gradual
and minimize breakage. This includes tooling that makes it easy for
package owners with an existing release process that uploads to
non-PyPI hosting to also upload those release files to PyPI.</li>
</ul>
</section>
</section>
<section id="solution-two-transition-phases">
<h2><a class="toc-backref" href="#solution-two-transition-phases" role="doc-backlink">Solution / two transition phases</a></h2>
<p>The first transition phase introduces a “hosting-mode” field for each
project on PyPI, allowing package owners explicit control of which
release file links are served to present-day installation tools in the
machine-readable <code class="docutils literal notranslate"><span class="pre">simple/</span></code> index. The first transition will, after
successful hosting-mode manipulations by individual early-adopters,
set a default hosting mode for existing packages, based on automated
analysis.  <strong>Maintainers will be notified one month ahead of any such
automated change</strong>.  At completion of the first transition phase,
<strong>all present-day existing release and installation processes and
tools are expected to continue working</strong>.  Any remaining errors or
problems are expected to only relate to installation of individual
packages and can be easily corrected by package maintainers or PyPI
admins if maintainers are not reachable.</p>
<p>Also in the first phase, each link served in the <code class="docutils literal notranslate"><span class="pre">simple/</span></code> index
will be explicitly marked as <code class="docutils literal notranslate"><span class="pre">rel=&quot;internal&quot;</span></code> if it is hosted by the
index itself (even if on a separate domain, which may be the case if
the index uses a CDN for file-serving). Any link not so marked will be
considered an external link.</p>
<p>In the second transition phase, PyPI client installation tools shall
be updated to default to only install <code class="docutils literal notranslate"><span class="pre">rel=&quot;internal&quot;</span></code> packages
unless a user specifies option(s) to permit installing from external
links. See <a class="reference internal" href="#second-transition-phase">second transition phase</a> for details on how installers
should behave.</p>
<p>Maintainers of packages which currently host release files on non-PyPI
sites shall receive instructions and tools to ease “re-hosting” of
their historic and future package release files.  This re-hosting tool
MUST be available before automated hosting-mode changes are announced
to package maintainers.</p>
</section>
<section id="implementation">
<h2><a class="toc-backref" href="#implementation" role="doc-backlink">Implementation</a></h2>
<section id="hosting-modes">
<h3><a class="toc-backref" href="#hosting-modes" role="doc-backlink">Hosting modes</a></h3>
<p>The foundation of the first transition phase is the introduction of
three “modes” of PyPI hosting for a package, affecting which links are
generated for the <code class="docutils literal notranslate"><span class="pre">simple/</span></code> index.  These modes are implemented
without requiring changes to installation tools via changes to the
algorithm for generating the machine-readable <code class="docutils literal notranslate"><span class="pre">simple/</span></code> index.</p>
<p>The modes are:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">pypi-scrape-crawl</span></code>: no change from the current situation of
generating machine-readable links for installation tools, as
outlined in the <a class="reference internal" href="#history">history</a>.</li>
<li><code class="docutils literal notranslate"><span class="pre">pypi-scrape</span></code>: for a package in this mode, links to be added to
the <code class="docutils literal notranslate"><span class="pre">simple/</span></code> index are still scraped from package
metadata. However, the “Home-page” and “Download-url” links are
given <code class="docutils literal notranslate"><span class="pre">rel=ext-homepage</span></code> and <code class="docutils literal notranslate"><span class="pre">rel=ext-download</span></code> attributes
instead of <code class="docutils literal notranslate"><span class="pre">rel=homepage</span></code> and <code class="docutils literal notranslate"><span class="pre">rel=download</span></code>. The effect of this
(with no change in installation tools necessary) is that these links
will not be followed and scraped for further candidate links by
present-day installation tools: only installable files directly
hosted from PyPI or linked directly from PyPI metadata will be
considered for installation.  Installation tools MAY evolve to offer
an option to use the new rel-attribution to crawl external pages but
MUST NOT default to it.</li>
<li><code class="docutils literal notranslate"><span class="pre">pypi-explicit</span></code>: for a package in this mode, only links to release
files uploaded to PyPI, and external links to release files
explicitly nominated by the package owner, will be added to the
<code class="docutils literal notranslate"><span class="pre">simple/</span></code> index. PyPI will provide a new interface for package
owners to supply external release-file URLs. These URLs MUST include
a URL fragment in the form “#hashtype=hashvalue” specifying a hash
of the externally-linked file which installer tools MUST use to
validate that they have downloaded the intended file.</li>
</ul>
<p>Thus the hope is that eventually all projects on PyPI can be migrated
to the <code class="docutils literal notranslate"><span class="pre">pypi-explicit</span></code> mode, while preserving the ability to install
release files hosted externally via installer tools. Deprecation of
hosting modes to eventually only allow the <code class="docutils literal notranslate"><span class="pre">pypi-explicit</span></code> mode is
NOT REGULATED by this PEP but is expected to become feasible some time
after successful implementation of the transition phases described in
this PEP.  It is expected that deprecation requires <strong>a new process to
deal with abandoned packages</strong> because of unreachable maintainers for
still popular packages.</p>
</section>
<section id="first-transition-phase-pypi">
<h3><a class="toc-backref" href="#first-transition-phase-pypi" role="doc-backlink">First transition phase (PyPI)</a></h3>
<p>The proposed solution consists of multiple implementation and
communication steps:</p>
<ol class="arabic simple">
<li>Implement in PyPI the three modes described above, with an
interface for package owners to select the mode for each package
and register explicit external file URLs.</li>
<li>For packages in all modes, label links in the <code class="docutils literal notranslate"><span class="pre">simple/</span></code> index to
index-hosted files with <code class="docutils literal notranslate"><span class="pre">rel=&quot;internal&quot;</span></code>, to make it easier for
client tools to distinguish these links in the second phase.</li>
<li>Add an HTML tag <code class="docutils literal notranslate"><span class="pre">&lt;meta</span> <span class="pre">name=&quot;api-version&quot;</span> <span class="pre">value=&quot;2&quot;&gt;</span></code> to all
<code class="docutils literal notranslate"><span class="pre">simple/</span></code> index pages, to allow clients to distinguish between
indexes providing the <code class="docutils literal notranslate"><span class="pre">rel=&quot;internal&quot;</span></code> metadata and older ones
that do not.</li>
<li>Default all newly-registered packages to <code class="docutils literal notranslate"><span class="pre">pypi-explicit</span></code> mode
(package owners can still switch to the other modes as desired).</li>
<li>Determine (via automated analysis <a class="footnote-reference brackets" href="#id8" id="id6">[2]</a>) which packages have all
installable files available on PyPI itself (group A), which have
all installable files on PyPI or linked directly from PyPI metadata
(group B), and which have installable versions available that are
linked only from external homepage/download HTML pages (group C).</li>
<li>Send mail to maintainers of projects in group A that their project
will be automatically configured to <code class="docutils literal notranslate"><span class="pre">pypi-explicit</span></code> mode in one
month, and similarly to maintainers of projects in group B that
their project will be automatically configured to <code class="docutils literal notranslate"><span class="pre">pypi-scrape</span></code>
mode.  Inform them that this change is not expected to affect
installability of their project at all, but will result in faster
and safer installs for their users.  Encourage them to set this
mode themselves sooner to benefit their users.</li>
<li>Send mail to maintainers of packages in group C that their package
hosting mode is <code class="docutils literal notranslate"><span class="pre">pypi-scrape-crawl</span></code>, list the URLs which
currently are crawled, and suggest that they either re-host their
packages directly on PyPI and switch to <code class="docutils literal notranslate"><span class="pre">pypi-explicit</span></code>, or at
least provide direct links to release files in PyPI metadata and
switch to <code class="docutils literal notranslate"><span class="pre">pypi-scrape</span></code>.  Provide instructions and tools to help
with these transitions.</li>
</ol>
</section>
<section id="second-transition-phase-installer-tools">
<span id="second-transition-phase"></span><h3><a class="toc-backref" href="#second-transition-phase-installer-tools" role="doc-backlink">Second transition phase (installer tools)</a></h3>
<p>For the second transition phase, maintainers of installation tools are
asked to release two updates.</p>
<p>The first update shall provide clear warnings if externally-hosted
release files (that is, files whose link does not include
<code class="docutils literal notranslate"><span class="pre">rel=&quot;internal&quot;</span></code>) are selected for download, for which projects and
URLs exactly this happens, and warn that in future versions
externally-hosted downloads will be disabled by default.</p>
<p>The second update should change the default mode to allow only
installation of <code class="docutils literal notranslate"><span class="pre">rel=&quot;internal&quot;</span></code> package files, and allow
installation of externally-hosted packages only when the user supplies
an option.</p>
<p>The installer should distinguish between verifiable and non-verifiable
external links. A verifiable external link is a direct link to an
installable file from the PyPI <code class="docutils literal notranslate"><span class="pre">simple/</span></code> index that includes a hash
in the URL fragment (“#hashtype=hashvalue”) which can be used to
verify the integrity of the downloaded file. A non-verifiable external
link is any link (other than those explicitly supplied by the user of
an installer tool) without a hash, scraped from external HTML, or
injected into the search via some other non-PyPI source
(e.g. setuptools’ <code class="docutils literal notranslate"><span class="pre">dependency_links</span></code> feature).</p>
<p>Installers should provide a blanket option to allow
installing any verifiable external link. Non-verifiable external links
should only be installed if the user-provided option specifies exactly
which external domains can be used or for which specific package names
external links can be used.</p>
<p>When download of an externally-hosted package is disallowed by the
default configuration, the user should be notified, with instructions
for how to make the install succeed and warnings about the implication
(that a file will be downloaded from a site that is not part of the
package index). The warning given for non-verifiable links should
clearly state that the installer cannot verify the integrity of the
downloaded file. The warning given for verifiable external links
should simply note that the file will be downloaded from an external
URL, but that the file integrity can be verified by checksum.</p>
<p>Alternative PyPI-compatible index implementations should upgrade to
begin providing the <code class="docutils literal notranslate"><span class="pre">rel=&quot;internal&quot;</span></code> metadata and the <code class="docutils literal notranslate"><span class="pre">&lt;meta</span>
<span class="pre">name=&quot;api-version&quot;</span> <span class="pre">value=&quot;2&quot;&gt;</span></code> tag as soon as possible. For
alternative indexes which do not yet provide the meta tag in their
<code class="docutils literal notranslate"><span class="pre">simple/</span></code> pages, installation tools should provide
backwards-compatible fallback behavior (treat links as internal as in
pre-PEP times and provide a warning).</p>
</section>
<section id="api-for-submitting-external-distribution-urls">
<h3><a class="toc-backref" href="#api-for-submitting-external-distribution-urls" role="doc-backlink">API For Submitting External Distribution URLs</a></h3>
<p>New distribution URLs may be submitted by performing a HTTP POST to
the URL:</p>
<blockquote>
<div><a class="reference external" href="https://pypi.python.org/pypi">https://pypi.python.org/pypi</a></div></blockquote>
<p>With the following form-encoded data:</p>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td>Name</td>
<td>Value</td>
</tr>
<tr class="row-even"><td>:action</td>
<td>The string “urls”</td>
</tr>
<tr class="row-odd"><td>name</td>
<td>The package name as a string</td>
</tr>
<tr class="row-even"><td>version</td>
<td>The release version as a string</td>
</tr>
<tr class="row-odd"><td>new-url</td>
<td>The new URL to store</td>
</tr>
<tr class="row-even"><td>submit_new_url</td>
<td>The string “yes”</td>
</tr>
</tbody>
</table>
<p>The POST must be accompanied by an HTTP Basic Auth header encoding the
username and password of the user authorized to maintain the package
on PyPI.</p>
<p>The HTTP response to this request will be one of:</p>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td>Code</td>
<td>Meaning</td>
<td>URL submission implications</td>
</tr>
<tr class="row-even"><td>200</td>
<td>OK</td>
<td>Everything worked just fine</td>
</tr>
<tr class="row-odd"><td>400</td>
<td>Bad request</td>
<td>Data provided for submission was malformed</td>
</tr>
<tr class="row-even"><td>401</td>
<td>Unauthorised</td>
<td>The username or password supplied were incorrect</td>
</tr>
<tr class="row-odd"><td>403</td>
<td>Forbidden</td>
<td>User does not have permission to update the
package information (not Owner or Maintainer)</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="references">
<h2><a class="toc-backref" href="#references" role="doc-backlink">References</a></h2>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id7" role="doc-footnote">
<dt class="label" id="id7">[<a href="#id1">1</a>]</dt>
<dd>Phillip Eby, easy_install ‘Package Index “API”’ documentation,
<a class="reference external" href="http://peak.telecommunity.com/DevCenter/EasyInstall#package-index-api">http://peak.telecommunity.com/DevCenter/EasyInstall#package-index-api</a></aside>
<aside class="footnote brackets" id="id8" role="doc-footnote">
<dt class="label" id="id8">[2]<em> (<a href='#id2'>1</a>, <a href='#id4'>2</a>, <a href='#id6'>3</a>) </em></dt>
<dd>Donald Stufft, automated analysis of PyPI project links,
<a class="reference external" href="https://github.com/dstufft/pypi.linkcheck">https://github.com/dstufft/pypi.linkcheck</a></aside>
<aside class="footnote brackets" id="id9" role="doc-footnote">
<dt class="label" id="id9">[<a href="#id3">3</a>]</dt>
<dd>Marc-Andre Lemburg, reasons for external hosting,
<a class="reference external" href="https://mail.python.org/pipermail/catalog-sig/2013-March/005626.html">https://mail.python.org/pipermail/catalog-sig/2013-March/005626.html</a></aside>
<aside class="footnote brackets" id="id10" role="doc-footnote">
<dt class="label" id="id10">[<a href="#id5">4</a>]</dt>
<dd>Holger Krekel, script to remove homepage/download metadata for
all releases
<a class="reference external" href="https://mail.python.org/pipermail/catalog-sig/2013-February/005423.html">https://mail.python.org/pipermail/catalog-sig/2013-February/005423.html</a></aside>
</aside>
</section>
<section id="acknowledgments">
<h2><a class="toc-backref" href="#acknowledgments" role="doc-backlink">Acknowledgments</a></h2>
<p>Phillip Eby for precise information and the basic ideas to implement
the transition via server-side changes only.</p>
<p>Donald Stufft for pushing away from external hosting and offering to
implement both a Pull Request for the necessary PyPI changes and the
analysis tool to drive the transition phase 1.</p>
<p>Marc-Andre Lemburg, Alyssa Coghlan and catalog-sig in general for
thinking through issues regarding getting rid of “external hosting”.</p>
</section>
<section id="copyright">
<h2><a class="toc-backref" href="#copyright" role="doc-backlink">Copyright</a></h2>
<p>This document has been placed in the public domain.</p>
</section>
</section>
<hr class="docutils" />
<p>Source: <a class="reference external" href="https://github.com/python/peps/blob/main/peps/pep-0438.rst">https://github.com/python/peps/blob/main/peps/pep-0438.rst</a></p>
<p>Last modified: <a class="reference external" href="https://github.com/python/peps/commits/main/peps/pep-0438.rst">2025-02-01 08:59:27 GMT</a></p>

        </article>
        <nav id="pep-sidebar">
            <div id="search"></div>
            <h2>Contents</h2>
            <ul>
<li><a class="reference internal" href="#abstract">Abstract</a></li>
<li><a class="reference internal" href="#rationale">Rationale</a><ul>
<li><a class="reference internal" href="#history-and-motivations-for-external-hosting">History and motivations for external hosting</a></li>
<li><a class="reference internal" href="#problem">Problem</a></li>
<li><a class="reference internal" href="#goals">Goals</a></li>
</ul>
</li>
<li><a class="reference internal" href="#solution-two-transition-phases">Solution / two transition phases</a></li>
<li><a class="reference internal" href="#implementation">Implementation</a><ul>
<li><a class="reference internal" href="#hosting-modes">Hosting modes</a></li>
<li><a class="reference internal" href="#first-transition-phase-pypi">First transition phase (PyPI)</a></li>
<li><a class="reference internal" href="#second-transition-phase-installer-tools">Second transition phase (installer tools)</a></li>
<li><a class="reference internal" href="#api-for-submitting-external-distribution-urls">API For Submitting External Distribution URLs</a></li>
</ul>
</li>
<li><a class="reference internal" href="#references">References</a></li>
<li><a class="reference internal" href="#acknowledgments">Acknowledgments</a></li>
<li><a class="reference internal" href="#copyright">Copyright</a></li>
</ul>

            <br>
            <a id="source" href="https://github.com/python/peps/blob/main/peps/pep-0438.rst?plain=1">Page Source (GitHub)</a>
        </nav>
    </section>
    <script src="../_static/colour_scheme.js"></script>
    <script src="../_static/wrap_tables.js"></script>
    <script src="../_static/sticky_banner.js"></script>
    <script src="https://analytics.python.org/js/script.outbound-links.js"
            data-domain="peps.python.org" defer></script>
    <script src="/pagefind/pagefind-ui.js"></script>
    <script>
        window.addEventListener('DOMContentLoaded', (event) => {
            // Ranking configuration to boost exact title matches
            const searchOptions = {
                ranking: {
                    termSimilarity: 9.0, // Higher values favor exact matches
                    termFrequency: 0.5, // Lower values reduce penalty for low term frequency
                    pageLength: 0.2, // Lower values reduce the impact of page length
                }
            };

            // Initialize pagefind for either mobile or desktop, not both
            if (window.innerWidth <= 640) {
                new PagefindUI({ element: "#mobile-search", ...searchOptions, showSubResults: false });
            } else {
                new PagefindUI({ element: "#search", ...searchOptions, showSubResults: true });
            }
        });
    </script>
</body>
</html>