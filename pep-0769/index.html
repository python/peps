
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="color-scheme" content="light dark">
    <title>PEP 769 – Add a ‘default’ keyword argument to ‘attrgetter’, ‘itemgetter’ and ‘getitem’ | peps.python.org</title>
    <link rel="shortcut icon" href="../_static/py.png">
    <link rel="canonical" href="https://peps.python.org/pep-0769/">
    <link rel="stylesheet" href="../_static/style.css" type="text/css">
    <link rel="stylesheet" href="../_static/mq.css" type="text/css">
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" media="(prefers-color-scheme: light)" id="pyg-light">
    <link rel="stylesheet" href="../_static/pygments_dark.css" type="text/css" media="(prefers-color-scheme: dark)" id="pyg-dark">
    <link rel="alternate" type="application/rss+xml" title="Latest PEPs" href="https://peps.python.org/peps.rss">
    <meta property="og:title" content='PEP 769 – Add a ‘default’ keyword argument to ‘attrgetter’, ‘itemgetter’ and ‘getitem’ | peps.python.org'>
    <meta property="og:description" content="This proposal aims to enhance the operator module by adding a default keyword argument to the attrgetter, itemgetter and getitem functions. This addition would allow these functions to return a specified default value when the targeted attribute or item...">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://peps.python.org/pep-0769/">
    <meta property="og:site_name" content="Python Enhancement Proposals (PEPs)">
    <meta property="og:image" content="https://peps.python.org/_static/og-image.png">
    <meta property="og:image:alt" content="Python PEPs">
    <meta property="og:image:width" content="200">
    <meta property="og:image:height" content="200">
    <meta name="description" content="This proposal aims to enhance the operator module by adding a default keyword argument to the attrgetter, itemgetter and getitem functions. This addition would allow these functions to return a specified default value when the targeted attribute or item...">
    <meta name="theme-color" content="#3776ab">
</head>
<body>
    
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-sun-half" viewBox="0 0 24 24" pointer-events="all">
    <title>Following system colour scheme</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none"
         stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <circle cx="12" cy="12" r="9"></circle>
      <path d="M12 3v18m0-12l4.65-4.65M12 14.3l7.37-7.37M12 19.6l8.85-8.85"></path>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24" pointer-events="all">
    <title>Selected dark colour scheme</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none"
         stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z"></path>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24" pointer-events="all">
    <title>Selected light colour scheme</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none"
         stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
</svg>
    <script>

        document.documentElement.dataset.colour_scheme = localStorage.getItem("colour_scheme") || "auto"
    </script>
    <section id="pep-page-section">
        <header>
            <h1>Python Enhancement Proposals</h1>
            <ul class="breadcrumbs">
                <li><a href="https://www.python.org/" title="The Python Programming Language">Python</a> &raquo; </li>
                <li><a href="../pep-0000/">PEP Index</a> &raquo; </li>
                <li>PEP 769</li>
            </ul>
            <button id="colour-scheme-cycler" onClick="setColourScheme(nextColourScheme())">
                <svg aria-hidden="true" class="colour-scheme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
                <svg aria-hidden="true" class="colour-scheme-icon-when-dark"><use href="#svg-moon"></use></svg>
                <svg aria-hidden="true" class="colour-scheme-icon-when-light"><use href="#svg-sun"></use></svg>
                <span class="visually-hidden">Toggle light / dark / auto colour theme</span>
            </button>
        </header>
        <article>
            <section id="pep-content">
<h1 class="page-title">PEP 769 – Add a ‘default’ keyword argument to ‘attrgetter’, ‘itemgetter’ and ‘getitem’</h1>
<dl class="rfc2822 field-list simple">
<dt class="field-odd">Author<span class="colon">:</span></dt>
<dd class="field-odd">Facundo Batista &lt;facundo&#32;&#97;t&#32;taniquetil.com.ar&gt;</dd>
<dt class="field-even">Discussions-To<span class="colon">:</span></dt>
<dd class="field-even"><a class="reference external" href="https://discuss.python.org/t/76419">Discourse thread</a></dd>
<dt class="field-odd">Status<span class="colon">:</span></dt>
<dd class="field-odd"><abbr title="Formally declined and will not be accepted">Rejected</abbr></dd>
<dt class="field-even">Type<span class="colon">:</span></dt>
<dd class="field-even"><abbr title="Normative PEP with a new feature for Python, implementation change for CPython or interoperability standard for the ecosystem">Standards Track</abbr></dd>
<dt class="field-odd">Created<span class="colon">:</span></dt>
<dd class="field-odd">22-Dec-2024</dd>
<dt class="field-even">Python-Version<span class="colon">:</span></dt>
<dd class="field-even">3.14</dd>
<dt class="field-odd">Post-History<span class="colon">:</span></dt>
<dd class="field-odd"><a class="reference external" href="https://discuss.python.org/t/76419" title="Discourse thread">07-Jan-2025</a></dd>
<dt class="field-even">Resolution<span class="colon">:</span></dt>
<dd class="field-even"><a class="reference external" href="https://discuss.python.org/t/76419/32">14-Mar-2025</a></dd>
</dl>
<hr class="docutils" />
<section id="contents">
<details><summary>Table of Contents</summary><ul class="simple">
<li><a class="reference internal" href="#abstract">Abstract</a></li>
<li><a class="reference internal" href="#motivation">Motivation</a></li>
<li><a class="reference internal" href="#rationale">Rationale</a></li>
<li><a class="reference internal" href="#specification">Specification</a><ul>
<li><a class="reference internal" href="#examples-for-attrgetter">Examples for attrgetter</a></li>
<li><a class="reference internal" href="#examples-for-itemgetter">Examples for itemgetter</a></li>
<li><a class="reference internal" href="#examples-for-getitem">Examples for getitem</a></li>
<li><a class="reference internal" href="#about-possible-implementations">About Possible Implementations</a></li>
<li><a class="reference internal" href="#corner-cases">Corner Cases</a></li>
</ul>
</li>
<li><a class="reference internal" href="#rejected-ideas">Rejected Ideas</a><ul>
<li><a class="reference internal" href="#multiple-default-values">Multiple Default Values</a></li>
<li><a class="reference internal" href="#tuple-return-consistency">Tuple Return Consistency</a></li>
</ul>
</li>
<li><a class="reference internal" href="#open-issues">Open Issues</a></li>
<li><a class="reference internal" href="#how-to-teach-this">How to Teach This</a></li>
<li><a class="reference internal" href="#backwards-compatibility">Backwards Compatibility</a></li>
<li><a class="reference internal" href="#security-implications">Security Implications</a></li>
<li><a class="reference internal" href="#copyright">Copyright</a></li>
</ul>
</details></section>
<section id="abstract">
<h2><a class="toc-backref" href="#abstract" role="doc-backlink">Abstract</a></h2>
<p>This proposal aims to enhance the <a class="reference external" href="https://docs.python.org/3/library/operator.html#module-operator" title="(in Python v3.14)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">operator</span></code></a> module by adding a
<code class="docutils literal notranslate"><span class="pre">default</span></code> keyword argument to the <code class="docutils literal notranslate"><span class="pre">attrgetter</span></code>, <code class="docutils literal notranslate"><span class="pre">itemgetter</span></code> and
<code class="docutils literal notranslate"><span class="pre">getitem</span></code> functions. This addition would allow these functions to return a
specified default value when the targeted attribute or item is missing,
thereby preventing exceptions and simplifying code that handles optional
attributes or items.</p>
</section>
<section id="motivation">
<h2><a class="toc-backref" href="#motivation" role="doc-backlink">Motivation</a></h2>
<p>Currently, <code class="docutils literal notranslate"><span class="pre">attrgetter</span></code> and <code class="docutils literal notranslate"><span class="pre">itemgetter</span></code> raise exceptions if the
specified attribute or item is absent. This limitation requires
developers to implement additional error handling, leading to more
complex and less readable code.</p>
<p>Introducing a <code class="docutils literal notranslate"><span class="pre">default</span></code> parameter would streamline operations involving
optional attributes or items, reducing boilerplate code and enhancing
code clarity.</p>
<p>A similar situation occurs with <code class="docutils literal notranslate"><span class="pre">getitem</span></code>, with the added nuance that
allowing the specification of a default value in this case would resolve
a longstanding asymmetry with the <a class="reference external" href="https://docs.python.org/3/library/functions.html#getattr" title="(in Python v3.14)"><code class="xref py py-func docutils literal notranslate"><span class="pre">getattr()</span></code></a> built-in function.</p>
</section>
<section id="rationale">
<h2><a class="toc-backref" href="#rationale" role="doc-backlink">Rationale</a></h2>
<p>The primary design decision is to introduce a single <code class="docutils literal notranslate"><span class="pre">default</span></code> parameter
applicable to all specified attributes or items.</p>
<p>This approach maintains simplicity and avoids the complexity of assigning
individual default values to multiple attributes or items. While some
discussions considered allowing multiple defaults, the increased
complexity and potential for confusion led to favoring a single default
value for all cases (more about this below in <a class="reference internal" href="#pep-769-rejected-ideas">Rejected Ideas</a>).</p>
</section>
<section id="specification">
<h2><a class="toc-backref" href="#specification" role="doc-backlink">Specification</a></h2>
<p>Proposed behaviors:</p>
<ul class="simple">
<li><strong>attrgetter</strong>: <code class="docutils literal notranslate"><span class="pre">f</span> <span class="pre">=</span> <span class="pre">attrgetter(&quot;name&quot;,</span> <span class="pre">default=XYZ)</span></code> followed by
<code class="docutils literal notranslate"><span class="pre">f(obj)</span></code> would return <code class="docutils literal notranslate"><span class="pre">obj.name</span></code> if the attribute exists, else
<code class="docutils literal notranslate"><span class="pre">XYZ</span></code>.</li>
<li><strong>itemgetter</strong>: <code class="docutils literal notranslate"><span class="pre">f</span> <span class="pre">=</span> <span class="pre">itemgetter(2,</span> <span class="pre">default=XYZ)</span></code> followed by
<code class="docutils literal notranslate"><span class="pre">f(obj)</span></code> would return <code class="docutils literal notranslate"><span class="pre">obj[2]</span></code> if that is valid, else <code class="docutils literal notranslate"><span class="pre">XYZ</span></code>.</li>
<li><strong>getitem</strong>: <code class="docutils literal notranslate"><span class="pre">getitem(obj,</span> <span class="pre">k,</span> <span class="pre">XYZ)</span></code> or
<code class="docutils literal notranslate"><span class="pre">getitem(obj,</span> <span class="pre">k,</span> <span class="pre">default=XYZ)</span></code> would return <code class="docutils literal notranslate"><span class="pre">obj[k]</span></code> if that is valid,
else <code class="docutils literal notranslate"><span class="pre">XYZ</span></code>.</li>
</ul>
<p>In the first two cases, the enhancement applies to single and multiple
attribute/item retrievals, with the default value returned for any
missing attribute or item.</p>
<p>No functionality change is incorporated in any case if the extra
default (keyword) argument is not used.</p>
<section id="examples-for-attrgetter">
<h3><a class="toc-backref" href="#examples-for-attrgetter" role="doc-backlink">Examples for attrgetter</a></h3>
<p>The current behavior is unchanged:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span><span class="w"> </span><span class="nc">C</span><span class="p">:</span>
<span class="gp">... </span>  <span class="k">class</span><span class="w"> </span><span class="nc">D</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">class</span><span class="w"> </span><span class="nc">X</span><span class="p">:</span>
<span class="gp">... </span>      <span class="k">pass</span>
<span class="gp">... </span>  <span class="k">class</span><span class="w"> </span><span class="nc">E</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">pass</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attrgetter</span><span class="p">(</span><span class="s2">&quot;D&quot;</span><span class="p">)(</span><span class="n">C</span><span class="p">)</span>
<span class="go">&lt;class &#39;__main__.C.D&#39;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attrgetter</span><span class="p">(</span><span class="s2">&quot;badname&quot;</span><span class="p">)(</span><span class="n">C</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
  File <span class="nb">&quot;&lt;stdin&gt;&quot;</span>, line <span class="m">1</span>, in <span class="n">&lt;module&gt;</span>
<span class="gr">AttributeError</span>: <span class="n">type object &#39;C&#39; has no attribute &#39;badname&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attrgetter</span><span class="p">(</span><span class="s2">&quot;D&quot;</span><span class="p">,</span> <span class="s2">&quot;E&quot;</span><span class="p">)(</span><span class="n">C</span><span class="p">)</span>
<span class="go">(&lt;class &#39;__main__.C.D&#39;&gt;, &lt;class &#39;__main__.C.E&#39;&gt;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attrgetter</span><span class="p">(</span><span class="s2">&quot;D&quot;</span><span class="p">,</span> <span class="s2">&quot;badname&quot;</span><span class="p">)(</span><span class="n">C</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
  File <span class="nb">&quot;&lt;stdin&gt;&quot;</span>, line <span class="m">1</span>, in <span class="n">&lt;module&gt;</span>
<span class="gr">AttributeError</span>: <span class="n">type object &#39;C&#39; has no attribute &#39;badname&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attrgetter</span><span class="p">(</span><span class="s2">&quot;D.X&quot;</span><span class="p">)(</span><span class="n">C</span><span class="p">)</span>
<span class="go">&lt;class &#39;__main__.C.D.X&#39;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attrgetter</span><span class="p">(</span><span class="s2">&quot;D.badname&quot;</span><span class="p">)(</span><span class="n">C</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
  File <span class="nb">&quot;&lt;stdin&gt;&quot;</span>, line <span class="m">1</span>, in <span class="n">&lt;module&gt;</span>
<span class="gr">AttributeError</span>: <span class="n">type object &#39;D&#39; has no attribute &#39;badname&#39;</span>
</pre></div>
</div>
<p>With this PEP, using the proposed <code class="docutils literal notranslate"><span class="pre">default</span></code> keyword:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">attrgetter</span><span class="p">(</span><span class="s2">&quot;D&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;noclass&quot;</span><span class="p">)(</span><span class="n">C</span><span class="p">)</span>
<span class="go">&lt;class &#39;__main__.C.D&#39;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attrgetter</span><span class="p">(</span><span class="s2">&quot;badname&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;noclass&quot;</span><span class="p">)(</span><span class="n">C</span><span class="p">)</span>
<span class="go">&#39;noclass&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attrgetter</span><span class="p">(</span><span class="s2">&quot;D&quot;</span><span class="p">,</span> <span class="s2">&quot;E&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;noclass&quot;</span><span class="p">)(</span><span class="n">C</span><span class="p">)</span>
<span class="go">(&lt;class &#39;__main__.C.D&#39;&gt;, &lt;class &#39;__main__.C.E&#39;&gt;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attrgetter</span><span class="p">(</span><span class="s2">&quot;D&quot;</span><span class="p">,</span> <span class="s2">&quot;badname&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;noclass&quot;</span><span class="p">)(</span><span class="n">C</span><span class="p">)</span>
<span class="go">(&lt;class &#39;__main__.C.D&#39;&gt;, &#39;noclass&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attrgetter</span><span class="p">(</span><span class="s2">&quot;D.X&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;noclass&quot;</span><span class="p">)(</span><span class="n">C</span><span class="p">)</span>
<span class="go">&lt;class &#39;__main__.C.D.X&#39;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attrgetter</span><span class="p">(</span><span class="s2">&quot;D.badname&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;noclass&quot;</span><span class="p">)(</span><span class="n">C</span><span class="p">)</span>
<span class="go">&#39;noclass&#39;</span>
</pre></div>
</div>
</section>
<section id="examples-for-itemgetter">
<h3><a class="toc-backref" href="#examples-for-itemgetter" role="doc-backlink">Examples for itemgetter</a></h3>
<p>The current behavior is unchanged:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">obj</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;foo&quot;</span><span class="p">,</span> <span class="s2">&quot;bar&quot;</span><span class="p">,</span> <span class="s2">&quot;baz&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">itemgetter</span><span class="p">(</span><span class="mi">1</span><span class="p">)(</span><span class="n">obj</span><span class="p">)</span>
<span class="go">&#39;bar&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">itemgetter</span><span class="p">(</span><span class="mi">5</span><span class="p">)(</span><span class="n">obj</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
  File <span class="nb">&quot;&lt;stdin&gt;&quot;</span>, line <span class="m">1</span>, in <span class="n">&lt;module&gt;</span>
<span class="gr">IndexError</span>: <span class="n">list index out of range</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">itemgetter</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)(</span><span class="n">obj</span><span class="p">)</span>
<span class="go">(&#39;bar&#39;, &#39;foo&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">itemgetter</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">)(</span><span class="n">obj</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
  File <span class="nb">&quot;&lt;stdin&gt;&quot;</span>, line <span class="m">1</span>, in <span class="n">&lt;module&gt;</span>
<span class="gr">IndexError</span>: <span class="n">list index out of range</span>
</pre></div>
</div>
<p>With this PEP, using the proposed <code class="docutils literal notranslate"><span class="pre">default</span></code> keyword:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">itemgetter</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;XYZ&quot;</span><span class="p">)(</span><span class="n">obj</span><span class="p">)</span>
<span class="go">&#39;bar&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">itemgetter</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;XYZ&quot;</span><span class="p">)(</span><span class="n">obj</span><span class="p">)</span>
<span class="go">&#39;XYZ&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">itemgetter</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;XYZ&quot;</span><span class="p">)(</span><span class="n">obj</span><span class="p">)</span>
<span class="go">(&#39;bar&#39;, &#39;foo&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">itemgetter</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;XYZ&quot;</span><span class="p">)(</span><span class="n">obj</span><span class="p">)</span>
<span class="go">(&#39;bar&#39;, &#39;XYZ&#39;)</span>
</pre></div>
</div>
</section>
<section id="examples-for-getitem">
<h3><a class="toc-backref" href="#examples-for-getitem" role="doc-backlink">Examples for getitem</a></h3>
<p>The current behavior is unchanged:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">obj</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;foo&quot;</span><span class="p">,</span> <span class="s2">&quot;bar&quot;</span><span class="p">,</span> <span class="s2">&quot;baz&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">getitem</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">&#39;bar&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">getitem</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
  File <span class="nb">&quot;&lt;stdin&gt;&quot;</span>, line <span class="m">1</span>, in <span class="n">&lt;module&gt;</span>
<span class="gr">IndexError</span>: <span class="n">list index out of range</span>
</pre></div>
</div>
<p>With this PEP, using the proposed extra default, positionally or with
a keyword:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">getitem</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;XYZ&quot;</span><span class="p">)</span>
<span class="go">&#39;bar&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">getitem</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="s2">&quot;XYZ&quot;</span><span class="p">)</span>
<span class="go">&#39;XYZ&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">getitem</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;XYZ&quot;</span><span class="p">)</span>
<span class="go">&#39;bar&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">getitem</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;XYZ&quot;</span><span class="p">)</span>
<span class="go">&#39;XYZ&#39;</span>
</pre></div>
</div>
</section>
<section id="about-possible-implementations">
<h3><a class="toc-backref" href="#about-possible-implementations" role="doc-backlink">About Possible Implementations</a></h3>
<p>The implementation of <code class="docutils literal notranslate"><span class="pre">attrgetter</span></code> is quite direct: it implies using
<code class="docutils literal notranslate"><span class="pre">getattr</span></code> and catching a possible <code class="docutils literal notranslate"><span class="pre">AttributeError</span></code>. So
<code class="docutils literal notranslate"><span class="pre">attrgetter(&quot;name&quot;,</span> <span class="pre">default=XYZ)(obj)</span></code> would be like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
    <span class="n">value</span> <span class="o">=</span> <span class="n">XYZ</span>
</pre></div>
</div>
<p>Note we cannot rely on using <code class="docutils literal notranslate"><span class="pre">getattr</span></code> with a default value, as it would
be impossible to distinguish what it returned on each step when an
attribute chain is specified (e.g.
<code class="docutils literal notranslate"><span class="pre">attrgetter(&quot;foo.bar.baz&quot;,</span> <span class="pre">default=XYZ)</span></code>).</p>
<p>The implementation for <code class="docutils literal notranslate"><span class="pre">itemgetter</span></code> and <code class="docutils literal notranslate"><span class="pre">getitem</span></code> is not that
easy. The more straightforward way is also simple to define and
understand: attempting <code class="docutils literal notranslate"><span class="pre">__getitem__</span></code> and catching a possible
exception (see below). This way, <code class="docutils literal notranslate"><span class="pre">itemgetter(123,</span> <span class="pre">default=XYZ)(obj)</span></code>
or <code class="docutils literal notranslate"><span class="pre">getitem(obj,</span> <span class="pre">123,</span> <span class="pre">default=XYZ)</span></code> would be equivalent to:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="n">value</span> <span class="o">=</span> <span class="n">obj</span><span class="p">[</span><span class="mi">123</span><span class="p">]</span>
<span class="k">except</span> <span class="p">(</span><span class="ne">IndexError</span><span class="p">,</span> <span class="ne">KeyError</span><span class="p">):</span>
    <span class="n">value</span> <span class="o">=</span> <span class="n">XYZ</span>
</pre></div>
</div>
<p>However, for performance reasons the implementation may look more
like the following, which has the same exact behavior:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span> <span class="o">==</span> <span class="nb">dict</span><span class="p">:</span>
    <span class="n">value</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="mi">123</span><span class="p">,</span> <span class="n">XYZ</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">obj</span><span class="p">[</span><span class="mi">123</span><span class="p">]</span>
    <span class="k">except</span> <span class="p">(</span><span class="ne">IndexError</span><span class="p">,</span> <span class="ne">KeyError</span><span class="p">):</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">XYZ</span>
</pre></div>
</div>
<p>Note how the verification is about the exact type and not using
<code class="docutils literal notranslate"><span class="pre">isinstance</span></code>; this is to ensure the exact behavior, which would be
impossible if the object is a user defined one that inherits <code class="docutils literal notranslate"><span class="pre">dict</span></code>
but overwrites <code class="docutils literal notranslate"><span class="pre">get</span></code> (similar reason to not check if the object has
a <code class="docutils literal notranslate"><span class="pre">get</span></code> method).</p>
<p>This way, performance is better but it’s just an implementation detail,
so we can keep the original explanation on how it behaves.</p>
<p>Regarding the exception to be captured, even if <code class="docutils literal notranslate"><span class="pre">__getitem__</span></code>
can raise <code class="docutils literal notranslate"><span class="pre">IndexError</span></code>, <code class="docutils literal notranslate"><span class="pre">KeyError</span></code>, or <code class="docutils literal notranslate"><span class="pre">TypeError</span></code> (see its
<a class="reference external" href="https://docs.python.org/3/reference/datamodel.html#object.__getitem__">reference</a>), only the first two can happen if the container does not
contain the indicated key or index, and the latter is likely to signal
a bug in the code, so we’re not capturing it to trigger the default
behavior.</p>
</section>
<section id="corner-cases">
<h3><a class="toc-backref" href="#corner-cases" role="doc-backlink">Corner Cases</a></h3>
<p>Providing a <code class="docutils literal notranslate"><span class="pre">default</span></code> option would only work if accessing the
item/attribute would fail in the normal case. In other words, the
object accessed should not handle defaults itself.</p>
<p>For example, the following would be redundant/confusing because
<code class="docutils literal notranslate"><span class="pre">defaultdict</span></code> will never error out when accessing the item:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">collections</span><span class="w"> </span><span class="kn">import</span> <span class="n">defaultdict</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">operator</span><span class="w"> </span><span class="kn">import</span> <span class="n">itemgetter</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dd</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">itemgetter</span><span class="p">(</span><span class="s2">&quot;foo&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=-</span><span class="mi">1</span><span class="p">)(</span><span class="n">dd</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
<p>The same applies to any user defined object that overloads <code class="docutils literal notranslate"><span class="pre">__getitem__</span></code>
or <code class="docutils literal notranslate"><span class="pre">__getattr__</span></code> implementing its own fallbacks.</p>
</section>
</section>
<section id="rejected-ideas">
<span id="pep-769-rejected-ideas"></span><h2><a class="toc-backref" href="#rejected-ideas" role="doc-backlink">Rejected Ideas</a></h2>
<section id="multiple-default-values">
<h3><a class="toc-backref" href="#multiple-default-values" role="doc-backlink">Multiple Default Values</a></h3>
<p>The idea of allowing multiple default values for multiple attributes or
items was considered.</p>
<p>Two alternatives were discussed, using an iterable that must have the
same quantity of items as parameters given to
<code class="docutils literal notranslate"><span class="pre">attrgetter</span></code>/<code class="docutils literal notranslate"><span class="pre">itemgetter</span></code>, or using a dictionary with keys matching
those names passed to <code class="docutils literal notranslate"><span class="pre">attrgetter</span></code>/<code class="docutils literal notranslate"><span class="pre">itemgetter</span></code>.</p>
<p>The really complex thing to solve here (making the
feature hard to explain and with confusing corner cases), is what would happen
if an iterable or dictionary is the <em>actual</em> default desired for all
items. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">itemgetter</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))({})</span>
<span class="go">(1, 2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">itemgetter</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))({})</span>
<span class="go">((1, 2), (1, 2))</span>
</pre></div>
</div>
<p>If we allow “multiple default values” using <code class="docutils literal notranslate"><span class="pre">default</span></code>, the first case
in the example above would raise an exception because there are more items
than names in the default, and the second case would return <code class="docutils literal notranslate"><span class="pre">(1,</span> <span class="pre">2))</span></code>. This is
why we considered the possibility of using a different name for multiple
defaults (e.g. <code class="docutils literal notranslate"><span class="pre">defaults</span></code>, which is expressive but maybe error prone because
it is too similar to <code class="docutils literal notranslate"><span class="pre">default</span></code>).</p>
<p>Another proposal that would enable multiple defaults, is allowing
combinations of <code class="docutils literal notranslate"><span class="pre">attrgetter</span></code> and <code class="docutils literal notranslate"><span class="pre">itemgetter</span></code>, e.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ig_a</span> <span class="o">=</span> <span class="n">itemgetter</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ig_b</span> <span class="o">=</span> <span class="n">itemgetter</span><span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ig_combined</span> <span class="o">=</span> <span class="n">itemgetter</span><span class="p">(</span><span class="n">ig_a</span><span class="p">,</span> <span class="n">ig_b</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ig_combined</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="mi">999</span><span class="p">})</span>
<span class="go">(999, 2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ig_combined</span><span class="p">({})</span>
<span class="go">(1, 2)</span>
</pre></div>
</div>
<p>However, combining <code class="docutils literal notranslate"><span class="pre">itemgetter</span></code> or <code class="docutils literal notranslate"><span class="pre">attrgetter</span></code> is totally new
behavior and very complex to define.  While not impossible, it is beyond
the scope of this PEP.</p>
<p>In the end, having multiple default values was deemed overly complex and
potentially confusing, and a single <code class="docutils literal notranslate"><span class="pre">default</span></code> parameter was favored for
simplicity and predictability.</p>
</section>
<section id="tuple-return-consistency">
<h3><a class="toc-backref" href="#tuple-return-consistency" role="doc-backlink">Tuple Return Consistency</a></h3>
<p>Another rejected proposal was adding a flag to always return a tuple
regardless of how many keys/names/indices were given.
E.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">letters</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">itemgetter</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">return_tuple</span><span class="o">=</span><span class="kc">True</span><span class="p">)(</span><span class="n">letters</span><span class="p">)</span>
<span class="go">(&#39;b&#39;,)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">itemgetter</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">return_tuple</span><span class="o">=</span><span class="kc">True</span><span class="p">)(</span><span class="n">letters</span><span class="p">)</span>
<span class="go">(&#39;b&#39;, &#39;c&#39;)</span>
</pre></div>
</div>
<p>This would be of little help for multiple default values consistency,
requiring further discussion, and is out of the scope of this
PEP.</p>
</section>
</section>
<section id="open-issues">
<span id="pep-769-open-issues"></span><h2><a class="toc-backref" href="#open-issues" role="doc-backlink">Open Issues</a></h2>
<p>There are no open issues at this time.</p>
</section>
<section id="how-to-teach-this">
<h2><a class="toc-backref" href="#how-to-teach-this" role="doc-backlink">How to Teach This</a></h2>
<p>As the basic behavior is not modified, this new <code class="docutils literal notranslate"><span class="pre">default</span></code> can be
avoided when teaching <code class="docutils literal notranslate"><span class="pre">attrgetter</span></code> and <code class="docutils literal notranslate"><span class="pre">itemgetter</span></code> for the first
time. It can be introduced only when the functionality is needed.</p>
</section>
<section id="backwards-compatibility">
<h2><a class="toc-backref" href="#backwards-compatibility" role="doc-backlink">Backwards Compatibility</a></h2>
<p>The proposed changes are backward-compatible. The <code class="docutils literal notranslate"><span class="pre">default</span></code> parameter
is optional; existing code without this parameter will function as
before. Only code that explicitly uses the new <code class="docutils literal notranslate"><span class="pre">default</span></code> parameter will
exhibit the new behavior, ensuring no disruption to current
implementations.</p>
</section>
<section id="security-implications">
<h2><a class="toc-backref" href="#security-implications" role="doc-backlink">Security Implications</a></h2>
<p>Introducing a <code class="docutils literal notranslate"><span class="pre">default</span></code> parameter does not inherently introduce
security vulnerabilities.</p>
</section>
<section id="copyright">
<h2><a class="toc-backref" href="#copyright" role="doc-backlink">Copyright</a></h2>
<p>This document is placed in the public domain or under the
CC0-1.0-Universal license, whichever is more permissive.</p>
</section>
</section>
<hr class="docutils" />
<p>Source: <a class="reference external" href="https://github.com/python/peps/blob/main/peps/pep-0769.rst">https://github.com/python/peps/blob/main/peps/pep-0769.rst</a></p>
<p>Last modified: <a class="reference external" href="https://github.com/python/peps/commits/main/peps/pep-0769.rst">2025-05-26 08:01:11 GMT</a></p>

        </article>
        <nav id="pep-sidebar">
            <h2>Contents</h2>
            <ul>
<li><a class="reference internal" href="#abstract">Abstract</a></li>
<li><a class="reference internal" href="#motivation">Motivation</a></li>
<li><a class="reference internal" href="#rationale">Rationale</a></li>
<li><a class="reference internal" href="#specification">Specification</a><ul>
<li><a class="reference internal" href="#examples-for-attrgetter">Examples for attrgetter</a></li>
<li><a class="reference internal" href="#examples-for-itemgetter">Examples for itemgetter</a></li>
<li><a class="reference internal" href="#examples-for-getitem">Examples for getitem</a></li>
<li><a class="reference internal" href="#about-possible-implementations">About Possible Implementations</a></li>
<li><a class="reference internal" href="#corner-cases">Corner Cases</a></li>
</ul>
</li>
<li><a class="reference internal" href="#rejected-ideas">Rejected Ideas</a><ul>
<li><a class="reference internal" href="#multiple-default-values">Multiple Default Values</a></li>
<li><a class="reference internal" href="#tuple-return-consistency">Tuple Return Consistency</a></li>
</ul>
</li>
<li><a class="reference internal" href="#open-issues">Open Issues</a></li>
<li><a class="reference internal" href="#how-to-teach-this">How to Teach This</a></li>
<li><a class="reference internal" href="#backwards-compatibility">Backwards Compatibility</a></li>
<li><a class="reference internal" href="#security-implications">Security Implications</a></li>
<li><a class="reference internal" href="#copyright">Copyright</a></li>
</ul>

            <br>
            <a id="source" href="https://github.com/python/peps/blob/main/peps/pep-0769.rst?plain=1">Page Source (GitHub)</a>
        </nav>
    </section>
    <script src="../_static/colour_scheme.js"></script>
    <script src="../_static/wrap_tables.js"></script>
    <script src="../_static/sticky_banner.js"></script>
    <script src="https://analytics.python.org/js/script.outbound-links.js"
            data-domain="peps.python.org" defer></script>
</body>
</html>