
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="color-scheme" content="light dark">
    <title>PEP 775 – Make zlib required to build CPython | peps.python.org</title>
    <link rel="shortcut icon" href="../_static/py.png">
    <link rel="canonical" href="https://peps.python.org/pep-0775/">
    <link rel="stylesheet" href="../_static/style.css" type="text/css">
    <link rel="stylesheet" href="../_static/mq.css" type="text/css">
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" media="(prefers-color-scheme: light)" id="pyg-light">
    <link rel="stylesheet" href="../_static/pygments_dark.css" type="text/css" media="(prefers-color-scheme: dark)" id="pyg-dark">
    <link rel="alternate" type="application/rss+xml" title="Latest PEPs" href="https://peps.python.org/peps.rss">
    <meta property="og:title" content='PEP 775 – Make zlib required to build CPython | peps.python.org'>
    <meta property="og:description" content="Building CPython without the zlib compression library will no be longer supported, and the zlib module will be required in the standard library. The only exception is WASI, as zlib is not currently supported in CPython on WASI. Building the interpreter ...">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://peps.python.org/pep-0775/">
    <meta property="og:site_name" content="Python Enhancement Proposals (PEPs)">
    <meta property="og:image" content="https://peps.python.org/_static/og-image.png">
    <meta property="og:image:alt" content="Python PEPs">
    <meta property="og:image:width" content="200">
    <meta property="og:image:height" content="200">
    <meta name="description" content="Building CPython without the zlib compression library will no be longer supported, and the zlib module will be required in the standard library. The only exception is WASI, as zlib is not currently supported in CPython on WASI. Building the interpreter ...">
    <meta name="theme-color" content="#3776ab">
</head>
<body>
    
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-sun-half" viewBox="0 0 24 24" pointer-events="all">
    <title>Following system colour scheme</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none"
         stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <circle cx="12" cy="12" r="9"></circle>
      <path d="M12 3v18m0-12l4.65-4.65M12 14.3l7.37-7.37M12 19.6l8.85-8.85"></path>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24" pointer-events="all">
    <title>Selected dark colour scheme</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none"
         stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z"></path>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24" pointer-events="all">
    <title>Selected light colour scheme</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none"
         stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
</svg>
    <script>

        document.documentElement.dataset.colour_scheme = localStorage.getItem("colour_scheme") || "auto"
    </script>
    <section id="pep-page-section">
        <header>
            <h1 data-pagefind-ignore>Python Enhancement Proposals</h1>
            <ul class="breadcrumbs">
                <li><a href="https://www.python.org/" title="The Python Programming Language">Python</a> &raquo; </li>
                <li><a href="../pep-0000/">PEP Index</a> &raquo; </li>
                <li>PEP 775</li>
            </ul>
            <button id="colour-scheme-cycler" onClick="setColourScheme(nextColourScheme())">
                <svg aria-hidden="true" class="colour-scheme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
                <svg aria-hidden="true" class="colour-scheme-icon-when-dark"><use href="#svg-moon"></use></svg>
                <svg aria-hidden="true" class="colour-scheme-icon-when-light"><use href="#svg-sun"></use></svg>
                <span class="visually-hidden">Toggle light / dark / auto colour theme</span>
            </button>
        </header>
        
        <div id="mobile-search" class="mobile-search-container"></div>
        
        <article data-pagefind-body>
            
            <span data-pagefind-meta="title:PEP 775 – Make zlib required to build CPython" data-pagefind-weight="10" class="visually-hidden">PEP 775 – Make zlib required to build CPython</span>
            <section id="pep-content">
<h1 class="page-title">PEP 775 – Make zlib required to build CPython</h1>
<dl class="rfc2822 field-list simple">
<dt class="field-odd">Author<span class="colon">:</span></dt>
<dd class="field-odd">Gregory P. Smith &lt;greg&#32;&#97;t&#32;krypto.org&gt;,
Stan Ulbrych &lt;stanulbrych&#32;&#97;t&#32;gmail.com&gt;,
Petr Viktorin &lt;encukou&#32;&#97;t&#32;gmail.com&gt;</dd>
<dt class="field-even">Discussions-To<span class="colon">:</span></dt>
<dd class="field-even"><a class="reference external" href="https://discuss.python.org/t/82672">Discourse thread</a></dd>
<dt class="field-odd">Status<span class="colon">:</span></dt>
<dd class="field-odd"><abbr title="Removed from consideration by sponsor or authors">Withdrawn</abbr></dd>
<dt class="field-even">Type<span class="colon">:</span></dt>
<dd class="field-even"><abbr title="Normative PEP with a new feature for Python, implementation change for CPython or interoperability standard for the ecosystem">Standards Track</abbr></dd>
<dt class="field-odd">Created<span class="colon">:</span></dt>
<dd class="field-odd">24-Feb-2025</dd>
<dt class="field-even">Python-Version<span class="colon">:</span></dt>
<dd class="field-even">3.14</dd>
<dt class="field-odd">Post-History<span class="colon">:</span></dt>
<dd class="field-odd"><a class="reference external" href="https://discuss.python.org/t/23062" title="Discourse thread">23-Jan-2023</a>,
<a class="reference external" href="https://discuss.python.org/t/82672" title="Discourse thread">01-Mar-2025</a></dd>
</dl>
<hr class="docutils" />
<section id="contents">
<details><summary>Table of Contents</summary><ul class="simple">
<li><a class="reference internal" href="#abstract">Abstract</a></li>
<li><a class="reference internal" href="#pep-withdrawal">PEP Withdrawal</a></li>
<li><a class="reference internal" href="#motivation">Motivation</a></li>
<li><a class="reference internal" href="#rationale">Rationale</a></li>
<li><a class="reference internal" href="#specification">Specification</a></li>
<li><a class="reference internal" href="#backwards-compatibility">Backwards Compatibility</a></li>
<li><a class="reference internal" href="#security-implications">Security Implications</a></li>
<li><a class="reference internal" href="#how-to-teach-this">How to Teach This</a></li>
<li><a class="reference internal" href="#reference-implementation">Reference Implementation</a></li>
<li><a class="reference internal" href="#future-work">Future work</a></li>
<li><a class="reference internal" href="#copyright">Copyright</a></li>
</ul>
</details></section>
<section id="abstract">
<h2><a class="toc-backref" href="#abstract" role="doc-backlink">Abstract</a></h2>
<p>Building CPython without the <a class="reference external" href="https://zlib.net">zlib</a> compression library
will no be longer supported, and the <a class="reference external" href="https://docs.python.org/3/library/zlib.html#module-zlib" title="(in Python v3.14)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">zlib</span></code></a> module will be required in
the standard library.
The only exception is <a class="reference external" href="https://wasi.dev">WASI</a>, as zlib is not currently
supported in CPython on WASI.
Building the interpreter without zlib may still be possible,
but formally unsupported.</p>
</section>
<section id="pep-withdrawal">
<h2><a class="toc-backref" href="#pep-withdrawal" role="doc-backlink">PEP Withdrawal</a></h2>
<p>This PEP was withdrawn by the authors on 2025-05-07. After further reflection,
we realized it did not provide sufficient value and was met with significant
negative feedback, particularly regarding the proposed exception for WASI.</p>
</section>
<section id="motivation">
<h2><a class="toc-backref" href="#motivation" role="doc-backlink">Motivation</a></h2>
<p>The zlib library, which powers the <code class="xref py py-mod docutils literal notranslate"><span class="pre">zlib</span></code> Python module,
is available on all supported systems except WASI.</p>
<p>Many wheels on PyPI, including the <a class="extlink-pypi reference external" href="https://pypi.org/project/pip/">pip</a> installer, require zlib.
Users of pip would consider CPython without zlib to be broken,
but mostly don’t notice because all major builds of CPython include zlib.</p>
<p>CPython developers don’t really notice either. It turns out that at the time
of writing, at least one CPython test fails without zlib (the “skip”
decorator in <code class="docutils literal notranslate"><span class="pre">test_peg_generator.test_c_parser</span></code> is applied too late),
but our CI didn’t catch this.</p>
<p>This PEP treats this as an issue in documentation and messaging.
In practice, we already don’t support building CPython without zlib; we
should just say so.</p>
</section>
<section id="rationale">
<h2><a class="toc-backref" href="#rationale" role="doc-backlink">Rationale</a></h2>
<p>There are possible use cases for zlib-less builds, such as embedding and
bootstrapping, as well as unforeseen ones.
Therefore, we don’t <em>remove</em> support for zlib-less systems; we mark them
unsupported and invite affected users to do their own testing, or to share
use cases that can make us reconsider this decision.</p>
<p>zlib is not yet used by default on the WASI platform – mostly because
adding it hasn’t yet been a priority there. (Note that <a class="reference external" href="https://pyodide.org">Pyodide</a>, the main
“real-world” CPython distribution for WASI, does include zlib.)
We take this as an opportunity to  continue testing a platform without
zlib, so that we don’t unintentionally break unsupported builds yet.</p>
</section>
<section id="specification">
<h2><a class="toc-backref" href="#specification" role="doc-backlink">Specification</a></h2>
<p>In standard library modules that use zlib for optional functionality,
that functionality will raise <code class="docutils literal notranslate"><span class="pre">ImportError</span></code> when used.
Code to generate more “friendly” error messages, or to pre-check whether
zlib is available, will be removed.
All functionality unrelated to zlib will still be usable if zlib is
missing.</p>
<p>This affects the following modules, and more that depend on these
transitively:</p>
<ul class="simple">
<li><a class="reference external" href="https://docs.python.org/3/library/shutil.html#module-shutil" title="(in Python v3.14)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">shutil</span></code></a> (<code class="docutils literal notranslate"><span class="pre">gztar</span></code> and <code class="docutils literal notranslate"><span class="pre">zip</span></code> archive formats)</li>
<li><a class="reference external" href="https://docs.python.org/3/library/tarfile.html#module-tarfile" title="(in Python v3.14)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">tarfile</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/zipfile.html#module-zipfile" title="(in Python v3.14)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">zipfile</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/zipimport.html#module-zipimport" title="(in Python v3.14)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">zipimport</span></code></a>,
<a class="reference external" href="https://docs.python.org/3/library/zipapp.html#module-zipapp" title="(in Python v3.14)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">zipapp</span></code></a> (archive compression)</li>
<li><a class="reference external" href="https://docs.python.org/3/library/codecs.html#module-codecs" title="(in Python v3.14)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">codecs</span></code></a> (<code class="docutils literal notranslate"><span class="pre">zlib_codec</span></code>)</li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">shutil.get_archive_formats()</span></code> will always include <code class="docutils literal notranslate"><span class="pre">zip</span></code> and <code class="docutils literal notranslate"><span class="pre">gztar</span></code>
as registered formats, even if they are unusable due to missing zlib.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">configure</span></code> script will issue a warning when zlib is not found on
platforms other than WASI.</p>
<p><code class="docutils literal notranslate"><span class="pre">test_zlib</span></code> will fail on platforms other than WASI.
All other tests will continue to be skipped – that is, uses of
<code class="docutils literal notranslate"><span class="pre">&#64;test.support.requires_zlib</span></code> will be kept in place – for the benefit
of WASI, unsupported builds, and any possible reverts.</p>
<p><a class="pep reference internal" href="../pep-0011/" title="PEP 11 – CPython platform support">PEP 11</a> will be adjusted to mark “Systems without zlib, except WASI” as
unsupported.</p>
</section>
<section id="backwards-compatibility">
<h2><a class="toc-backref" href="#backwards-compatibility" role="doc-backlink">Backwards Compatibility</a></h2>
<p>In practice, nothing major changes, except in error cases – for example,
attempts to use tar compression without zlib available will raise
<code class="docutils literal notranslate"><span class="pre">ImportError</span></code> and not <code class="docutils literal notranslate"><span class="pre">CompressionError</span></code>.</p>
</section>
<section id="security-implications">
<h2><a class="toc-backref" href="#security-implications" role="doc-backlink">Security Implications</a></h2>
<p>None known.</p>
</section>
<section id="how-to-teach-this">
<h2><a class="toc-backref" href="#how-to-teach-this" role="doc-backlink">How to Teach This</a></h2>
<p>We don’t expect that any instructions will need to change, as zlib is
already available in all relevant contexts.</p>
</section>
<section id="reference-implementation">
<h2><a class="toc-backref" href="#reference-implementation" role="doc-backlink">Reference Implementation</a></h2>
<p>A reference implementation may be found in a pull request to the CPython
repository, <a class="reference external" href="https://github.com/python/cpython/pull/130297">python/cpython#130297</a></p>
</section>
<section id="future-work">
<h2><a class="toc-backref" href="#future-work" role="doc-backlink">Future work</a></h2>
<p>In the future, if no use cases for zlib-less builds are found,
zlib may be made fully required.
The main changes needed for that would be making the <code class="docutils literal notranslate"><span class="pre">configure</span></code> script
raise a hard error, and removing <code class="docutils literal notranslate"><span class="pre">&#64;test.support.requires_zlib</span></code>.</p>
</section>
<section id="copyright">
<h2><a class="toc-backref" href="#copyright" role="doc-backlink">Copyright</a></h2>
<p>This document is placed in the public domain or under the
CC0-1.0-Universal license, whichever is more permissive.</p>
</section>
</section>
<hr class="docutils" />
<p>Source: <a class="reference external" href="https://github.com/python/peps/blob/main/peps/pep-0775.rst">https://github.com/python/peps/blob/main/peps/pep-0775.rst</a></p>
<p>Last modified: <a class="reference external" href="https://github.com/python/peps/commits/main/peps/pep-0775.rst">2025-05-09 13:52:32 GMT</a></p>

        </article>
        <nav id="pep-sidebar">
            <div id="search"></div>
            <h2>Contents</h2>
            <ul>
<li><a class="reference internal" href="#abstract">Abstract</a></li>
<li><a class="reference internal" href="#pep-withdrawal">PEP Withdrawal</a></li>
<li><a class="reference internal" href="#motivation">Motivation</a></li>
<li><a class="reference internal" href="#rationale">Rationale</a></li>
<li><a class="reference internal" href="#specification">Specification</a></li>
<li><a class="reference internal" href="#backwards-compatibility">Backwards Compatibility</a></li>
<li><a class="reference internal" href="#security-implications">Security Implications</a></li>
<li><a class="reference internal" href="#how-to-teach-this">How to Teach This</a></li>
<li><a class="reference internal" href="#reference-implementation">Reference Implementation</a></li>
<li><a class="reference internal" href="#future-work">Future work</a></li>
<li><a class="reference internal" href="#copyright">Copyright</a></li>
</ul>

            <br>
            <a id="source" href="https://github.com/python/peps/blob/main/peps/pep-0775.rst?plain=1">Page Source (GitHub)</a>
        </nav>
    </section>
    <script src="../_static/colour_scheme.js"></script>
    <script src="../_static/wrap_tables.js"></script>
    <script src="../_static/sticky_banner.js"></script>
    <script src="https://analytics.python.org/js/script.outbound-links.js"
            data-domain="peps.python.org" defer></script>
    <script src="/pagefind/pagefind-ui.js"></script>
    <script>
        window.addEventListener('DOMContentLoaded', (event) => {
            // Ranking configuration to boost exact title matches
            const searchOptions = {
                ranking: {
                    termSimilarity: 9.0, // Higher values favor exact matches
                    termFrequency: 0.5, // Lower values reduce penalty for low term frequency
                    pageLength: 0.2, // Lower values reduce the impact of page length
                }
            };

            // Initialize pagefind for either mobile or desktop, not both
            if (window.innerWidth <= 640) {
                new PagefindUI({ element: "#mobile-search", ...searchOptions, showSubResults: false });
            } else {
                new PagefindUI({ element: "#search", ...searchOptions, showSubResults: true });
            }
        });
    </script>
</body>
</html>