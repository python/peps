
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="color-scheme" content="light dark">
    <title>PEP 409 – Suppressing exception context | peps.python.org</title>
    <link rel="shortcut icon" href="../_static/py.png">
    <link rel="canonical" href="https://peps.python.org/pep-0409/">
    <link rel="stylesheet" href="../_static/style.css" type="text/css">
    <link rel="stylesheet" href="../_static/mq.css" type="text/css">
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" media="(prefers-color-scheme: light)" id="pyg-light">
    <link rel="stylesheet" href="../_static/pygments_dark.css" type="text/css" media="(prefers-color-scheme: dark)" id="pyg-dark">
    <link rel="alternate" type="application/rss+xml" title="Latest PEPs" href="https://peps.python.org/peps.rss">
    <meta property="og:title" content='PEP 409 – Suppressing exception context | peps.python.org'>
    <meta property="og:description" content="One of the open issues from PEP 3134 is suppressing context:  currently there is no way to do it.  This PEP proposes one.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://peps.python.org/pep-0409/">
    <meta property="og:site_name" content="Python Enhancement Proposals (PEPs)">
    <meta property="og:image" content="https://peps.python.org/_static/og-image.png">
    <meta property="og:image:alt" content="Python PEPs">
    <meta property="og:image:width" content="200">
    <meta property="og:image:height" content="200">
    <meta name="description" content="One of the open issues from PEP 3134 is suppressing context:  currently there is no way to do it.  This PEP proposes one.">
    <meta name="theme-color" content="#3776ab">
</head>
<body>
    
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-sun-half" viewBox="0 0 24 24" pointer-events="all">
    <title>Following system colour scheme</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none"
         stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <circle cx="12" cy="12" r="9"></circle>
      <path d="M12 3v18m0-12l4.65-4.65M12 14.3l7.37-7.37M12 19.6l8.85-8.85"></path>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24" pointer-events="all">
    <title>Selected dark colour scheme</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none"
         stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z"></path>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24" pointer-events="all">
    <title>Selected light colour scheme</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none"
         stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
</svg>
    <script>

        document.documentElement.dataset.colour_scheme = localStorage.getItem("colour_scheme") || "auto"
    </script>
    <section id="pep-page-section">
        <header>
            <h1>Python Enhancement Proposals</h1>
            <ul class="breadcrumbs">
                <li><a href="https://www.python.org/" title="The Python Programming Language">Python</a> &raquo; </li>
                <li><a href="../pep-0000/">PEP Index</a> &raquo; </li>
                <li>PEP 409</li>
            </ul>
            <button id="colour-scheme-cycler" onClick="setColourScheme(nextColourScheme())">
                <svg aria-hidden="true" class="colour-scheme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
                <svg aria-hidden="true" class="colour-scheme-icon-when-dark"><use href="#svg-moon"></use></svg>
                <svg aria-hidden="true" class="colour-scheme-icon-when-light"><use href="#svg-sun"></use></svg>
                <span class="visually-hidden">Toggle light / dark / auto colour theme</span>
            </button>
        </header>
        <article>
            <section id="pep-content">
<h1 class="page-title">PEP 409 – Suppressing exception context</h1>
<dl class="rfc2822 field-list simple">
<dt class="field-odd">Author<span class="colon">:</span></dt>
<dd class="field-odd">Ethan Furman &lt;ethan&#32;&#97;t&#32;stoneleaf.us&gt;</dd>
<dt class="field-even">Status<span class="colon">:</span></dt>
<dd class="field-even"><abbr title="Accepted and implementation complete, or no longer active">Final</abbr></dd>
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><abbr title="Normative PEP with a new feature for Python, implementation change for CPython or interoperability standard for the ecosystem">Standards Track</abbr></dd>
<dt class="field-even">Created<span class="colon">:</span></dt>
<dd class="field-even">26-Jan-2012</dd>
<dt class="field-odd">Python-Version<span class="colon">:</span></dt>
<dd class="field-odd">3.3</dd>
<dt class="field-even">Post-History<span class="colon">:</span></dt>
<dd class="field-even">30-Aug-2002, 01-Feb-2012, 03-Feb-2012</dd>
<dt class="field-odd">Superseded-By<span class="colon">:</span></dt>
<dd class="field-odd"><a class="reference external" href="../pep-0415/">415</a></dd>
<dt class="field-even">Resolution<span class="colon">:</span></dt>
<dd class="field-even"><a class="reference external" href="https://mail.python.org/pipermail/python-dev/2012-February/116136.html">Python-Dev message</a></dd>
</dl>
<hr class="docutils" />
<section id="contents">
<details><summary>Table of Contents</summary><ul class="simple">
<li><a class="reference internal" href="#abstract">Abstract</a></li>
<li><a class="reference internal" href="#rationale">Rationale</a></li>
<li><a class="reference internal" href="#alternatives">Alternatives</a></li>
<li><a class="reference internal" href="#proposal">Proposal</a></li>
<li><a class="reference internal" href="#implementation-discussion">Implementation Discussion</a></li>
<li><a class="reference internal" href="#language-details">Language Details</a></li>
<li><a class="reference internal" href="#patches">Patches</a></li>
<li><a class="reference internal" href="#references">References</a></li>
<li><a class="reference internal" href="#copyright">Copyright</a></li>
</ul>
</details></section>
<section id="abstract">
<h2><a class="toc-backref" href="#abstract" role="doc-backlink">Abstract</a></h2>
<p>One of the open issues from <a class="pep reference internal" href="../pep-3134/" title="PEP 3134 – Exception Chaining and Embedded Tracebacks">PEP 3134</a> is suppressing context:  currently
there is no way to do it.  This PEP proposes one.</p>
</section>
<section id="rationale">
<h2><a class="toc-backref" href="#rationale" role="doc-backlink">Rationale</a></h2>
<p>There are two basic ways to generate exceptions:</p>
<ol class="arabic simple">
<li>Python does it (buggy code, missing resources, ending loops, etc.)</li>
<li>manually (with a raise statement)</li>
</ol>
<p>When writing libraries, or even just custom classes, it can become
necessary to raise exceptions; moreover it can be useful, even
necessary, to change from one exception to another.  To take an example
from my dbf module:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="n">value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
    <span class="k">raise</span> <span class="n">DbfError</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
</pre></div>
</div>
<p>Whatever the original exception was (<code class="docutils literal notranslate"><span class="pre">ValueError</span></code>, <code class="docutils literal notranslate"><span class="pre">TypeError</span></code>, or
something else) is irrelevant.  The exception from this point on is a
<code class="docutils literal notranslate"><span class="pre">DbfError</span></code>, and the original exception is of no value.  However, if
this exception is printed, we would currently see both.</p>
</section>
<section id="alternatives">
<h2><a class="toc-backref" href="#alternatives" role="doc-backlink">Alternatives</a></h2>
<p>Several possibilities have been put forth:</p>
<ul>
<li><code class="docutils literal notranslate"><span class="pre">raise</span> <span class="pre">as</span> <span class="pre">NewException()</span></code><p>Reuses the <code class="docutils literal notranslate"><span class="pre">as</span></code> keyword; can be confusing since we are not really
reraising the originating exception</p>
</li>
<li><code class="docutils literal notranslate"><span class="pre">raise</span> <span class="pre">NewException()</span> <span class="pre">from</span> <span class="pre">None</span></code><p>Follows existing syntax of explicitly declaring the originating
exception</p>
</li>
<li><code class="docutils literal notranslate"><span class="pre">exc</span> <span class="pre">=</span> <span class="pre">NewException();</span> <span class="pre">exc.__context__</span> <span class="pre">=</span> <span class="pre">None;</span> <span class="pre">raise</span> <span class="pre">exc</span></code><p>Very verbose way of the previous method</p>
</li>
<li><code class="docutils literal notranslate"><span class="pre">raise</span> <span class="pre">NewException.no_context(...)</span></code><p>Make context suppression a class method.</p>
</li>
</ul>
<p>All of the above options will require changes to the core.</p>
</section>
<section id="proposal">
<h2><a class="toc-backref" href="#proposal" role="doc-backlink">Proposal</a></h2>
<p>I propose going with the second option:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">raise</span> <span class="n">NewException</span> <span class="kn">from</span><span class="w"> </span><span class="kc">None</span>
</pre></div>
</div>
<p>It has the advantage of using the existing pattern of explicitly setting
the cause:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">raise</span> <span class="ne">KeyError</span><span class="p">()</span> <span class="kn">from</span><span class="w"> </span><span class="nn">NameError</span><span class="p">()</span>
</pre></div>
</div>
<p>but because the cause is <code class="docutils literal notranslate"><span class="pre">None</span></code> the previous context is not displayed
by the default exception printing routines.</p>
</section>
<section id="implementation-discussion">
<h2><a class="toc-backref" href="#implementation-discussion" role="doc-backlink">Implementation Discussion</a></h2>
<p>Note: after acceptance of this PEP, a cleaner implementation mechanism
was proposed and accepted in <a class="pep reference internal" href="../pep-0415/" title="PEP 415 – Implement context suppression with exception attributes">PEP 415</a>. Refer to that PEP for more
details on the implementation actually used in Python 3.3.</p>
<p>Currently, <code class="docutils literal notranslate"><span class="pre">None</span></code> is the default for both <code class="docutils literal notranslate"><span class="pre">__context__</span></code> and <code class="docutils literal notranslate"><span class="pre">__cause__</span></code>.
In order to support <code class="docutils literal notranslate"><span class="pre">raise</span> <span class="pre">...</span> <span class="pre">from</span> <span class="pre">None</span></code> (which would set <code class="docutils literal notranslate"><span class="pre">__cause__</span></code> to
<code class="docutils literal notranslate"><span class="pre">None</span></code>) we need a different default value for <code class="docutils literal notranslate"><span class="pre">__cause__</span></code>.  Several ideas
were put forth on how to implement this at the language level:</p>
<ul>
<li>Overwrite the previous exception information (side-stepping the issue and
leaving <code class="docutils literal notranslate"><span class="pre">__cause__</span></code> at <code class="docutils literal notranslate"><span class="pre">None</span></code>).<p>Rejected as this can seriously hinder debugging due to
<a class="reference external" href="http://bugs.python.org/msg152294">poor error messages</a>.</p>
</li>
<li>Use one of the boolean values in <code class="docutils literal notranslate"><span class="pre">__cause__</span></code>:  <code class="docutils literal notranslate"><span class="pre">False</span></code> would be the
default value, and would be replaced when <code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">...</span></code> was used with the
explicitly chained exception or <code class="docutils literal notranslate"><span class="pre">None</span></code>.<p>Rejected as this encourages the use of two different objects types for
<code class="docutils literal notranslate"><span class="pre">__cause__</span></code> with one of them (boolean) not allowed to have the full range
of possible values (<code class="docutils literal notranslate"><span class="pre">True</span></code> would never be used).</p>
</li>
<li>Create a special exception class, <code class="docutils literal notranslate"><span class="pre">__NoException__</span></code>.<p>Rejected as possibly confusing, possibly being mistakenly raised by users,
and not being a truly unique value as <code class="docutils literal notranslate"><span class="pre">None</span></code>, <code class="docutils literal notranslate"><span class="pre">True</span></code>, and <code class="docutils literal notranslate"><span class="pre">False</span></code> are.</p>
</li>
<li>Use <code class="docutils literal notranslate"><span class="pre">Ellipsis</span></code> as the default value (the <code class="docutils literal notranslate"><span class="pre">...</span></code> singleton).<p>Accepted.</p>
<p>Ellipses are commonly used in English as place holders when words are
omitted.  This works in our favor here as a signal that <code class="docutils literal notranslate"><span class="pre">__cause__</span></code> is
omitted, so look in <code class="docutils literal notranslate"><span class="pre">__context__</span></code> for more details.</p>
<p>Ellipsis is not an exception, so cannot be raised.</p>
<p>There is only one Ellipsis, so no unused values.</p>
<p>Error information is not thrown away, so custom code can trace the entire
exception chain even if the default code does not.</p>
</li>
</ul>
</section>
<section id="language-details">
<h2><a class="toc-backref" href="#language-details" role="doc-backlink">Language Details</a></h2>
<p>To support <code class="docutils literal notranslate"><span class="pre">raise</span> <span class="pre">Exception</span> <span class="pre">from</span> <span class="pre">None</span></code>, <code class="docutils literal notranslate"><span class="pre">__context__</span></code> will stay as it is,
but <code class="docutils literal notranslate"><span class="pre">__cause__</span></code> will start out as <code class="docutils literal notranslate"><span class="pre">Ellipsis</span></code> and will change to <code class="docutils literal notranslate"><span class="pre">None</span></code>
when the <code class="docutils literal notranslate"><span class="pre">raise</span> <span class="pre">Exception</span> <span class="pre">from</span> <span class="pre">None</span></code> method is used.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head">form</th>
<th class="head">__context__</th>
<th class="head">__cause__</th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td>raise</td>
<td><code class="docutils literal notranslate"><span class="pre">None</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">Ellipsis</span></code></td>
</tr>
<tr class="row-odd"><td>reraise</td>
<td>previous exception</td>
<td><code class="docutils literal notranslate"><span class="pre">Ellipsis</span></code></td>
</tr>
<tr class="row-even"><td>reraise from <code class="docutils literal notranslate"><span class="pre">None</span></code> | <code class="docutils literal notranslate"><span class="pre">ChainedException</span></code></td>
<td>previous exception</td>
<td><code class="docutils literal notranslate"><span class="pre">None</span></code> | explicitly chained exception</td>
</tr>
</tbody>
</table>
<p>The default exception printing routine will then:</p>
<ul class="simple">
<li>If <code class="docutils literal notranslate"><span class="pre">__cause__</span></code> is <code class="docutils literal notranslate"><span class="pre">Ellipsis</span></code> the <code class="docutils literal notranslate"><span class="pre">__context__</span></code> (if any) will be
printed.</li>
<li>If <code class="docutils literal notranslate"><span class="pre">__cause__</span></code> is <code class="docutils literal notranslate"><span class="pre">None</span></code> the <code class="docutils literal notranslate"><span class="pre">__context__</span></code> will not be printed.</li>
<li>if <code class="docutils literal notranslate"><span class="pre">__cause__</span></code> is anything else, <code class="docutils literal notranslate"><span class="pre">__cause__</span></code> will be printed.</li>
</ul>
<p>In both of the latter cases the exception chain will stop being followed.</p>
<p>Because the default value for <code class="docutils literal notranslate"><span class="pre">__cause__</span></code> is now <code class="docutils literal notranslate"><span class="pre">Ellipsis</span></code> and <code class="docutils literal notranslate"><span class="pre">raise</span>
<span class="pre">Exception</span> <span class="pre">from</span> <span class="pre">Cause</span></code> is simply syntactic sugar for:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">_exc</span> <span class="o">=</span> <span class="n">NewException</span><span class="p">()</span>
<span class="n">_exc</span><span class="o">.</span><span class="n">__cause__</span> <span class="o">=</span> <span class="n">Cause</span><span class="p">()</span>
<span class="k">raise</span> <span class="n">_exc</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">Ellipsis</span></code>, as well as <code class="docutils literal notranslate"><span class="pre">None</span></code>, is now allowed as a cause:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">raise</span> <span class="ne">Exception</span> <span class="kn">from</span><span class="w"> </span><span class="nn">Ellipsis</span>
</pre></div>
</div>
</section>
<section id="patches">
<h2><a class="toc-backref" href="#patches" role="doc-backlink">Patches</a></h2>
<p>There is a patch for CPython implementing this attached to <a class="reference external" href="http://bugs.python.org/issue6210">Issue 6210</a>.</p>
</section>
<section id="references">
<h2><a class="toc-backref" href="#references" role="doc-backlink">References</a></h2>
<p>Discussion and refinements in this <a class="reference external" href="https://mail.python.org/pipermail/python-dev/2012-January/115838.html">thread on python-dev</a>.</p>
</section>
<section id="copyright">
<h2><a class="toc-backref" href="#copyright" role="doc-backlink">Copyright</a></h2>
<p>This document has been placed in the public domain.</p>
</section>
</section>
<hr class="docutils" />
<p>Source: <a class="reference external" href="https://github.com/python/peps/blob/main/peps/pep-0409.rst">https://github.com/python/peps/blob/main/peps/pep-0409.rst</a></p>
<p>Last modified: <a class="reference external" href="https://github.com/python/peps/commits/main/peps/pep-0409.rst">2025-02-01 08:59:27 GMT</a></p>

        </article>
        <nav id="pep-sidebar">
            <h2>Contents</h2>
            <ul>
<li><a class="reference internal" href="#abstract">Abstract</a></li>
<li><a class="reference internal" href="#rationale">Rationale</a></li>
<li><a class="reference internal" href="#alternatives">Alternatives</a></li>
<li><a class="reference internal" href="#proposal">Proposal</a></li>
<li><a class="reference internal" href="#implementation-discussion">Implementation Discussion</a></li>
<li><a class="reference internal" href="#language-details">Language Details</a></li>
<li><a class="reference internal" href="#patches">Patches</a></li>
<li><a class="reference internal" href="#references">References</a></li>
<li><a class="reference internal" href="#copyright">Copyright</a></li>
</ul>

            <br>
            <a id="source" href="https://github.com/python/peps/blob/main/peps/pep-0409.rst?plain=1">Page Source (GitHub)</a>
        </nav>
    </section>
    <script src="../_static/colour_scheme.js"></script>
    <script src="../_static/wrap_tables.js"></script>
    <script src="../_static/sticky_banner.js"></script>
    <script src="https://analytics.python.org/js/script.outbound-links.js"
            data-domain="peps.python.org" defer></script>
</body>
</html>