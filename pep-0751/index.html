
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="color-scheme" content="light dark">
    <title>PEP 751 – A file format to record Python dependencies for installation reproducibility | peps.python.org</title>
    <link rel="shortcut icon" href="../_static/py.png">
    <link rel="canonical" href="https://peps.python.org/pep-0751/">
    <link rel="stylesheet" href="../_static/style.css" type="text/css">
    <link rel="stylesheet" href="../_static/mq.css" type="text/css">
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" media="(prefers-color-scheme: light)" id="pyg-light">
    <link rel="stylesheet" href="../_static/pygments_dark.css" type="text/css" media="(prefers-color-scheme: dark)" id="pyg-dark">
    <link rel="alternate" type="application/rss+xml" title="Latest PEPs" href="https://peps.python.org/peps.rss">
    <meta property="og:title" content='PEP 751 – A file format to record Python dependencies for installation reproducibility | peps.python.org'>
    <meta property="og:description" content="This PEP proposes a new file format for specifying dependencies to enable reproducible installation in a Python environment. The format is designed to be human-readable and machine-generated. Installers consuming the file should be able to calculate wha...">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://peps.python.org/pep-0751/">
    <meta property="og:site_name" content="Python Enhancement Proposals (PEPs)">
    <meta property="og:image" content="https://peps.python.org/_static/og-image.png">
    <meta property="og:image:alt" content="Python PEPs">
    <meta property="og:image:width" content="200">
    <meta property="og:image:height" content="200">
    <meta name="description" content="This PEP proposes a new file format for specifying dependencies to enable reproducible installation in a Python environment. The format is designed to be human-readable and machine-generated. Installers consuming the file should be able to calculate wha...">
    <meta name="theme-color" content="#3776ab">
</head>
<body>
    
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-sun-half" viewBox="0 0 24 24" pointer-events="all">
    <title>Following system colour scheme</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none"
         stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <circle cx="12" cy="12" r="9"></circle>
      <path d="M12 3v18m0-12l4.65-4.65M12 14.3l7.37-7.37M12 19.6l8.85-8.85"></path>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24" pointer-events="all">
    <title>Selected dark colour scheme</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none"
         stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z"></path>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24" pointer-events="all">
    <title>Selected light colour scheme</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none"
         stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
</svg>
    <script>

        document.documentElement.dataset.colour_scheme = localStorage.getItem("colour_scheme") || "auto"
    </script>
    <section id="pep-page-section">
        <header>
            <h1>Python Enhancement Proposals</h1>
            <ul class="breadcrumbs">
                <li><a href="https://www.python.org/" title="The Python Programming Language">Python</a> &raquo; </li>
                <li><a href="../pep-0000/">PEP Index</a> &raquo; </li>
                <li>PEP 751</li>
            </ul>
            <button id="colour-scheme-cycler" onClick="setColourScheme(nextColourScheme())">
                <svg aria-hidden="true" class="colour-scheme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
                <svg aria-hidden="true" class="colour-scheme-icon-when-dark"><use href="#svg-moon"></use></svg>
                <svg aria-hidden="true" class="colour-scheme-icon-when-light"><use href="#svg-sun"></use></svg>
                <span class="visually-hidden">Toggle light / dark / auto colour theme</span>
            </button>
        </header>
        <article>
            <section id="pep-content">
<h1 class="page-title">PEP 751 – A file format to record Python dependencies for installation reproducibility</h1>
<dl class="rfc2822 field-list simple">
<dt class="field-odd">Author<span class="colon">:</span></dt>
<dd class="field-odd">Brett Cannon &lt;brett&#32;&#97;t&#32;python.org&gt;</dd>
<dt class="field-even">Status<span class="colon">:</span></dt>
<dd class="field-even"><abbr title="Accepted and implementation complete, or no longer active">Final</abbr></dd>
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><abbr title="Normative PEP with a new feature for Python, implementation change for CPython or interoperability standard for the ecosystem">Standards Track</abbr></dd>
<dt class="field-even">Topic<span class="colon">:</span></dt>
<dd class="field-even"><a class="reference external" href="../topic/packaging/">Packaging</a></dd>
<dt class="field-odd">Created<span class="colon">:</span></dt>
<dd class="field-odd">24-Jul-2024</dd>
<dt class="field-even">Post-History<span class="colon">:</span></dt>
<dd class="field-even"><a class="reference external" href="https://discuss.python.org/t/59173" title="Discourse thread">25-Jul-2024</a>
<a class="reference external" href="https://discuss.python.org/t/69721" title="Discourse thread">30-Oct-2024</a>
<a class="reference external" href="https://discuss.python.org/t/77293" title="Discourse thread">15-Jan-2025</a></dd>
<dt class="field-odd">Replaces<span class="colon">:</span></dt>
<dd class="field-odd"><a class="reference external" href="../pep-0665/">665</a></dd>
<dt class="field-even">Resolution<span class="colon">:</span></dt>
<dd class="field-even"><a class="reference external" href="https://discuss.python.org/t/77293/150">31-Mar-2025</a></dd>
</dl>
<hr class="docutils" />
<section id="contents">
<details><summary>Table of Contents</summary><ul class="simple">
<li><a class="reference internal" href="#abstract">Abstract</a></li>
<li><a class="reference internal" href="#motivation">Motivation</a></li>
<li><a class="reference internal" href="#rationale">Rationale</a></li>
<li><a class="reference internal" href="#specification">Specification</a><ul>
<li><a class="reference internal" href="#file-name">File Name</a></li>
<li><a class="reference internal" href="#file-format">File Format</a><ul>
<li><a class="reference internal" href="#lock-version"><code class="docutils literal notranslate"><span class="pre">lock-version</span></code></a></li>
<li><a class="reference internal" href="#environments"><code class="docutils literal notranslate"><span class="pre">environments</span></code></a></li>
<li><a class="reference internal" href="#requires-python"><code class="docutils literal notranslate"><span class="pre">requires-python</span></code></a></li>
<li><a class="reference internal" href="#extras"><code class="docutils literal notranslate"><span class="pre">extras</span></code></a></li>
<li><a class="reference internal" href="#dependency-groups"><code class="docutils literal notranslate"><span class="pre">dependency-groups</span></code></a></li>
<li><a class="reference internal" href="#default-groups"><code class="docutils literal notranslate"><span class="pre">default-groups</span></code></a></li>
<li><a class="reference internal" href="#created-by"><code class="docutils literal notranslate"><span class="pre">created-by</span></code></a></li>
<li><a class="reference internal" href="#packages"><code class="docutils literal notranslate"><span class="pre">[[packages]]</span></code></a><ul>
<li><a class="reference internal" href="#packages-name"><code class="docutils literal notranslate"><span class="pre">packages.name</span></code></a></li>
<li><a class="reference internal" href="#packages-version"><code class="docutils literal notranslate"><span class="pre">packages.version</span></code></a></li>
<li><a class="reference internal" href="#packages-marker"><code class="docutils literal notranslate"><span class="pre">packages.marker</span></code></a></li>
<li><a class="reference internal" href="#packages-requires-python"><code class="docutils literal notranslate"><span class="pre">packages.requires-python</span></code></a></li>
<li><a class="reference internal" href="#packages-dependencies"><code class="docutils literal notranslate"><span class="pre">[[packages.dependencies]]</span></code></a></li>
<li><a class="reference internal" href="#packages-vcs"><code class="docutils literal notranslate"><span class="pre">[packages.vcs]</span></code></a><ul>
<li><a class="reference internal" href="#packages-vcs-type"><code class="docutils literal notranslate"><span class="pre">packages.vcs.type</span></code></a></li>
<li><a class="reference internal" href="#packages-vcs-url"><code class="docutils literal notranslate"><span class="pre">packages.vcs.url</span></code></a></li>
<li><a class="reference internal" href="#packages-vcs-path"><code class="docutils literal notranslate"><span class="pre">packages.vcs.path</span></code></a></li>
<li><a class="reference internal" href="#packages-vcs-requested-revision"><code class="docutils literal notranslate"><span class="pre">packages.vcs.requested-revision</span></code></a></li>
<li><a class="reference internal" href="#packages-vcs-commit-id"><code class="docutils literal notranslate"><span class="pre">packages.vcs.commit-id</span></code></a></li>
<li><a class="reference internal" href="#packages-vcs-subdirectory"><code class="docutils literal notranslate"><span class="pre">packages.vcs.subdirectory</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#packages-directory"><code class="docutils literal notranslate"><span class="pre">[packages.directory]</span></code></a><ul>
<li><a class="reference internal" href="#packages-directory-path"><code class="docutils literal notranslate"><span class="pre">packages.directory.path</span></code></a></li>
<li><a class="reference internal" href="#packages-directory-editable"><code class="docutils literal notranslate"><span class="pre">packages.directory.editable</span></code></a></li>
<li><a class="reference internal" href="#packages-directory-subdirectory"><code class="docutils literal notranslate"><span class="pre">packages.directory.subdirectory</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#packages-archive"><code class="docutils literal notranslate"><span class="pre">[packages.archive]</span></code></a><ul>
<li><a class="reference internal" href="#packages-archive-url"><code class="docutils literal notranslate"><span class="pre">packages.archive.url</span></code></a></li>
<li><a class="reference internal" href="#packages-archive-path"><code class="docutils literal notranslate"><span class="pre">packages.archive.path</span></code></a></li>
<li><a class="reference internal" href="#packages-archive-size"><code class="docutils literal notranslate"><span class="pre">packages.archive.size</span></code></a></li>
<li><a class="reference internal" href="#packages-archive-upload-time"><code class="docutils literal notranslate"><span class="pre">packages.archive.upload-time</span></code></a></li>
<li><a class="reference internal" href="#packages-archive-hashes"><code class="docutils literal notranslate"><span class="pre">[packages.archive.hashes]</span></code></a></li>
<li><a class="reference internal" href="#packages-archive-subdirectory"><code class="docutils literal notranslate"><span class="pre">packages.archive.subdirectory</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#packages-index"><code class="docutils literal notranslate"><span class="pre">packages.index</span></code></a></li>
<li><a class="reference internal" href="#packages-sdist"><code class="docutils literal notranslate"><span class="pre">[packages.sdist]</span></code></a><ul>
<li><a class="reference internal" href="#packages-sdist-name"><code class="docutils literal notranslate"><span class="pre">packages.sdist.name</span></code></a></li>
<li><a class="reference internal" href="#packages-sdist-upload-time"><code class="docutils literal notranslate"><span class="pre">packages.sdist.upload-time</span></code></a></li>
<li><a class="reference internal" href="#packages-sdist-url"><code class="docutils literal notranslate"><span class="pre">packages.sdist.url</span></code></a></li>
<li><a class="reference internal" href="#packages-sdist-path"><code class="docutils literal notranslate"><span class="pre">packages.sdist.path</span></code></a></li>
<li><a class="reference internal" href="#packages-sdist-size"><code class="docutils literal notranslate"><span class="pre">packages.sdist.size</span></code></a></li>
<li><a class="reference internal" href="#packages-sdist-hashes"><code class="docutils literal notranslate"><span class="pre">packages.sdist.hashes</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#packages-wheels"><code class="docutils literal notranslate"><span class="pre">[[packages.wheels]]</span></code></a><ul>
<li><a class="reference internal" href="#packages-wheels-name"><code class="docutils literal notranslate"><span class="pre">packages.wheels.name</span></code></a></li>
<li><a class="reference internal" href="#packages-wheels-upload-time"><code class="docutils literal notranslate"><span class="pre">packages.wheels.upload-time</span></code></a></li>
<li><a class="reference internal" href="#packages-wheels-url"><code class="docutils literal notranslate"><span class="pre">packages.wheels.url</span></code></a></li>
<li><a class="reference internal" href="#packages-wheels-path"><code class="docutils literal notranslate"><span class="pre">packages.wheels.path</span></code></a></li>
<li><a class="reference internal" href="#packages-wheels-size"><code class="docutils literal notranslate"><span class="pre">packages.wheels.size</span></code></a></li>
<li><a class="reference internal" href="#packages-wheels-hashes"><code class="docutils literal notranslate"><span class="pre">packages.wheels.hashes</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#packages-attestation-identities"><code class="docutils literal notranslate"><span class="pre">[[packages.attestation-identities]]</span></code></a><ul>
<li><a class="reference internal" href="#packages-attestation-identities-kind"><code class="docutils literal notranslate"><span class="pre">packages.attestation-identities.kind</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#packages-tool"><code class="docutils literal notranslate"><span class="pre">[packages.tool]</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#tool"><code class="docutils literal notranslate"><span class="pre">[tool]</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#additions-to-marker-expression-syntax">Additions to marker expression syntax</a></li>
<li><a class="reference internal" href="#example">Example</a></li>
<li><a class="reference internal" href="#installation">Installation</a></li>
<li><a class="reference internal" href="#semantic-differences-with-requirements-txt-files">Semantic differences with <code class="docutils literal notranslate"><span class="pre">requirements.txt</span></code> files</a></li>
</ul>
</li>
<li><a class="reference internal" href="#backwards-compatibility">Backwards Compatibility</a></li>
<li><a class="reference internal" href="#security-implications">Security Implications</a></li>
<li><a class="reference internal" href="#how-to-teach-this">How to Teach This</a></li>
<li><a class="reference internal" href="#reference-implementation">Reference Implementation</a></li>
<li><a class="reference internal" href="#rejected-ideas">Rejected Ideas</a><ul>
<li><a class="reference internal" href="#recording-the-dependency-graph-for-installation-purposes">Recording the dependency graph for installation purposes</a></li>
<li><a class="reference internal" href="#specifying-a-new-core-metadata-version-that-requires-consistent-metadata-across-files">Specifying a new core metadata version that requires consistent metadata across files</a></li>
<li><a class="reference internal" href="#have-the-installer-do-dependency-resolution">Have the installer do dependency resolution</a></li>
<li><a class="reference internal" href="#requiring-minimum-hash-algorithm-support">Requiring minimum hash algorithm support</a></li>
<li><a class="reference internal" href="#file-naming">File naming</a><ul>
<li><a class="reference internal" href="#using-pylock-toml-as-the-file-name">Using <code class="docutils literal notranslate"><span class="pre">*.pylock.toml</span></code> as the file name</a></li>
<li><a class="reference internal" href="#using-pylock-as-the-file-name">Using <code class="docutils literal notranslate"><span class="pre">*.pylock</span></code> as the file name</a></li>
<li><a class="reference internal" href="#not-having-a-naming-convention-for-the-file">Not having a naming convention for the file</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id1">File format</a><ul>
<li><a class="reference internal" href="#use-json-over-toml">Use JSON over TOML</a></li>
<li><a class="reference internal" href="#use-yaml-over-toml">Use YAML over TOML</a></li>
</ul>
</li>
<li><a class="reference internal" href="#other-keys">Other keys</a><ul>
<li><a class="reference internal" href="#a-single-hash-algorithm-for-the-whole-file">A single hash algorithm for the whole file</a></li>
<li><a class="reference internal" href="#hashing-the-contents-of-the-lock-file-itself">Hashing the contents of the lock file itself</a></li>
<li><a class="reference internal" href="#recording-the-creation-date-of-the-lock-file">Recording the creation date of the lock file</a></li>
<li><a class="reference internal" href="#recording-the-package-indexes-used-in-searching">Recording the package indexes used in searching</a></li>
<li><a class="reference internal" href="#locking-build-requirements-for-sdists">Locking build requirements for sdists</a></li>
<li><a class="reference internal" href="#a-dedicated-direct-key">A dedicated <code class="docutils literal notranslate"><span class="pre">direct</span></code> key</a></li>
</ul>
</li>
<li><a class="reference internal" href="#simplification">Simplification</a><ul>
<li><a class="reference internal" href="#drop-recording-the-package-version">Drop recording the package version</a></li>
<li><a class="reference internal" href="#drop-the-requirement-to-specify-the-location-of-an-sdist-and-or-wheels">Drop the requirement to specify the location of an sdist and/or wheels</a></li>
<li><a class="reference internal" href="#drop-requiring-file-size-and-hashes">Drop requiring file size and hashes</a></li>
<li><a class="reference internal" href="#drop-recording-the-sdist-file-name">Drop recording the sdist file name</a></li>
<li><a class="reference internal" href="#make-packages-wheels-a-table">Make <code class="docutils literal notranslate"><span class="pre">packages.wheels</span></code> a table</a></li>
</ul>
</li>
<li><a class="reference internal" href="#self-referential">Self-Referential</a><ul>
<li><a class="reference internal" href="#drop-the-tool-table">Drop the <code class="docutils literal notranslate"><span class="pre">[tool]</span></code> table</a></li>
<li><a class="reference internal" href="#list-the-requirement-inputs-for-the-file">List the requirement inputs for the file</a></li>
</ul>
</li>
<li><a class="reference internal" href="#auditing">Auditing</a><ul>
<li><a class="reference internal" href="#recording-dependents">Recording dependents</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#acknowledgements">Acknowledgements</a></li>
<li><a class="reference internal" href="#copyright">Copyright</a></li>
</ul>
</details></section>
<div class="pep-banner canonical-pypa-spec sticky-banner admonition important">
<p class="admonition-title">Important</p>
<p>This PEP is a historical document. The up-to-date, canonical spec, <a class="reference external" href="https://packaging.python.org/en/latest/specifications/pylock-toml/#pylock-toml-spec" title="(in Python Packaging User Guide)"><span>pylock.toml Specification</span></a>, is maintained on the <a class="reference external" href="https://packaging.python.org/en/latest/specifications/">PyPA specs page</a>.</p>
<p class="close-button">×</p>
<p>See the <a class="reference external" href="https://www.pypa.io/en/latest/specifications/#handling-fixes-and-other-minor-updates">PyPA specification update process</a> for how to propose changes.</p>
</div>
<section id="abstract">
<h2><a class="toc-backref" href="#abstract" role="doc-backlink">Abstract</a></h2>
<p>This PEP proposes a new file format for specifying dependencies
to enable reproducible installation in a Python environment. The format is
designed to be human-readable and machine-generated. Installers consuming the
file should be able to calculate what to install without the need for dependency
resolution at install-time.</p>
</section>
<section id="motivation">
<h2><a class="toc-backref" href="#motivation" role="doc-backlink">Motivation</a></h2>
<p>Currently, no standard exists to create an immutable record, such as a lock
file, which specifies what direct and indirect dependencies should be installed
into a virtual environment.</p>
<p>Considering there are at least five well-known solutions to this problem in the
community (<a class="reference external" href="https://pypi.org/project/pdm/">PDM</a>, <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">freeze</span></code>, <a class="reference external" href="https://pypi.org/project/pip-tools/">pip-tools</a>, <a class="reference external" href="https://python-poetry.org/">Poetry</a>, and <a class="reference external" href="https://github.com/astral-sh/uv">uv</a>), there seems to
be an appetite for lock files in general.</p>
<p>Those tools also vary in what locking scenarios they support. For instance,
<code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">freeze</span></code> and pip-tools only generate single-use lock files for the current
environment while PDM, Poetry, and uv can/try to lock for multiple environments
and use-cases at once. There’s also concerns around the lack of secure defaults
in the face of supply chain attacks by some tools (e.g. including hashes for
files).</p>
<p>The lack of a standard also has some drawbacks. For instance, any tooling that
wants to work with lock files must choose which format to support, potentially
leaving users unsupported (e.g. <a class="reference external" href="https://docs.github.com/en/code-security/dependabot">Dependabot</a> only supporting select tools,
same for cloud providers who can do dependency installations on your behalf,
etc.). It also impacts portability between tools, which causes vendor lock-in.
By not having compatibility and interoperability it fractures tooling around
lock files where both users and tools have to choose what lock file format to
use upfront, making it costly to use/switch to other formats (e.g. tooling
around auditing a lock file). Rallying around a single format removes this
cost/barrier.</p>
<p>The closest the community has to a standard are pip’s <a class="reference external" href="https://pip.pypa.io/en/stable/reference/requirements-file-format/">requirements files</a>
which all the aforementioned tools either use directly as their file format or
export to (i.e. <code class="docutils literal notranslate"><span class="pre">requirements.txt</span></code>). Unfortunately, the format is not a
standard but is supported by convention. It’s also designed very much for pip’s
needs, limiting its flexibility and ease of use (e.g. it’s a bespoke file
format). Lastly, it is not secure by default (e.g. file hash support is
entirely an opt-in feature, you have to tell pip to not look for other
dependencies outside of what’s in the requirements file, etc.).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Much of the motivation from <a class="pep reference internal" href="../pep-0665/" title="PEP 665 – A file format to list Python dependencies for reproducibility of an application">PEP 665</a> also applies to this PEP.</p>
</div>
</section>
<section id="rationale">
<h2><a class="toc-backref" href="#rationale" role="doc-backlink">Rationale</a></h2>
<p>The file format proposed by this PEP is designed to be human-readable. This is
so that the contents of the file can be audited by a human to make sure no
undesired dependencies end up being included in the lock file.</p>
<p>The file format is also designed to not require a resolver at install time. This
greatly simplifies reasoning about what would be installed when consuming a lock
file. It should also lead to faster installs which are much more frequent than
creating a lock file.</p>
<p>The data in the file should be consumable by tools not written in Python. This
allows for e.g. cloud hosting providers to write their own tool to perform
installations in their preferred programming language. This introduces the
concept of <em>lockers</em> which write the lock file, and <em>installers</em> which install
from a lock file (they can be the same tool).</p>
<p>The file format should promote good security defaults. As the format is not
meant to be human-writable, this means having tools provide security-related
details is reasonable and not a costly burden.</p>
<p>The contents of a lock file should be able to replace the vast majority of uses
of <a class="reference external" href="https://pip.pypa.io/en/stable/reference/requirements-file-format/">requirements files</a> when used as a lock file (e.g. what
<a class="reference external" href="https://pypi.org/project/pip-tools/">pip-tools</a> and <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">freeze</span></code> emit). This means the file format specified by
this PEP can, at minimum, act as an export target for tools which have their own
internal lock file format.</p>
<p>Lock files can be <em>single-use</em> and <em>multi-use</em>. Single-use lock files are things
like <code class="docutils literal notranslate"><span class="pre">requirements.txt</span></code> files, which serve a single use-case/purpose (hence
why it isn’t uncommon for a project to have multiple requirements files, each
for a different use-case). Multi-use lock files represent multiple use-cases
within a single file, often expressed through
<a class="reference external" href="https://packaging.python.org/en/latest/specifications/core-metadata/#core-metadata-provides-extra" title="(in Python Packaging User Guide)"><span class="xref std std-ref">extras</span></a> and
<a class="reference external" href="https://packaging.python.org/en/latest/specifications/dependency-groups/#dependency-groups" title="(in Python Packaging User Guide)"><span>Dependency Groups</span></a>. As such, this PEP supports additions to
<a class="reference external" href="https://packaging.python.org/en/latest/specifications/dependency-specifiers/#dependency-specifiers-environment-markers" title="(in Python Packaging User Guide)"><span>Environment Markers</span></a> that allows for
specifying extras and dependency groups as appropriate. This allows
for a single lock file to support those cases. This not only cuts down on the
number of potential lock files, but it also makes it easier when a single
package is meant to be consistent across all use-cases (with multiple single-use
lock files it requires coordinating across multiple lock files). This support
also means that this PEP supports all package installation-related data that can
be recorded in a <code class="docutils literal notranslate"><span class="pre">pyproject.toml</span></code> file. The hope is that this support will
allow some tools to drop their internal lock file entirely and solely rely on
what this PEP specifies.</p>
</section>
<section id="specification">
<h2><a class="toc-backref" href="#specification" role="doc-backlink">Specification</a></h2>
<section id="file-name">
<h3><a class="toc-backref" href="#file-name" role="doc-backlink">File Name</a></h3>
<p>A lock file MUST be named <code class="file docutils literal notranslate"><span class="pre">pylock.toml</span></code> or match the regular expression
<code class="docutils literal notranslate"><span class="pre">r&quot;^pylock\.([^.]+)\.toml$&quot;</span></code> if a name for the lock file is desired or if multiple
lock files exist. The use of the <code class="docutils literal notranslate"><span class="pre">.toml</span></code> file extension is to make syntax
highlighting in editors easier and to reinforce the fact that the file format is
meant to be human-readable. The prefix and suffix of a named file MUST be
lowercase when possible, for easy detection and removal,
e.g.:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">11</span> <span class="ow">and</span> <span class="n">filename</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;pylock.&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">filename</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.toml&quot;</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">filename</span><span class="o">.</span><span class="n">removeprefix</span><span class="p">(</span><span class="s2">&quot;pylock.&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">removesuffix</span><span class="p">(</span><span class="s2">&quot;.toml&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>The expectation is that services that automatically install from lock files will
search for:</p>
<ol class="arabic simple">
<li>The lock file with the service’s name and doing the default install</li>
<li>A multi-use <code class="docutils literal notranslate"><span class="pre">pylock.toml</span></code> with a dependency group with the name of the service</li>
<li>The default install of <code class="docutils literal notranslate"><span class="pre">pylock.toml</span></code></li>
</ol>
<p>E.g. a cloud host service named “spam” would first look for
<code class="docutils literal notranslate"><span class="pre">pylock.spam.toml</span></code> to install from, and if that file didn’t exist then install
from <code class="docutils literal notranslate"><span class="pre">pylock.toml</span></code> and look for a dependency group named “spam” to use if
present.</p>
<p>The lock file(s) SHOULD be located in the directory as appropriate for the scope
of the lock file. Locking against a single <code class="docutils literal notranslate"><span class="pre">pyproject.toml</span></code>, for instance,
would place the <code class="docutils literal notranslate"><span class="pre">pylock.toml</span></code> in the same directory. If the lock file covered
multiple projects in a monorepo, then the expectation is the <code class="docutils literal notranslate"><span class="pre">pylock.toml</span></code>
file would be in the directory that held all the projects being locked.</p>
</section>
<section id="file-format">
<h3><a class="toc-backref" href="#file-format" role="doc-backlink">File Format</a></h3>
<p>The format of the file is <a class="reference external" href="https://toml.io/">TOML</a>.</p>
<p>Tools SHOULD write their lock files in a consistent way to minimize noise in
diff output. Keys in tables – including the top-level table – SHOULD be
recorded in a consistent order (if inspiration is desired, this PEP has tried to
write down keys in a logical order). As well, tools SHOULD sort arrays in
consistent order. Usage of inline tables SHOULD also be kept consistent.</p>
<section id="lock-version">
<h4><a class="toc-backref" href="#lock-version" role="doc-backlink"><code class="docutils literal notranslate"><span class="pre">lock-version</span></code></a></h4>
<ul class="simple">
<li><strong>Type</strong>: string; value of <code class="docutils literal notranslate"><span class="pre">&quot;1.0&quot;</span></code></li>
<li><strong>Required?</strong>: yes</li>
<li><strong>Inspiration</strong>: <a class="reference external" href="https://packaging.python.org/en/latest/specifications/core-metadata/#core-metadata-metadata-version" title="(in Python Packaging User Guide)"><span>Metadata-Version</span></a></li>
<li>Record the file format version that the file adheres to.</li>
<li>This PEP specifies the initial version – and only valid value until future
updates to the standard change it – as <code class="docutils literal notranslate"><span class="pre">&quot;1.0&quot;</span></code>.</li>
<li>If a tool supports the major version but not the minor version, a tool
SHOULD warn when an unknown key is seen.</li>
<li>If a tool doesn’t support a major version, it MUST raise an error.</li>
</ul>
</section>
<section id="environments">
<h4><a class="toc-backref" href="#environments" role="doc-backlink"><code class="docutils literal notranslate"><span class="pre">environments</span></code></a></h4>
<ul class="simple">
<li><strong>Type</strong>: Array of strings</li>
<li><strong>Required?</strong>: no</li>
<li><strong>Inspiration</strong>: <a class="reference external" href="https://github.com/astral-sh/uv">uv</a></li>
<li>A list of <a class="reference external" href="https://packaging.python.org/en/latest/specifications/dependency-specifiers/#dependency-specifiers-environment-markers" title="(in Python Packaging User Guide)"><span>Environment Markers</span></a> for
which the lock file is considered compatible with.</li>
<li>Tools SHOULD write exclusive/non-overlapping environment markers to ease in
understanding.</li>
</ul>
</section>
<section id="requires-python">
<h4><a class="toc-backref" href="#requires-python" role="doc-backlink"><code class="docutils literal notranslate"><span class="pre">requires-python</span></code></a></h4>
<ul class="simple">
<li><strong>Type</strong>: string</li>
<li><strong>Required?</strong>: no</li>
<li><strong>Inspiration</strong>: <a class="reference external" href="https://pypi.org/project/pdm/">PDM</a>, <a class="reference external" href="https://python-poetry.org/">Poetry</a>, <a class="reference external" href="https://github.com/astral-sh/uv">uv</a></li>
<li>Specifies the <a class="reference external" href="https://packaging.python.org/en/latest/specifications/core-metadata/#core-metadata-requires-python" title="(in Python Packaging User Guide)"><span>Requires-Python</span></a> for the minimum
Python version compatible for any environment supported by the lock file
(i.e. the minimum viable Python version for the lock file).</li>
</ul>
</section>
<section id="extras">
<h4><a class="toc-backref" href="#extras" role="doc-backlink"><code class="docutils literal notranslate"><span class="pre">extras</span></code></a></h4>
<ul class="simple">
<li><strong>Type</strong>: Array of strings</li>
<li><strong>Required?</strong>: no; defaults to <code class="docutils literal notranslate"><span class="pre">[]</span></code></li>
<li><strong>Inspiration</strong>: <a class="reference external" href="https://packaging.python.org/en/latest/specifications/core-metadata/#core-metadata-provides-extra" title="(in Python Packaging User Guide)"><span>Provides-Extra (multiple use)</span></a></li>
<li>The list of <a class="reference external" href="https://packaging.python.org/en/latest/specifications/core-metadata/#core-metadata-provides-extra" title="(in Python Packaging User Guide)"><span class="xref std std-ref">extras</span></a> supported
by this lock file.</li>
<li>Lockers MAY choose to not support writing lock files that support extras and
dependency groups (i.e. tools may only support exporting a single-use lock
file).</li>
<li>Tools supporting extras MUST also support dependency groups.</li>
<li>Tools should explicitly set this key to an empty array to signal that the
inputs used to generate the lock file had no extras (e.g. a <code class="docutils literal notranslate"><span class="pre">pyproject.toml</span></code>
file had no <code class="docutils literal notranslate"><span class="pre">[project.optional-dependencies]</span></code> table), signalling that the
lock file is, in effect, multi-use even if it only looks to be single-use.</li>
</ul>
</section>
<section id="dependency-groups">
<h4><a class="toc-backref" href="#dependency-groups" role="doc-backlink"><code class="docutils literal notranslate"><span class="pre">dependency-groups</span></code></a></h4>
<ul class="simple">
<li><strong>Type</strong>: Array of strings</li>
<li><strong>Required?</strong>: no; defaults to <code class="docutils literal notranslate"><span class="pre">[]</span></code></li>
<li><strong>Inspiration</strong>: <a class="reference external" href="https://packaging.python.org/en/latest/specifications/pyproject-toml/#pyproject-tool-table" title="(in Python Packaging User Guide)"><span>Arbitrary tool configuration: the [tool] table</span></a></li>
<li>The list of <a class="reference external" href="https://packaging.python.org/en/latest/specifications/dependency-groups/#dependency-groups" title="(in Python Packaging User Guide)"><span>Dependency Groups</span></a> publicly supported by this lock
file (i.e. dependency groups users are expected to be able to specify via a
tool’s UI).</li>
<li>Lockers MAY choose to not support writing lock files that support extras and
dependency groups (i.e. tools may only support exporting a single-use lock
file).</li>
<li>Tools supporting dependency groups MUST also support extras.</li>
<li>Tools SHOULD explicitly set this key to an empty array to signal that the
inputs used to generate the lock file had no dependency groups (e.g. a <code class="docutils literal notranslate"><span class="pre">pyproject.toml</span></code>
file had no <code class="docutils literal notranslate"><span class="pre">[dependency-groups]</span></code> table), signalling that the lock file
is, in effect, multi-use even if it only looks to be single-use.</li>
</ul>
</section>
<section id="default-groups">
<h4><a class="toc-backref" href="#default-groups" role="doc-backlink"><code class="docutils literal notranslate"><span class="pre">default-groups</span></code></a></h4>
<ul class="simple">
<li><strong>Type</strong>: Array of strings</li>
<li><strong>Required?</strong>: no; defaults to <code class="docutils literal notranslate"><span class="pre">[]</span></code></li>
<li><strong>Inspiration</strong>: <a class="reference external" href="https://python-poetry.org/">Poetry</a>, <a class="reference external" href="https://pypi.org/project/pdm/">PDM</a></li>
<li>The name of synthetic dependency groups to represent what should be installed
by default (e.g. what <code class="docutils literal notranslate"><span class="pre">project.dependencies</span></code> implicitly represents).</li>
<li>Meant to be used in situations where <code class="docutils literal notranslate"><span class="pre">packages.marker</span></code> necessitates such a
group to exist.</li>
<li>The groups listed by this key SHOULD NOT be listed in <code class="docutils literal notranslate"><span class="pre">dependency-groups</span></code> as
the groups are not meant to be directly exposed to users by name but instead
via an installer’s UI.</li>
</ul>
</section>
<section id="created-by">
<h4><a class="toc-backref" href="#created-by" role="doc-backlink"><code class="docutils literal notranslate"><span class="pre">created-by</span></code></a></h4>
<ul class="simple">
<li><strong>Type</strong>: string</li>
<li><strong>Required?</strong>: yes</li>
<li><strong>Inspiration</strong>: Tools with their name in their lock file name</li>
<li>Records the name of the tool used to create the lock file.</li>
<li>Tools MAY use the <code class="docutils literal notranslate"><span class="pre">[tool]</span></code> table to record enough details that it can be
inferred what inputs were used to create the lock file.</li>
<li>Tools SHOULD record the normalized name of the tool if it is available as a
Python package to facilitate finding the tool.</li>
</ul>
</section>
<section id="packages">
<h4><a class="toc-backref" href="#packages" role="doc-backlink"><code class="docutils literal notranslate"><span class="pre">[[packages]]</span></code></a></h4>
<ul class="simple">
<li><strong>Type</strong>: array of tables</li>
<li><strong>Required?</strong>: yes</li>
<li><strong>Inspiration</strong>: <a class="reference external" href="https://pypi.org/project/pdm/">PDM</a>, <a class="reference external" href="https://python-poetry.org/">Poetry</a>, <a class="reference external" href="https://github.com/astral-sh/uv">uv</a></li>
<li>An array containing all packages that <em>may</em> be installed.</li>
<li>Packages MAY be listed multiple times with varying data, but all packages to
be installed MUST narrow down to a single entry at install time.</li>
</ul>
<section id="packages-name">
<h5><a class="toc-backref" href="#packages-name" role="doc-backlink"><code class="docutils literal notranslate"><span class="pre">packages.name</span></code></a></h5>
<ul class="simple">
<li><strong>Type</strong>: string</li>
<li><strong>Required?</strong>: yes</li>
<li><strong>Inspiration</strong>: <a class="reference external" href="https://packaging.python.org/en/latest/specifications/core-metadata/#core-metadata-name" title="(in Python Packaging User Guide)"><span>Name</span></a></li>
<li>The name of the package <a class="reference external" href="https://packaging.python.org/en/latest/specifications/name-normalization/#name-normalization" title="(in Python Packaging User Guide)"><span class="xref std std-ref">normalized</span></a>.</li>
</ul>
</section>
<section id="packages-version">
<h5><a class="toc-backref" href="#packages-version" role="doc-backlink"><code class="docutils literal notranslate"><span class="pre">packages.version</span></code></a></h5>
<ul class="simple">
<li><strong>Type</strong>: string</li>
<li><strong>Required?</strong>: no</li>
<li><strong>Inspiration</strong>: <a class="reference external" href="https://packaging.python.org/en/latest/specifications/core-metadata/#core-metadata-version" title="(in Python Packaging User Guide)"><span>Version</span></a></li>
<li>The version of the package.</li>
<li>The version SHOULD be specified when the version is known to be stable
(i.e. when an <a class="reference external" href="https://packaging.python.org/en/latest/specifications/source-distribution-format/#source-distribution-format" title="(in Python Packaging User Guide)"><span class="xref std std-ref">sdist</span></a> or
<a class="reference external" href="https://packaging.python.org/en/latest/specifications/binary-distribution-format/#binary-distribution-format" title="(in Python Packaging User Guide)"><span class="xref std std-ref">wheels</span></a> are specified).</li>
<li>The version MUST NOT be included when it cannot be guaranteed to be consistent
with the code used (i.e. when a
<a class="reference external" href="https://packaging.python.org/en/latest/specifications/source-distribution-format/#source-distribution-format-source-tree" title="(in Python Packaging User Guide)"><span class="xref std std-ref">source tree</span></a> is
used).</li>
</ul>
</section>
<section id="packages-marker">
<h5><a class="toc-backref" href="#packages-marker" role="doc-backlink"><code class="docutils literal notranslate"><span class="pre">packages.marker</span></code></a></h5>
<ul class="simple">
<li><strong>Type</strong>: string</li>
<li><strong>Required?</strong>: no</li>
<li><strong>Inspiration</strong>: <a class="reference external" href="https://pypi.org/project/pdm/">PDM</a></li>
<li>The
<a class="reference external" href="https://packaging.python.org/en/latest/specifications/dependency-specifiers/#dependency-specifiers-environment-markers" title="(in Python Packaging User Guide)"><span class="xref std std-ref">environment marker</span></a>
which specify when the package should be installed.</li>
</ul>
</section>
<section id="packages-requires-python">
<h5><a class="toc-backref" href="#packages-requires-python" role="doc-backlink"><code class="docutils literal notranslate"><span class="pre">packages.requires-python</span></code></a></h5>
<ul class="simple">
<li><strong>Type</strong>: string</li>
<li><strong>Required?</strong>: no</li>
<li><strong>Inspiration</strong>: <a class="reference external" href="https://packaging.python.org/en/latest/specifications/core-metadata/#core-metadata-requires-python" title="(in Python Packaging User Guide)"><span>Requires-Python</span></a></li>
<li>Holds the <a class="reference external" href="https://packaging.python.org/en/latest/specifications/version-specifiers/#version-specifiers" title="(in Python Packaging User Guide)"><span>Version specifiers</span></a> for Python version compatibility
for the package.</li>
</ul>
</section>
<section id="packages-dependencies">
<h5><a class="toc-backref" href="#packages-dependencies" role="doc-backlink"><code class="docutils literal notranslate"><span class="pre">[[packages.dependencies]]</span></code></a></h5>
<ul class="simple">
<li><strong>Type</strong>: array of tables</li>
<li><strong>Required?</strong>: no</li>
<li><strong>Inspiration</strong>: <a class="reference external" href="https://pypi.org/project/pdm/">PDM</a>, <a class="reference external" href="https://python-poetry.org/">Poetry</a>, <a class="reference external" href="https://github.com/astral-sh/uv">uv</a></li>
<li>Records the other entries in <code class="docutils literal notranslate"><span class="pre">[[packages]]</span></code> which are direct dependencies of
this package.</li>
<li>Each entry is a table which contains the minimum information required to tell
which other package entry it corresponds to where doing a key-by-key
comparison would find the appropriate package with no ambiguity (e.g. if there
are two entries for the <code class="docutils literal notranslate"><span class="pre">spam</span></code> package, then you can include the version
number like <code class="docutils literal notranslate"><span class="pre">{name</span> <span class="pre">=</span> <span class="pre">&quot;spam&quot;,</span> <span class="pre">version</span> <span class="pre">=</span> <span class="pre">&quot;1.0.0&quot;}</span></code>, or by source like
<code class="docutils literal notranslate"><span class="pre">{name</span> <span class="pre">=</span> <span class="pre">&quot;spam&quot;,</span> <span class="pre">vcs</span> <span class="pre">=</span> <span class="pre">{</span> <span class="pre">url</span> <span class="pre">=</span> <span class="pre">&quot;...&quot;}</span></code>).</li>
<li>Tools MUST NOT use this information when doing installation; it is purely
informational for auditing purposes.</li>
</ul>
</section>
<section id="packages-vcs">
<h5><a class="toc-backref" href="#packages-vcs" role="doc-backlink"><code class="docutils literal notranslate"><span class="pre">[packages.vcs]</span></code></a></h5>
<ul class="simple">
<li><strong>Type</strong>: table</li>
<li><strong>Required?</strong>: no; mutually-exclusive with <code class="docutils literal notranslate"><span class="pre">packages.directory</span></code>,
<code class="docutils literal notranslate"><span class="pre">packages.archive</span></code>, <code class="docutils literal notranslate"><span class="pre">packages.sdist</span></code>, and <code class="docutils literal notranslate"><span class="pre">packages.wheels</span></code></li>
<li><strong>Inspiration</strong>: <a class="reference external" href="https://packaging.python.org/en/latest/specifications/direct-url-data-structure/#direct-url-data-structure" title="(in Python Packaging User Guide)"><span>Direct URL Data Structure</span></a></li>
<li>Record the version control system details for the
<a class="reference external" href="https://packaging.python.org/en/latest/specifications/source-distribution-format/#source-distribution-format-source-tree" title="(in Python Packaging User Guide)"><span class="xref std std-ref">source tree</span></a> it
contains.</li>
<li>Tools MAY choose to not support version control systems, both from a locking
and/or installation perspective.</li>
<li>Tools MAY choose to only support a subset of the available VCS types.</li>
<li>Tools SHOULD provide a way for users to opt in/out of using version control
systems.</li>
<li>Installation from a version control system is considered originating from a
<a class="reference external" href="https://packaging.python.org/en/latest/specifications/direct-url/#direct-url" title="(in Python Packaging User Guide)"><span class="xref std std-ref">direct URL reference</span></a>.</li>
</ul>
<section id="packages-vcs-type">
<h6><a class="toc-backref" href="#packages-vcs-type" role="doc-backlink"><code class="docutils literal notranslate"><span class="pre">packages.vcs.type</span></code></a></h6>
<ul class="simple">
<li><strong>Type</strong>: string; supported values specified in
<a class="reference external" href="https://packaging.python.org/en/latest/specifications/direct-url-data-structure/#direct-url-data-structure-registered-vcs" title="(in Python Packaging User Guide)"><span>Registered VCS</span></a></li>
<li><strong>Required?</strong>: yes</li>
<li><strong>Inspiration</strong>: <a class="reference external" href="https://packaging.python.org/en/latest/specifications/direct-url-data-structure/#direct-url-data-structure-vcs" title="(in Python Packaging User Guide)"><span>VCS URLs</span></a></li>
<li>The type of version control system used.</li>
</ul>
</section>
<section id="packages-vcs-url">
<h6><a class="toc-backref" href="#packages-vcs-url" role="doc-backlink"><code class="docutils literal notranslate"><span class="pre">packages.vcs.url</span></code></a></h6>
<ul class="simple">
<li><strong>Type</strong>: string</li>
<li><strong>Required?</strong>: if <code class="docutils literal notranslate"><span class="pre">path</span></code> is not specified</li>
<li><strong>Inspiration</strong>: <a class="reference external" href="https://packaging.python.org/en/latest/specifications/direct-url-data-structure/#direct-url-data-structure-vcs" title="(in Python Packaging User Guide)"><span>VCS URLs</span></a></li>
<li>The URL to the source tree.</li>
</ul>
</section>
<section id="packages-vcs-path">
<h6><a class="toc-backref" href="#packages-vcs-path" role="doc-backlink"><code class="docutils literal notranslate"><span class="pre">packages.vcs.path</span></code></a></h6>
<ul class="simple">
<li><strong>Type</strong>: string</li>
<li><strong>Required?</strong>: if <code class="docutils literal notranslate"><span class="pre">url</span></code> is not specified</li>
<li><strong>Inspiration</strong>: <a class="reference external" href="https://packaging.python.org/en/latest/specifications/direct-url-data-structure/#direct-url-data-structure-vcs" title="(in Python Packaging User Guide)"><span>VCS URLs</span></a></li>
<li>The path to the local directory of the source tree.</li>
<li>If a relative path is used it MUST be relative to the location of this file.</li>
<li>If the path is relative it MAY use POSIX-style path separators explicitly
for portability.</li>
</ul>
</section>
<section id="packages-vcs-requested-revision">
<h6><a class="toc-backref" href="#packages-vcs-requested-revision" role="doc-backlink"><code class="docutils literal notranslate"><span class="pre">packages.vcs.requested-revision</span></code></a></h6>
<ul class="simple">
<li><strong>Type</strong>: string</li>
<li><strong>Required?</strong>: no</li>
<li><strong>Inspiration</strong>: <a class="reference external" href="https://packaging.python.org/en/latest/specifications/direct-url-data-structure/#direct-url-data-structure-vcs" title="(in Python Packaging User Guide)"><span>VCS URLs</span></a></li>
<li>The branch/tag/ref/commit/revision/etc. that the user requested.</li>
<li>This is purely informational and to facilitate writing the
<a class="reference external" href="https://packaging.python.org/en/latest/specifications/direct-url-data-structure/#direct-url-data-structure" title="(in Python Packaging User Guide)"><span>Direct URL Data Structure</span></a>; it MUST NOT be used to checkout
the repository.</li>
</ul>
</section>
<section id="packages-vcs-commit-id">
<h6><a class="toc-backref" href="#packages-vcs-commit-id" role="doc-backlink"><code class="docutils literal notranslate"><span class="pre">packages.vcs.commit-id</span></code></a></h6>
<ul class="simple">
<li><strong>Type</strong>: string</li>
<li><strong>Required?</strong>: yes</li>
<li><strong>Inspiration</strong>: <a class="reference external" href="https://packaging.python.org/en/latest/specifications/direct-url-data-structure/#direct-url-data-structure-vcs" title="(in Python Packaging User Guide)"><span>VCS URLs</span></a></li>
<li>The exact commit/revision number that is to be installed.</li>
<li>If the VCS supports commit-hash based revision identifiers, such a commit-hash
MUST be used as the commit ID in order to reference an immutable version of
the source code.</li>
</ul>
</section>
<section id="packages-vcs-subdirectory">
<h6><a class="toc-backref" href="#packages-vcs-subdirectory" role="doc-backlink"><code class="docutils literal notranslate"><span class="pre">packages.vcs.subdirectory</span></code></a></h6>
<ul class="simple">
<li><strong>Type</strong>: string</li>
<li><strong>Required?</strong>: no</li>
<li><strong>Inspiration</strong>: <a class="reference external" href="https://packaging.python.org/en/latest/specifications/direct-url-data-structure/#direct-url-data-structure-subdirectories" title="(in Python Packaging User Guide)"><span>Projects in subdirectories</span></a></li>
<li>The subdirectory within the
<a class="reference external" href="https://packaging.python.org/en/latest/specifications/source-distribution-format/#source-distribution-format-source-tree" title="(in Python Packaging User Guide)"><span class="xref std std-ref">source tree</span></a> where
the project root of the project is (e.g. the location of the
<code class="docutils literal notranslate"><span class="pre">pyproject.toml</span></code> file).</li>
<li>The path MUST be relative to the root of the source tree structure.</li>
</ul>
</section>
</section>
<section id="packages-directory">
<h5><a class="toc-backref" href="#packages-directory" role="doc-backlink"><code class="docutils literal notranslate"><span class="pre">[packages.directory]</span></code></a></h5>
<ul class="simple">
<li><strong>Type</strong>: table</li>
<li><strong>Required?</strong>: no; mutually-exclusive with <code class="docutils literal notranslate"><span class="pre">packages.vcs</span></code>,
<code class="docutils literal notranslate"><span class="pre">packages.archive</span></code>, <code class="docutils literal notranslate"><span class="pre">packages.sdist</span></code>, and <code class="docutils literal notranslate"><span class="pre">packages.wheels</span></code></li>
<li><strong>Inspiration</strong>: <a class="reference external" href="https://packaging.python.org/en/latest/specifications/direct-url-data-structure/#direct-url-data-structure-local-directory" title="(in Python Packaging User Guide)"><span>Local directories</span></a></li>
<li>Record the local directory details for the
<a class="reference external" href="https://packaging.python.org/en/latest/specifications/source-distribution-format/#source-distribution-format-source-tree" title="(in Python Packaging User Guide)"><span class="xref std std-ref">source tree</span></a> it
contains.</li>
<li>Tools MAY choose to not support local directories, both from a locking
and/or installation perspective.</li>
<li>Tools SHOULD provide a way for users to opt in/out of using local directories.</li>
<li>Installation from a directory is considered originating from a
<a class="reference external" href="https://packaging.python.org/en/latest/specifications/direct-url/#direct-url" title="(in Python Packaging User Guide)"><span class="xref std std-ref">direct URL reference</span></a>.</li>
</ul>
<section id="packages-directory-path">
<h6><a class="toc-backref" href="#packages-directory-path" role="doc-backlink"><code class="docutils literal notranslate"><span class="pre">packages.directory.path</span></code></a></h6>
<ul class="simple">
<li><strong>Type</strong>: string</li>
<li><strong>Required?</strong>: yes</li>
<li><strong>Inspiration</strong>: <a class="reference external" href="https://packaging.python.org/en/latest/specifications/direct-url-data-structure/#direct-url-data-structure-local-directory" title="(in Python Packaging User Guide)"><span>Local directories</span></a></li>
<li>The local directory where the source tree is.</li>
<li>If the path is relative it MUST be relative to the location of the lock file.</li>
<li>If the path is relative it MAY use POSIX-style path separators for
portability.</li>
</ul>
</section>
<section id="packages-directory-editable">
<h6><a class="toc-backref" href="#packages-directory-editable" role="doc-backlink"><code class="docutils literal notranslate"><span class="pre">packages.directory.editable</span></code></a></h6>
<ul class="simple">
<li><strong>Type</strong>: boolean</li>
<li><strong>Required?</strong>: no; defaults to <code class="docutils literal notranslate"><span class="pre">false</span></code></li>
<li><strong>Inspiration</strong>: <a class="reference external" href="https://packaging.python.org/en/latest/specifications/direct-url-data-structure/#direct-url-data-structure-local-directory" title="(in Python Packaging User Guide)"><span>Local directories</span></a></li>
<li>A flag representing whether the source tree was an editable install at lock
time.</li>
<li>Installer MAY choose to ignore this flag if user actions or context would make
an editable install unnecessary or undesirable (e.g. a container image that
will not be mounted for development purposes but instead deployed to
production where it would be treated at read-only).</li>
</ul>
</section>
<section id="packages-directory-subdirectory">
<h6><a class="toc-backref" href="#packages-directory-subdirectory" role="doc-backlink"><code class="docutils literal notranslate"><span class="pre">packages.directory.subdirectory</span></code></a></h6>
<p>See <code class="docutils literal notranslate"><span class="pre">packages.vcs.subdirectory</span></code>.</p>
</section>
</section>
<section id="packages-archive">
<h5><a class="toc-backref" href="#packages-archive" role="doc-backlink"><code class="docutils literal notranslate"><span class="pre">[packages.archive]</span></code></a></h5>
<ul class="simple">
<li><strong>Type</strong>: table</li>
<li><strong>Required?</strong>: no</li>
<li><strong>Inspiration</strong>: <a class="reference external" href="https://packaging.python.org/en/latest/specifications/direct-url-data-structure/#direct-url-data-structure-archive" title="(in Python Packaging User Guide)"><span>Archive URLs</span></a></li>
<li>A direct reference to an archive file to install from
(this can include wheels and sdists, as well as other archive formats
containing a source tree).</li>
<li>Tools MAY choose to not support archive files, both from a locking
and/or installation perspective.</li>
<li>Tools SHOULD provide a way for users to opt in/out of using archive files.</li>
<li>Installation from an archive file is considered originating from a
<a class="reference external" href="https://packaging.python.org/en/latest/specifications/direct-url/#direct-url" title="(in Python Packaging User Guide)"><span class="xref std std-ref">direct URL reference</span></a>.</li>
</ul>
<section id="packages-archive-url">
<h6><a class="toc-backref" href="#packages-archive-url" role="doc-backlink"><code class="docutils literal notranslate"><span class="pre">packages.archive.url</span></code></a></h6>
<p>See <code class="docutils literal notranslate"><span class="pre">packages.vcs.url</span></code>.</p>
</section>
<section id="packages-archive-path">
<h6><a class="toc-backref" href="#packages-archive-path" role="doc-backlink"><code class="docutils literal notranslate"><span class="pre">packages.archive.path</span></code></a></h6>
<p>See <code class="docutils literal notranslate"><span class="pre">packages.vcs.path</span></code>.</p>
</section>
<section id="packages-archive-size">
<h6><a class="toc-backref" href="#packages-archive-size" role="doc-backlink"><code class="docutils literal notranslate"><span class="pre">packages.archive.size</span></code></a></h6>
<ul class="simple">
<li><strong>Type</strong>: integer</li>
<li><strong>Required?</strong>: no</li>
<li><strong>Inspiration</strong>: <a class="reference external" href="https://github.com/astral-sh/uv">uv</a>, <a class="reference external" href="https://packaging.python.org/en/latest/specifications/simple-repository-api/#simple-repository-api" title="(in Python Packaging User Guide)"><span>Simple repository API</span></a></li>
<li>The size of the archive file.</li>
<li>Tools SHOULD provide the file size when reasonably possible (e.g. the file
size is available via the <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Length">Content-Length</a> header from a <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Methods/HEAD">HEAD</a> HTTP request).</li>
</ul>
</section>
<section id="packages-archive-upload-time">
<h6><a class="toc-backref" href="#packages-archive-upload-time" role="doc-backlink"><code class="docutils literal notranslate"><span class="pre">packages.archive.upload-time</span></code></a></h6>
<ul class="simple">
<li><strong>Type</strong>: datetime</li>
<li><strong>Required?</strong>: no</li>
<li><strong>Inspiration</strong>: <a class="reference external" href="https://packaging.python.org/en/latest/specifications/simple-repository-api/#simple-repository-api" title="(in Python Packaging User Guide)"><span>Simple repository API</span></a></li>
<li>The time the file was uploaded.</li>
<li>The date and time MUST be recorded in UTC.</li>
</ul>
</section>
<section id="packages-archive-hashes">
<h6><a class="toc-backref" href="#packages-archive-hashes" role="doc-backlink"><code class="docutils literal notranslate"><span class="pre">[packages.archive.hashes]</span></code></a></h6>
<ul class="simple">
<li><strong>Type</strong>: Table of strings</li>
<li><strong>Required?</strong>: yes</li>
<li><strong>Inspiration</strong>: <a class="reference external" href="https://pypi.org/project/pdm/">PDM</a>, <a class="reference external" href="https://python-poetry.org/">Poetry</a>, <a class="reference external" href="https://github.com/astral-sh/uv">uv</a>, <a class="reference external" href="https://packaging.python.org/en/latest/specifications/simple-repository-api/#simple-repository-api" title="(in Python Packaging User Guide)"><span>Simple repository API</span></a></li>
<li>A table listing known hash values of the file where the key is the hash
algorithm and the value is the hash value.</li>
<li>The table MUST contain at least one entry.</li>
<li>Hash algorithm keys SHOULD be lowercase.</li>
<li>At least one secure algorithm from <a class="reference external" href="https://docs.python.org/3/library/hashlib.html#hashlib.algorithms_guaranteed" title="(in Python v3.14)"><code class="xref py py-data docutils literal notranslate"><span class="pre">hashlib.algorithms_guaranteed</span></code></a>
SHOULD always be included (at time of writing, sha256 specifically is
recommended.</li>
</ul>
</section>
<section id="packages-archive-subdirectory">
<h6><a class="toc-backref" href="#packages-archive-subdirectory" role="doc-backlink"><code class="docutils literal notranslate"><span class="pre">packages.archive.subdirectory</span></code></a></h6>
<p>See <code class="docutils literal notranslate"><span class="pre">packages.vcs.subdirectory</span></code>.</p>
</section>
</section>
<section id="packages-index">
<h5><a class="toc-backref" href="#packages-index" role="doc-backlink"><code class="docutils literal notranslate"><span class="pre">packages.index</span></code></a></h5>
<ul class="simple">
<li><strong>Type</strong>: string</li>
<li><strong>Required?</strong>: no</li>
<li><strong>Inspiration</strong>: <a class="reference external" href="https://github.com/astral-sh/uv">uv</a></li>
<li>The base URL for the package index from <a class="reference external" href="https://packaging.python.org/en/latest/specifications/simple-repository-api/#simple-repository-api" title="(in Python Packaging User Guide)"><span>Simple repository API</span></a>
where the sdist and/or wheels were found (e.g. <code class="docutils literal notranslate"><span class="pre">https://pypi.org/simple/</span></code>).</li>
<li>When possible, this SHOULD be specified to assist with generating
<a class="reference external" href="https://www.cisa.gov/sbom">software bill of materials</a> – aka SBOMs – and to assist in finding a file
if a URL ceases to be valid.</li>
<li>Tools MAY support installing from an index if the URL recorded for a specific
file is no longer valid (e.g. returns a 404 HTTP error code).</li>
</ul>
</section>
<section id="packages-sdist">
<h5><a class="toc-backref" href="#packages-sdist" role="doc-backlink"><code class="docutils literal notranslate"><span class="pre">[packages.sdist]</span></code></a></h5>
<ul class="simple">
<li><strong>Type</strong>: table</li>
<li><strong>Required?</strong>: no; mutually-exclusive with <code class="docutils literal notranslate"><span class="pre">packages.vcs</span></code>,
<code class="docutils literal notranslate"><span class="pre">packages.directory</span></code>, and <code class="docutils literal notranslate"><span class="pre">packages.archive</span></code></li>
<li><strong>Inspiration</strong>: <a class="reference external" href="https://github.com/astral-sh/uv">uv</a></li>
<li>Details of a <a class="reference external" href="https://packaging.python.org/en/latest/specifications/source-distribution-format/#source-distribution-format-sdist" title="(in Python Packaging User Guide)"><span>Source distribution file name</span></a> for the
package.</li>
<li>Tools MAY choose to not support sdist files, both from a locking
and/or installation perspective.</li>
<li>Tools SHOULD provide a way for users to opt in/out of using sdist files.</li>
</ul>
<section id="packages-sdist-name">
<h6><a class="toc-backref" href="#packages-sdist-name" role="doc-backlink"><code class="docutils literal notranslate"><span class="pre">packages.sdist.name</span></code></a></h6>
<ul class="simple">
<li><strong>Type</strong>: string</li>
<li><strong>Required?</strong>: no, not when the last component of <code class="docutils literal notranslate"><span class="pre">path</span></code>/ <code class="docutils literal notranslate"><span class="pre">url</span></code> would be
the same value</li>
<li><strong>Inspiration</strong>: <a class="reference external" href="https://pypi.org/project/pdm/">PDM</a>, <a class="reference external" href="https://python-poetry.org/">Poetry</a>, <a class="reference external" href="https://github.com/astral-sh/uv">uv</a></li>
<li>The file name of the <a class="reference external" href="https://packaging.python.org/en/latest/specifications/source-distribution-format/#source-distribution-format-sdist" title="(in Python Packaging User Guide)"><span>Source distribution file name</span></a> file.</li>
</ul>
</section>
<section id="packages-sdist-upload-time">
<h6><a class="toc-backref" href="#packages-sdist-upload-time" role="doc-backlink"><code class="docutils literal notranslate"><span class="pre">packages.sdist.upload-time</span></code></a></h6>
<p>See <code class="docutils literal notranslate"><span class="pre">packages.archive.upload-time</span></code>.</p>
</section>
<section id="packages-sdist-url">
<h6><a class="toc-backref" href="#packages-sdist-url" role="doc-backlink"><code class="docutils literal notranslate"><span class="pre">packages.sdist.url</span></code></a></h6>
<p>See <code class="docutils literal notranslate"><span class="pre">packages.archive.url</span></code>.</p>
</section>
<section id="packages-sdist-path">
<h6><a class="toc-backref" href="#packages-sdist-path" role="doc-backlink"><code class="docutils literal notranslate"><span class="pre">packages.sdist.path</span></code></a></h6>
<p>See <code class="docutils literal notranslate"><span class="pre">packages.archive.path</span></code>.</p>
</section>
<section id="packages-sdist-size">
<h6><a class="toc-backref" href="#packages-sdist-size" role="doc-backlink"><code class="docutils literal notranslate"><span class="pre">packages.sdist.size</span></code></a></h6>
<p>See <code class="docutils literal notranslate"><span class="pre">packages.archive.size</span></code>.</p>
</section>
<section id="packages-sdist-hashes">
<h6><a class="toc-backref" href="#packages-sdist-hashes" role="doc-backlink"><code class="docutils literal notranslate"><span class="pre">packages.sdist.hashes</span></code></a></h6>
<p>See <code class="docutils literal notranslate"><span class="pre">packages.archive.hashes</span></code>.</p>
</section>
</section>
<section id="packages-wheels">
<h5><a class="toc-backref" href="#packages-wheels" role="doc-backlink"><code class="docutils literal notranslate"><span class="pre">[[packages.wheels]]</span></code></a></h5>
<ul class="simple">
<li><strong>Type</strong>: array of tables</li>
<li><strong>Required?</strong>: no; mutually-exclusive with <code class="docutils literal notranslate"><span class="pre">packages.vcs</span></code>,
<code class="docutils literal notranslate"><span class="pre">packages.directory</span></code>, and <code class="docutils literal notranslate"><span class="pre">packages.archive</span></code></li>
<li><strong>Inspiration</strong>: <a class="reference external" href="https://pypi.org/project/pdm/">PDM</a>, <a class="reference external" href="https://python-poetry.org/">Poetry</a>, <a class="reference external" href="https://github.com/astral-sh/uv">uv</a></li>
<li>For recording the wheel files as specified by
<a class="reference external" href="https://packaging.python.org/en/latest/specifications/binary-distribution-format/#binary-distribution-format" title="(in Python Packaging User Guide)"><span>Binary distribution format</span></a> for the package.</li>
<li>Tools MUST support wheel files, both from a locking and installation
perspective.</li>
</ul>
<section id="packages-wheels-name">
<h6><a class="toc-backref" href="#packages-wheels-name" role="doc-backlink"><code class="docutils literal notranslate"><span class="pre">packages.wheels.name</span></code></a></h6>
<ul class="simple">
<li><strong>Type</strong>: string</li>
<li><strong>Required?</strong>: no, not when the last component of <code class="docutils literal notranslate"><span class="pre">path</span></code>/ <code class="docutils literal notranslate"><span class="pre">url</span></code> would be
the same value</li>
<li><strong>Inspiration</strong>: <a class="reference external" href="https://pypi.org/project/pdm/">PDM</a>, <a class="reference external" href="https://python-poetry.org/">Poetry</a>, <a class="reference external" href="https://github.com/astral-sh/uv">uv</a></li>
<li>The file name of the <a class="reference external" href="https://packaging.python.org/en/latest/specifications/binary-distribution-format/#binary-distribution-format" title="(in Python Packaging User Guide)"><span>Binary distribution format</span></a> file.</li>
</ul>
</section>
<section id="packages-wheels-upload-time">
<h6><a class="toc-backref" href="#packages-wheels-upload-time" role="doc-backlink"><code class="docutils literal notranslate"><span class="pre">packages.wheels.upload-time</span></code></a></h6>
<p>See <code class="docutils literal notranslate"><span class="pre">packages.archive.upload-time</span></code>.</p>
</section>
<section id="packages-wheels-url">
<h6><a class="toc-backref" href="#packages-wheels-url" role="doc-backlink"><code class="docutils literal notranslate"><span class="pre">packages.wheels.url</span></code></a></h6>
<p>See <code class="docutils literal notranslate"><span class="pre">packages.archive.url</span></code>.</p>
</section>
<section id="packages-wheels-path">
<h6><a class="toc-backref" href="#packages-wheels-path" role="doc-backlink"><code class="docutils literal notranslate"><span class="pre">packages.wheels.path</span></code></a></h6>
<p>See <code class="docutils literal notranslate"><span class="pre">packages.archive.path</span></code>.</p>
</section>
<section id="packages-wheels-size">
<h6><a class="toc-backref" href="#packages-wheels-size" role="doc-backlink"><code class="docutils literal notranslate"><span class="pre">packages.wheels.size</span></code></a></h6>
<p>See <code class="docutils literal notranslate"><span class="pre">packages.archive.size</span></code>.</p>
</section>
<section id="packages-wheels-hashes">
<h6><a class="toc-backref" href="#packages-wheels-hashes" role="doc-backlink"><code class="docutils literal notranslate"><span class="pre">packages.wheels.hashes</span></code></a></h6>
<p>See <code class="docutils literal notranslate"><span class="pre">packages.archive.hashes</span></code>.</p>
</section>
</section>
<section id="packages-attestation-identities">
<h5><a class="toc-backref" href="#packages-attestation-identities" role="doc-backlink"><code class="docutils literal notranslate"><span class="pre">[[packages.attestation-identities]]</span></code></a></h5>
<ul class="simple">
<li><strong>Type</strong>: array of tables</li>
<li><strong>Required?</strong>: no</li>
<li><strong>Inspiration</strong>: <a class="reference external" href="https://packaging.python.org/en/latest/specifications/index-hosted-attestations/#provenance-object" title="(in Python Packaging User Guide)"><span>Provenance objects</span></a></li>
<li>A recording of the attestations for <strong>any</strong> file recorded for this package.</li>
<li>If available, tools SHOULD include the attestation identities found.</li>
<li>Publisher-specific keys are to be included in the table as-is
(i.e. top-level), following the spec at
<a class="reference external" href="https://packaging.python.org/en/latest/specifications/index-hosted-attestations/#index-hosted-attestations" title="(in Python Packaging User Guide)"><span>Index hosted attestations</span></a>.</li>
</ul>
<section id="packages-attestation-identities-kind">
<h6><a class="toc-backref" href="#packages-attestation-identities-kind" role="doc-backlink"><code class="docutils literal notranslate"><span class="pre">packages.attestation-identities.kind</span></code></a></h6>
<ul class="simple">
<li><strong>Type</strong>: string</li>
<li><strong>Required?</strong>: yes</li>
<li><strong>Inspiration</strong>: <a class="reference external" href="https://packaging.python.org/en/latest/specifications/index-hosted-attestations/#provenance-object" title="(in Python Packaging User Guide)"><span>Provenance objects</span></a></li>
<li>The unique identity of the Trusted Publisher.</li>
</ul>
</section>
</section>
<section id="packages-tool">
<h5><a class="toc-backref" href="#packages-tool" role="doc-backlink"><code class="docutils literal notranslate"><span class="pre">[packages.tool]</span></code></a></h5>
<ul class="simple">
<li><strong>Type</strong>: table</li>
<li><strong>Required?</strong>: no</li>
<li><strong>Inspiration</strong>: <a class="reference external" href="https://packaging.python.org/en/latest/specifications/pyproject-toml/#pyproject-tool-table" title="(in Python Packaging User Guide)"><span>Arbitrary tool configuration: the [tool] table</span></a></li>
<li>Similar usage as that of the <code class="docutils literal notranslate"><span class="pre">[tool]</span></code> table from the
<a class="reference external" href="https://packaging.python.org/en/latest/specifications/pyproject-toml/#pyproject-toml-spec" title="(in Python Packaging User Guide)"><span>pyproject.toml specification</span></a>, but at the package version level instead
of at the lock file level (which is also available via <code class="docutils literal notranslate"><span class="pre">[tool]</span></code>).</li>
<li>Data recorded in the table MUST be disposable (i.e. it MUST NOT affect
installation).</li>
</ul>
</section>
</section>
<section id="tool">
<h4><a class="toc-backref" href="#tool" role="doc-backlink"><code class="docutils literal notranslate"><span class="pre">[tool]</span></code></a></h4>
<ul class="simple">
<li><strong>Type</strong>: table</li>
<li><strong>Required?</strong>: no</li>
<li><strong>Inspiration</strong>: <a class="reference external" href="https://packaging.python.org/en/latest/specifications/pyproject-toml/#pyproject-tool-table" title="(in Python Packaging User Guide)"><span>Arbitrary tool configuration: the [tool] table</span></a></li>
<li>See <code class="docutils literal notranslate"><span class="pre">packages.tool</span></code>.</li>
</ul>
</section>
</section>
<section id="additions-to-marker-expression-syntax">
<h3><a class="toc-backref" href="#additions-to-marker-expression-syntax" role="doc-backlink">Additions to marker expression syntax</a></h3>
<p>This PEP proposes adding to the
<a class="reference external" href="https://packaging.python.org/en/latest/specifications/dependency-specifiers/#dependency-specifiers-environment-markers" title="(in Python Packaging User Guide)"><span>Environment Markers</span></a> specification such
that extras and dependency group relationships for an entry in <code class="docutils literal notranslate"><span class="pre">[[packages]]</span></code>
can be expressed in <code class="docutils literal notranslate"><span class="pre">packages.marker</span></code>. The additions outlined in this PEP
ONLY apply in the context of lock files as defined by this PEP and not in other
contexts where marker syntax is used (e.g. <code class="docutils literal notranslate"><span class="pre">METADATA</span></code>, <code class="docutils literal notranslate"><span class="pre">pyproject.toml</span></code>).</p>
<p>First, two new markers will be introduced: <code class="docutils literal notranslate"><span class="pre">extras</span></code> and
<code class="docutils literal notranslate"><span class="pre">dependency_groups</span></code>. They represent the extras and dependency groups that have
been requested to be installed, respectively:</p>
<div class="highlight-diff notranslate"><div class="highlight"><pre><span></span><span class="gh">diff --git a/source/specifications/dependency-specifiers.rst b/source/specifications/dependency-specifiers.rst</span>
<span class="gh">index 06897da2..c9ab247f 100644</span>
<span class="gd">--- a/source/specifications/dependency-specifiers.rst</span>
<span class="gi">+++ b/source/specifications/dependency-specifiers.rst</span>
<span class="gu">@@ -87,7 +87,7 @@ environments::</span>
<span class="w"> </span>                     &#39;platform_system&#39; | &#39;platform_version&#39; |
<span class="w"> </span>                     &#39;platform_machine&#39; | &#39;platform_python_implementation&#39; |
<span class="w"> </span>                     &#39;implementation_name&#39; | &#39;implementation_version&#39; |
<span class="gd">-                     &#39;extra&#39; # ONLY when defined by a containing layer</span>
<span class="gi">+                     &#39;extra&#39; | &#39;extras&#39; | &#39;dependency_groups&#39; # ONLY when defined by a containing layer</span>
<span class="w"> </span>                     )
<span class="w"> </span>   marker_var    = wsp* (env_var | python_str)
<span class="w"> </span>   marker_expr   = marker_var marker_op marker_var
</pre></div>
</div>
<p>This does NOT preclude using the same syntax parser in other contexts, only
where the new markers happen to be considered valid based on context.</p>
<p>Second, the marker specification will be changed to allow sets for values (on
top of the current support for strings and versions). ONLY the new markers
introduced in this PEP will allow for a set for their value (which defaults to
an empty set). This specifically does NOT update the spec to allow for set
literals.</p>
<p>Third, the marker expression syntax specification will be updated to allow for
operations involving sets:</p>
<div class="highlight-diff notranslate"><div class="highlight"><pre><span></span><span class="gh">diff --git a/source/specifications/dependency-specifiers.rst b/source/specifications/dependency-specifiers.rst</span>
<span class="gh">index 06897da2..ac29d796 100644</span>
<span class="gd">--- a/source/specifications/dependency-specifiers.rst</span>
<span class="gi">+++ b/source/specifications/dependency-specifiers.rst</span>
<span class="gu">@@ -196,15 +196,16 @@ safely evaluate it without running arbitrary code that could become a security</span>
vulnerability. Markers were first standardised in :pep:`345`. This document
fixes some issues that were observed in the design described in :pep:`426`.

<span class="gd">-Comparisons in marker expressions are typed by the comparison operator.  The</span>
<span class="gd">-&lt;marker_op&gt; operators that are not in &lt;version_cmp&gt; perform the same as they</span>
<span class="gd">-do for strings in Python. The &lt;version_cmp&gt; operators use the version comparison</span>
<span class="gd">-rules of the :ref:`Version specifier specification &lt;version-specifiers&gt;`</span>
<span class="gd">-when those are defined (that is when both sides have a valid</span>
<span class="gd">-version specifier). If there is no defined behaviour of this specification</span>
<span class="gd">-and the operator exists in Python, then the operator falls back to</span>
<span class="gd">-the Python behaviour. Otherwise an error should be raised. e.g. the following</span>
<span class="gd">-will result in  errors::</span>
<span class="gi">+Comparisons in marker expressions are typed by the comparison operator and the</span>
<span class="gi">+type of the marker value. The &lt;marker_op&gt; operators that are not in</span>
<span class="gi">+&lt;version_cmp&gt; perform the same as they do for strings or sets in Python based on</span>
<span class="gi">+whether the marker value is a string or set itself. The &lt;version_cmp&gt; operators</span>
<span class="gi">+use the version comparison rules of the</span>
<span class="gi">+:ref:`Version specifier specification &lt;version-specifiers&gt;` when those are</span>
<span class="gi">+defined (that is when both sides have a valid version specifier). If there is no</span>
<span class="gi">+defined behaviour of this specification and the operator exists in Python, then</span>
<span class="gi">+the operator falls back to the Python behaviour for the types involved.</span>
<span class="gi">+Otherwise an error should be raised. e.g. the following will result in errors::</span>

<span class="w"> </span>   &quot;dog&quot; ~= &quot;fred&quot;
<span class="w"> </span>   python_version ~= &quot;surprise&quot;
</pre></div>
</div>
<p>Fourth, use of <code class="docutils literal notranslate"><span class="pre">extras</span></code> and <code class="docutils literal notranslate"><span class="pre">dependency_groups</span></code> will be considered an
error outside of lock file (much like <code class="docutils literal notranslate"><span class="pre">extra</span></code> outside of
<a class="reference external" href="https://packaging.python.org/en/latest/specifications/core-metadata/#core-metadata" title="(in Python Packaging User Guide)"><span>Core metadata specifications</span></a>).</p>
<div class="highlight-diff notranslate"><div class="highlight"><pre><span></span><span class="gh">diff --git a/source/specifications/dependency-specifiers.rst b/source/specifications/dependency-specifiers.rst</span>
<span class="gh">index 06897da2..2914ef66 100644</span>
<span class="gd">--- a/source/specifications/dependency-specifiers.rst</span>
<span class="gi">+++ b/source/specifications/dependency-specifiers.rst</span>
<span class="gu">@@ -235,6 +235,11 @@ no current specification for this. Regardless, outside of a context where this</span>
special handling is taking place, the &quot;extra&quot; variable should result in an
error like all other unknown variables.

<span class="gi">+The &quot;extras&quot; and &quot;dependency_groups&quot; variables are also special. They are used</span>
<span class="gi">+to specify any requested extras or dependency groups when installing from a lock</span>
<span class="gi">+file. Outside of the context of lock files, these two variables should result in</span>
<span class="gi">+an error like all other unknown variables.</span>
<span class="gi">+</span>
.. list-table::
<span class="w"> </span>   :header-rows: 1
</pre></div>
</div>
<p>These changes, along with <code class="docutils literal notranslate"><span class="pre">packages.extras</span></code>/ <code class="docutils literal notranslate"><span class="pre">packages.dependency-groups</span></code>
and marker expressions’ Boolean logic support, allow for expressing arbitrary,
exhaustive requirements for when a package should be installed based on the
extras and dependency groups (not) requested. For example, if a lock file has
<code class="docutils literal notranslate"><span class="pre">extras</span> <span class="pre">=</span> <span class="pre">[&quot;extra-1&quot;,</span> <span class="pre">&quot;extra-2&quot;]</span></code>, you can specify if a package should be
installed when:</p>
<ul class="simple">
<li>Any of the extras are specified
(<code class="docutils literal notranslate"><span class="pre">'extra-1'</span> <span class="pre">in</span> <span class="pre">extras</span> <span class="pre">or</span> <span class="pre">'extra-2'</span> <span class="pre">in</span> <span class="pre">extras</span></code>)</li>
<li>Only “extra-1” is specified
(<code class="docutils literal notranslate"><span class="pre">'extra-1'</span> <span class="pre">in</span> <span class="pre">extras</span> <span class="pre">and</span> <span class="pre">'extra-2'</span> <span class="pre">not</span> <span class="pre">in</span> <span class="pre">extras</span></code>)</li>
<li>None of the extras are specified
(<code class="docutils literal notranslate"><span class="pre">'extra-1'</span> <span class="pre">not</span> <span class="pre">in</span> <span class="pre">extras</span> <span class="pre">and</span> <span class="pre">'extra-2'</span> <span class="pre">not</span> <span class="pre">in</span> <span class="pre">extras</span></code>)</li>
</ul>
<p>(This list is not exhaustive of all possible Boolean logic expressions.)</p>
<p>The same flexibility applies to dependency groups.</p>
<p>How users tell a tool what extras and/or dependency groups they want installed
is up to the tool. Installers MUST support the marker expression syntax
additions as proposed by this PEP. Lockers MAY support writing lock files that
utilize the proposed marker expression syntax additions (i.e. lockers can choose
to only support writing single-use lock files).</p>
</section>
<section id="example">
<h3><a class="toc-backref" href="#example" role="doc-backlink">Example</a></h3>
<div class="highlight-TOML notranslate"><div class="highlight"><pre><span></span><span class="n">lock-version</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;1.0&#39;</span>
<span class="n">environments</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;sys_platform == &#39;win32&#39;&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;sys_platform == &#39;linux&#39;&quot;</span><span class="p">]</span>
<span class="n">requires-python</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;==3.12&#39;</span>
<span class="n">created-by</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;mousebender&#39;</span>

<span class="k">[[packages]]</span>
<span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;attrs&#39;</span>
<span class="n">version</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;25.1.0&#39;</span>
<span class="n">requires-python</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;&gt;=3.8&#39;</span>
<span class="n">wheels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
<span class="w">  </span><span class="p">{</span><span class="n">name</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s1">&#39;attrs-25.1.0-py3-none-any.whl&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">upload-time</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="ld">2025-01-25T11:30:10.164985+00:00</span><span class="p">,</span><span class="w"> </span><span class="n">url</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s1">&#39;https://files.pythonhosted.org/packages/fc/30/d4986a882011f9df997a55e6becd864812ccfcd821d64aac8570ee39f719/attrs-25.1.0-py3-none-any.whl&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">63152</span><span class="p">,</span><span class="w"> </span><span class="n">hashes</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">{</span><span class="n">sha256</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s1">&#39;c75a69e28a550a7e93789579c22aa26b0f5b83b75dc4e08fe092980051e1090a&#39;</span><span class="p">}},</span>
<span class="p">]</span>
<span class="k">[[packages.attestation-identities]]</span>
<span class="n">environment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;release-pypi&#39;</span>
<span class="n">kind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;GitHub&#39;</span>
<span class="n">repository</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;python-attrs/attrs&#39;</span>
<span class="n">workflow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;pypi-package.yml&#39;</span>

<span class="k">[[packages]]</span>
<span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;cattrs&#39;</span>
<span class="n">version</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;24.1.2&#39;</span>
<span class="n">requires-python</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;&gt;=3.8&#39;</span>
<span class="n">dependencies</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span><span class="n">name</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s1">&#39;attrs&#39;</span><span class="p">},</span>
<span class="p">]</span>
<span class="n">wheels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
<span class="w">  </span><span class="p">{</span><span class="n">name</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s1">&#39;cattrs-24.1.2-py3-none-any.whl&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">upload-time</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="ld">2024-09-22T14:58:34.812643+00:00</span><span class="p">,</span><span class="w"> </span><span class="n">url</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s1">&#39;https://files.pythonhosted.org/packages/c8/d5/867e75361fc45f6de75fe277dd085627a9db5ebb511a87f27dc1396b5351/cattrs-24.1.2-py3-none-any.whl&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">66446</span><span class="p">,</span><span class="w"> </span><span class="n">hashes</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">{</span><span class="n">sha256</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s1">&#39;67c7495b760168d931a10233f979b28dc04daf853b30752246f4f8471c6d68d0&#39;</span><span class="p">}},</span>
<span class="p">]</span>

<span class="k">[[packages]]</span>
<span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;numpy&#39;</span>
<span class="n">version</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;2.2.3&#39;</span>
<span class="n">requires-python</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;&gt;=3.10&#39;</span>
<span class="n">wheels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
<span class="w">  </span><span class="p">{</span><span class="n">name</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s1">&#39;numpy-2.2.3-cp312-cp312-win_amd64.whl&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">upload-time</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="ld">2025-02-13T16:51:21.821880+00:00</span><span class="p">,</span><span class="w"> </span><span class="n">url</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s1">&#39;https://files.pythonhosted.org/packages/42/6e/55580a538116d16ae7c9aa17d4edd56e83f42126cb1dfe7a684da7925d2c/numpy-2.2.3-cp312-cp312-win_amd64.whl&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">12626357</span><span class="p">,</span><span class="w"> </span><span class="n">hashes</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">{</span><span class="n">sha256</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s1">&#39;83807d445817326b4bcdaaaf8e8e9f1753da04341eceec705c001ff342002e5d&#39;</span><span class="p">}},</span>
<span class="w">  </span><span class="p">{</span><span class="n">name</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s1">&#39;numpy-2.2.3-cp312-cp312-manylinux_2_17_x86_64.manylinux2014_x86_64.whl&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">upload-time</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="ld">2025-02-13T16:50:00.079662+00:00</span><span class="p">,</span><span class="w"> </span><span class="n">url</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s1">&#39;https://files.pythonhosted.org/packages/39/04/78d2e7402fb479d893953fb78fa7045f7deb635ec095b6b4f0260223091a/numpy-2.2.3-cp312-cp312-manylinux_2_17_x86_64.manylinux2014_x86_64.whl&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">16116679</span><span class="p">,</span><span class="w"> </span><span class="n">hashes</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">{</span><span class="n">sha256</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s1">&#39;3b787adbf04b0db1967798dba8da1af07e387908ed1553a0d6e74c084d1ceafe&#39;</span><span class="p">}},</span>
<span class="p">]</span>

<span class="k">[tool.mousebender]</span>
<span class="n">command</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;lock&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;--platform&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;cpython3.12-windows-x64&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;--platform&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;cpython3.12-manylinux2014-x64&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;cattrs&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;numpy&#39;</span><span class="p">]</span>
<span class="n">run-on</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ld">2025-03-06T12:28:57.760769</span>
</pre></div>
</div>
</section>
<section id="installation">
<h3><a class="toc-backref" href="#installation" role="doc-backlink">Installation</a></h3>
<p>The following outlines the steps to be taken to install from a lock file
(while the requirements are prescriptive, the general steps and order are
a suggestion):</p>
<ol class="arabic simple">
<li>Gather the extras and dependency groups to install and set <code class="docutils literal notranslate"><span class="pre">extras</span></code> and
<code class="docutils literal notranslate"><span class="pre">dependency_groups</span></code> for marker evaluation, respectively.<ol class="arabic simple">
<li><code class="docutils literal notranslate"><span class="pre">extras</span></code> SHOULD be set to the empty set by default.</li>
<li><code class="docutils literal notranslate"><span class="pre">dependency_groups</span></code> SHOULD be the set created from <code class="docutils literal notranslate"><span class="pre">default-groups</span></code> by
default.</li>
</ol>
</li>
<li>Check if the metadata version specified by <code class="docutils literal notranslate"><span class="pre">lock-version</span></code> is supported;
an error or warning MUST be raised as appropriate.</li>
<li>If <code class="docutils literal notranslate"><span class="pre">requires-python</span></code> is specified, check that the environment being
installed for meets the requirement; an error MUST be raised if it is not
met.</li>
<li>If <code class="docutils literal notranslate"><span class="pre">environments</span></code> is specified, check that at least one of the environment
marker expressions is satisfied; an error MUST be raised if no expression is
satisfied.</li>
<li>For each package listed in <code class="docutils literal notranslate"><span class="pre">[[packages]]</span></code>:<ol class="arabic simple">
<li>If <code class="docutils literal notranslate"><span class="pre">marker</span></code> is specified, check if it is satisfied; if it isn’t,
skip to the next package.</li>
<li>If <code class="docutils literal notranslate"><span class="pre">requires-python</span></code> is specified, check if it is satisfied; an error
MUST be raised if it isn’t.</li>
<li>Check that no other conflicting instance of the package has been slated to
be installed; an error about the ambiguity MUST be raised otherwise.</li>
<li>Check that the source of the package is specified appropriately (i.e.
there are no conflicting sources in the package entry);
an error MUST be raised if any issues are found.</li>
<li>Add the package to the set of packages to install.</li>
</ol>
</li>
<li>For each package to be installed:<ul class="simple">
<li>If <code class="docutils literal notranslate"><span class="pre">vcs</span></code> is set:<ol class="arabic simple">
<li>Clone the repository to the commit ID specified in <code class="docutils literal notranslate"><span class="pre">commit-id</span></code>.</li>
<li>Build the package, respecting <code class="docutils literal notranslate"><span class="pre">subdirectory</span></code>.</li>
<li>Install.</li>
</ol>
</li>
<li>Else if <code class="docutils literal notranslate"><span class="pre">directory</span></code> is set:<ol class="arabic simple">
<li>Build the package, respecting <code class="docutils literal notranslate"><span class="pre">subdirectory</span></code>.</li>
<li>Install.</li>
</ol>
</li>
<li>Else if <code class="docutils literal notranslate"><span class="pre">archive</span></code> is set:<ol class="arabic simple">
<li>Get the file.</li>
<li>Validate the file size and hash.</li>
<li>Build the package, respecting <code class="docutils literal notranslate"><span class="pre">subdirectory</span></code>.</li>
<li>Install.</li>
</ol>
</li>
<li>Else if there are entries for <code class="docutils literal notranslate"><span class="pre">wheels</span></code>:<ol class="arabic simple">
<li>Look for the appropriate wheel file based on <code class="docutils literal notranslate"><span class="pre">name</span></code>; if one is not
found then move on to <code class="docutils literal notranslate"><span class="pre">sdist</span></code> or an error MUST be raised about a
lack of source for the project.</li>
<li>Get the file:<ul>
<li>If <code class="docutils literal notranslate"><span class="pre">path</span></code> is set, use it.</li>
<li>If <code class="docutils literal notranslate"><span class="pre">url</span></code> is set, try to use it; optionally tools MAY use
<code class="docutils literal notranslate"><span class="pre">packages.index</span></code> or some tool-specific mechanism to download the
selected wheel file (tools MUST NOT try to change what wheel file to
download based on what’s available; what file to install should be
determined in an offline fashion for reproducibility).</li>
</ul>
</li>
<li>Validate the file size and hash.</li>
<li>Install.</li>
</ol>
</li>
<li>Else if no <code class="docutils literal notranslate"><span class="pre">wheel</span></code> file is found or <code class="docutils literal notranslate"><span class="pre">sdist</span></code> is solely set:<ol class="arabic simple">
<li>Get the file.<ul>
<li>If <code class="docutils literal notranslate"><span class="pre">path</span></code> is set, use it.</li>
<li>If <code class="docutils literal notranslate"><span class="pre">url</span></code> is set, try to use it; tools MAY use
<code class="docutils literal notranslate"><span class="pre">packages.index</span></code> or some tool-specific mechanism to download the
file.</li>
</ul>
</li>
<li>Validate the file size and hash.</li>
<li>Build the package.</li>
<li>Install.</li>
</ol>
</li>
</ul>
</li>
</ol>
</section>
<section id="semantic-differences-with-requirements-txt-files">
<h3><a class="toc-backref" href="#semantic-differences-with-requirements-txt-files" role="doc-backlink">Semantic differences with <code class="docutils literal notranslate"><span class="pre">requirements.txt</span></code> files</a></h3>
<p>Ignoring formatting, there are a few differences between lock files as proposed
by this PEP and those that are possible via a <a class="reference external" href="https://pip.pypa.io/en/stable/reference/requirements-file-format/">requirements file</a>.</p>
<p>Some of the differences are in regards to security. Requiring hashes, recording
file sizes, and where a file was found – both the index and the location of the
file itself – help with auditing and validating the files that were locked
against. Compare that with requirements files which can optionally include
hashes, but it is an opt-in feature and can be bypassed. The optional inclusion
of a file’s upload time and where the files can be found is also different.</p>
<p>Being explicit about the supported Python versions and environments for the file
overall is also unique to this PEP. This is to alleviate the issue of not
knowing when a requirements file targets a specific platform.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">[tool]</span></code> tables don’t have a direct correlation in requirements files.
They do support comments, but they are not inherently structured like the
<code class="docutils literal notranslate"><span class="pre">[tool]</span></code> table is thanks to being in TOML.</p>
<p>While comments in a requirements file could record details that are helpful for
auditing and understanding what the lock file contains, providing the structured
support to record such things makes auditing easier. Recording the required
Python version for a package upfront helps with this as well as erroring out
sooner if an install is going to fail. Recording the wheel file name separate
from the URL or path is also to help make reading the list of wheel files easier
as it encodes information that can be useful when understanding and auditing a
file. Recording the sdist file name is for the same reason.</p>
<p>This PEP supports multi-use lock files while requirements files are single-use.</p>
<p>This PEP does NOT fully replace requirements files because:</p>
<ul class="simple">
<li>They support specifying installation
<a class="reference external" href="https://pip.pypa.io/en/stable/reference/requirements-file-format/#supported-options">options</a>
at install-time (e.g. <code class="docutils literal notranslate"><span class="pre">--index-url</span></code>, <code class="docutils literal notranslate"><span class="pre">--constraint</span></code>).</li>
<li>They can
<a class="reference external" href="https://pip.pypa.io/en/stable/reference/requirements-file-format/#referring-to-other-requirements-files">reference other requirements files</a>
via <code class="docutils literal notranslate"><span class="pre">-r</span></code>.</li>
<li>They can
<a class="reference external" href="https://pip.pypa.io/en/stable/reference/requirements-file-format/#using-environment-variables">use environment variables</a> .</li>
</ul>
</section>
</section>
<section id="backwards-compatibility">
<h2><a class="toc-backref" href="#backwards-compatibility" role="doc-backlink">Backwards Compatibility</a></h2>
<p>Because there is no preexisting lock file format, there are no explicit
backwards-compatibility concerns in terms of Python packaging standards.</p>
<p>As for packaging tools themselves, that will be a per-tool decision as to
whether they choose to support this PEP and in what way (i.e. as an export
target or as the primary way they record their lock file).</p>
</section>
<section id="security-implications">
<h2><a class="toc-backref" href="#security-implications" role="doc-backlink">Security Implications</a></h2>
<p>The hope is that by standardizing on a lock file format which starts from a
security-first posture it will help make overall packaging installation safer.
However, this PEP does not solve all potential security concerns.</p>
<p>One potential concern is tampering with a lock file. If a lock file is not kept
in source control and properly audited, a bad actor could change the file in
nefarious ways (e.g., point to a malware version of a package). Tampering could
also occur in transit to e.g. a cloud provider who will perform an installation
on the user’s behalf. Both could be mitigated by signing the lock file either
within the file in a <code class="docutils literal notranslate"><span class="pre">[tool]</span></code> entry or via a side channel external to the lock
file itself.</p>
<p>This PEP does not do anything to prevent a user from installing incorrect
packages. While including many details to help in auditing a package’s inclusion,
there isn’t any mechanism to stop e.g. name confusion attacks via
typosquatting. Tools may be able to provide some UX to help with this (e.g. by
providing download counts for a package).</p>
</section>
<section id="how-to-teach-this">
<h2><a class="toc-backref" href="#how-to-teach-this" role="doc-backlink">How to Teach This</a></h2>
<p>Users should be informed that when they ask to install some package, the
package may have its own dependencies, those dependencies may have dependencies,
and so on. Without writing down what gets installed as part of installing the
package they requested, things could change from underneath them (e.g. package
versions). Changes to the underlying dependencies can lead to accidental
breakage of their code. Lock files help deal with that by providing a way to
write down what was installed so you can install the exact same thing in the
future.</p>
<p>Having what to install written down also helps in collaborating with others. By
agreeing to a lock file’s contents, everyone ends up with the same packages
installed. This helps make sure no one relies on e.g. an API that’s only
available in a certain version that not everyone working on the project has
installed.</p>
<p>Lock files also help with security by making sure you always get the same files
installed and not a malicious one that someone may have slipped in. It also
lets one be more deliberate in upgrading their dependencies and thus making sure
the change is on purpose and not one slipped in by a bad actor.</p>
<p>Lock files can support only certain <em>environments</em>. What must be installed for
the environment they are installing for may be different compared to another,
different environment. Some lock files do try to be <em>universal</em>, though, and
work for any possible environment (sdist and source tree installation success
permitting).</p>
<p>Lock files can be <em>single-use</em> or <em>multi-use</em>. Single-use lock files are for
single use-cases. Multi-use lock files can be used for multiple
use-cases based on extras and dependency groups. It is up to the tool(s) you use
that decide whether multi-use lock files are possible. All tools dealing with
lock files at least support single-use lock files. Neither type of lock file
is better or worse than the other, it just changes how much can be written down
in a single file.</p>
<p>Lock files that follow this PEP can be installed by any installer that
implements the specification. This allows users of a lock file to perform an
installation to not be tied to the locker used by the person who produced the
lock file. But it is not the case that using a different locker will lead to the
same result. This could be for various reasons, including using different
algorithms to determine what to lock.</p>
</section>
<section id="reference-implementation">
<h2><a class="toc-backref" href="#reference-implementation" role="doc-backlink">Reference Implementation</a></h2>
<p>A proof-of-concept implementing single-use lock files can be found at
<a class="reference external" href="https://github.com/brettcannon/mousebender/tree/pep">https://github.com/brettcannon/mousebender/tree/pep</a> . Other tools such as
<a class="reference external" href="https://pypi.org/project/pdm/">PDM</a> and <a class="reference external" href="https://python-poetry.org/">Poetry</a> implement semantically similar approaches of various parts of
this PEP.</p>
</section>
<section id="rejected-ideas">
<h2><a class="toc-backref" href="#rejected-ideas" role="doc-backlink">Rejected Ideas</a></h2>
<section id="recording-the-dependency-graph-for-installation-purposes">
<h3><a class="toc-backref" href="#recording-the-dependency-graph-for-installation-purposes" role="doc-backlink">Recording the dependency graph for installation purposes</a></h3>
<p>A previous version of this PEP recorded the dependency graph of packages instead
of a set of packages to install. The idea was that by recording the dependency
graph you not only got more information, but it provided more flexibility by
supporting more features innately (e.g. platform-specific dependencies without
explicitly propagating markers).</p>
<p>In the end, though, it was deemed to add complexity that wasn’t worth the cost
(e.g. it impacted the ease of auditing for details which were not necessary
for this PEP to reach its goals).</p>
</section>
<section id="specifying-a-new-core-metadata-version-that-requires-consistent-metadata-across-files">
<h3><a class="toc-backref" href="#specifying-a-new-core-metadata-version-that-requires-consistent-metadata-across-files" role="doc-backlink">Specifying a new core metadata version that requires consistent metadata across files</a></h3>
<p>At one point, to handle the issue of metadata varying between files and thus
require examining every released file for a package and version for accurate
locking results, the idea was floated to introduce a new core metadata version
which would require all metadata for all wheel files be the same for a single
version of a package. Ultimately, though, it was deemed unnecessary as this PEP
will put pressure on people to make files consistent for performance reasons or
to make indexes provide all the metadata separate from the wheel files
themselves. As well, there’s no easy enforcement mechanism, and so community
expectation would work as well as a new metadata version.</p>
</section>
<section id="have-the-installer-do-dependency-resolution">
<h3><a class="toc-backref" href="#have-the-installer-do-dependency-resolution" role="doc-backlink">Have the installer do dependency resolution</a></h3>
<p>In order to support a format more akin to how Poetry worked when this PEP was
drafted, it was suggested that lockers effectively record the packages and their
versions which may be necessary to make an install work in any possible
scenario, and then the installer resolves what to install. But that complicates
auditing a lock file by requiring much more mental effort to know what packages
may be installed in any given scenario. Also, one of the Poetry developers
<a class="reference external" href="https://discuss.python.org/t/lock-files-again-but-this-time-w-sdists/46593/83">suggested</a>
that markers as represented in the package locking approach of this PEP may be
sufficient to cover the needs of Poetry. Not having the installer do a
resolution also simplifies their implementation, centralizing complexity in
lockers.</p>
</section>
<section id="requiring-minimum-hash-algorithm-support">
<h3><a class="toc-backref" href="#requiring-minimum-hash-algorithm-support" role="doc-backlink">Requiring minimum hash algorithm support</a></h3>
<p>It was proposed to require a baseline hash algorithm for the files. This was
rejected as no other Python packaging specification requires specific hash
algorithm support. As well, the minimum hash algorithm suggested may eventually
become an outdated/unsafe suggestion, requiring further updates. In order to
promote using the best algorithm at all times, no baseline is provided to avoid
simply defaulting to the baseline in tools without considering the security
ramifications of that hash algorithm.</p>
</section>
<section id="file-naming">
<h3><a class="toc-backref" href="#file-naming" role="doc-backlink">File naming</a></h3>
<section id="using-pylock-toml-as-the-file-name">
<h4><a class="toc-backref" href="#using-pylock-toml-as-the-file-name" role="doc-backlink">Using <code class="docutils literal notranslate"><span class="pre">*.pylock.toml</span></code> as the file name</a></h4>
<p>It was proposed to put the <code class="docutils literal notranslate"><span class="pre">pylock</span></code> constant part of the file name after the
identifier for the purpose of the lock file. It was decided not to do this so
that lock files would sort together when looking at directory contents instead
of purely based on their purpose which could spread them out in a directory.</p>
</section>
<section id="using-pylock-as-the-file-name">
<h4><a class="toc-backref" href="#using-pylock-as-the-file-name" role="doc-backlink">Using <code class="docutils literal notranslate"><span class="pre">*.pylock</span></code> as the file name</a></h4>
<p>Not using <code class="docutils literal notranslate"><span class="pre">.toml</span></code> as the file extension and instead making it <code class="docutils literal notranslate"><span class="pre">.pylock</span></code>
itself was proposed. This was decided against so that code editors would know
how to provide syntax highlighting to a lock file without having special
knowledge about the file extension.</p>
</section>
<section id="not-having-a-naming-convention-for-the-file">
<h4><a class="toc-backref" href="#not-having-a-naming-convention-for-the-file" role="doc-backlink">Not having a naming convention for the file</a></h4>
<p>Having no requirements or guidance for a lock file’s name was considered, but
ultimately rejected. By having a standardized naming convention it makes it easy
to identify a lock file for both a human and a code editor. This helps
facilitate discovery when e.g. a tool wants to know all of the lock files that
are available.</p>
</section>
</section>
<section id="id1">
<h3><a class="toc-backref" href="#id1" role="doc-backlink">File format</a></h3>
<section id="use-json-over-toml">
<h4><a class="toc-backref" href="#use-json-over-toml" role="doc-backlink">Use JSON over TOML</a></h4>
<p>Since having a format that is machine-writable was a goal of this PEP, it was
suggested to use JSON. But it was deemed less human-readable than TOML while
not improving on the machine-writable aspect enough to warrant the change.</p>
</section>
<section id="use-yaml-over-toml">
<h4><a class="toc-backref" href="#use-yaml-over-toml" role="doc-backlink">Use YAML over TOML</a></h4>
<p>Some argued that YAML met the machine-writable/human-readable requirement in a
better way than TOML. But as that’s subjective and <code class="docutils literal notranslate"><span class="pre">pyproject.toml</span></code> already
existed as the human-writable file used by Python packaging standards it was
deemed more important to keep using TOML.</p>
</section>
</section>
<section id="other-keys">
<h3><a class="toc-backref" href="#other-keys" role="doc-backlink">Other keys</a></h3>
<section id="a-single-hash-algorithm-for-the-whole-file">
<h4><a class="toc-backref" href="#a-single-hash-algorithm-for-the-whole-file" role="doc-backlink">A single hash algorithm for the whole file</a></h4>
<p>Earlier versions of this PEP proposed having a single hash algorithm be
specified per file instead of any number of algorithms per file. The thinking
was that by specifying a single algorithm it would help with auditing the file
when a specific hash algorithm was mandated for use.</p>
<p>In the end there was some objection to this idea. Typically, it centered around
the cost of rehashing large wheel files (e.g. PyTorch). There was also concern
about making hashing decisions upfront on the installer’s behalf which they may
disagree with. In the end it was deemed better to have flexibility and let
people audit the lock file as they see fit.</p>
</section>
<section id="hashing-the-contents-of-the-lock-file-itself">
<h4><a class="toc-backref" href="#hashing-the-contents-of-the-lock-file-itself" role="doc-backlink">Hashing the contents of the lock file itself</a></h4>
<p>Hashing the contents of the bytes of the file and storing hash value within the
file itself was proposed at some point. This was removed to make it easier
when merging changes to the lock file as each merge would have to recalculate
the hash value to avoid a merge conflict.</p>
<p>Hashing the semantic contents of the file was also proposed, but it would lead
to the same merge conflict issue.</p>
<p>Regardless of which contents were hashed, either approach could have the hash
value stored outside of the file if such a hash was desired.</p>
</section>
<section id="recording-the-creation-date-of-the-lock-file">
<h4><a class="toc-backref" href="#recording-the-creation-date-of-the-lock-file" role="doc-backlink">Recording the creation date of the lock file</a></h4>
<p>To know how potentially stale the lock file was, an earlier proposal suggested
recording the creation date of the lock file. But for the same merge conflict
reasons as storing the hash of the file contents, this idea was dropped.</p>
</section>
<section id="recording-the-package-indexes-used-in-searching">
<h4><a class="toc-backref" href="#recording-the-package-indexes-used-in-searching" role="doc-backlink">Recording the package indexes used in searching</a></h4>
<p>Recording what package indexes were used to create the lock file was considered.
In the end, though, it was rejected as it was deemed unnecessary bookkeeping.</p>
</section>
<section id="locking-build-requirements-for-sdists">
<h4><a class="toc-backref" href="#locking-build-requirements-for-sdists" role="doc-backlink">Locking build requirements for sdists</a></h4>
<p>An earlier version of this PEP tried to lock the build requirements for sdists
under a <code class="docutils literal notranslate"><span class="pre">packages.build-requires</span></code> key. Unfortunately, it confused enough people
about how it was expected to operate and there were enough edge case issues to
decide it wasn’t worth trying to do in this PEP upfront. Instead, a future PEP
could propose a solution.</p>
</section>
<section id="a-dedicated-direct-key">
<h4><a class="toc-backref" href="#a-dedicated-direct-key" role="doc-backlink">A dedicated <code class="docutils literal notranslate"><span class="pre">direct</span></code> key</a></h4>
<p>Earlier versions had a dedicated <code class="docutils literal notranslate"><span class="pre">packages.direct</span></code> key to flag when something
should be considered as originating from a
<a class="reference external" href="https://packaging.python.org/en/latest/specifications/direct-url/#direct-url" title="(in Python Packaging User Guide)"><span class="xref std std-ref">direct URL reference</span></a>. But there are explicitly
only three cases where a direct URL reference can occur (VCS, directory, and
archive). Since all three cases are explicit in <code class="docutils literal notranslate"><span class="pre">[[packages]]</span></code>, the setting of
the key was technically superfluous.</p>
<p>The single drawback of not having this key is for wheels and sdists that now
fall under <code class="docutils literal notranslate"><span class="pre">packages.archive</span></code>. With the separate key (or having it specified
as a part of <code class="docutils literal notranslate"><span class="pre">packages.sdist</span></code> or <code class="docutils literal notranslate"><span class="pre">packages.wheels</span></code>), it would allow for
identifying in the lock file itself that an archive file is an sdist or wheel.
As it currently stands, an installer must infer that detail itself.</p>
</section>
</section>
<section id="simplification">
<h3><a class="toc-backref" href="#simplification" role="doc-backlink">Simplification</a></h3>
<section id="drop-recording-the-package-version">
<h4><a class="toc-backref" href="#drop-recording-the-package-version" role="doc-backlink">Drop recording the package version</a></h4>
<p>The package version is optional since it can only be reliably recorded when an
sdist or wheel file is used. And since both sources record the version in file
names it is technically redundant.</p>
<p>But in discussions it was decided the version number is useful for auditing
enough to still state it separately.</p>
</section>
<section id="drop-the-requirement-to-specify-the-location-of-an-sdist-and-or-wheels">
<h4><a class="toc-backref" href="#drop-the-requirement-to-specify-the-location-of-an-sdist-and-or-wheels" role="doc-backlink">Drop the requirement to specify the location of an sdist and/or wheels</a></h4>
<p>At least one person has commented how their work has unstable URLs for all
sdists and wheels. As such, they have to search for all files at install
regardless of where the file was found previously. Dropping the requirement to
provide the URL or path to a file would have helped solve the issue of recording
known-bad information.</p>
<p>The decision to allow tools to look for a file in other ways beyond the URL
provided alleviated the need to make the URL optional.</p>
</section>
<section id="drop-requiring-file-size-and-hashes">
<h4><a class="toc-backref" href="#drop-requiring-file-size-and-hashes" role="doc-backlink">Drop requiring file size and hashes</a></h4>
<p>At least one person has said that their work modifies all wheels and sdists with
internal files. That means any recorded hashes and file sizes will be wrong. By
making the file size and hashes optional – very likely through some opt-out
mechanism – then they could continue to produce lock files that meet this PEP’s
requirements.</p>
<p>The decision was made that this weakens security too much. It also prevents
installing files from alternative locations.</p>
</section>
<section id="drop-recording-the-sdist-file-name">
<h4><a class="toc-backref" href="#drop-recording-the-sdist-file-name" role="doc-backlink">Drop recording the sdist file name</a></h4>
<p>While incompatible with dropping the URL/path requirement, the package
version, and hashes, recording the sdist file name is technically not necessary
at all (right now recording the file name is optional). The file name only
encodes the project name and version, so no new info is conveyed about the file
(when the package version is provided). And if the location is recorded then
getting the file is handled regardless of the file name.</p>
<p>But recording the file name can be helpful when looking for an appropriate file
when the recorded file location is no longer available (while sdist file names
are now standardized thanks to <a class="pep reference internal" href="../pep-0625/" title="PEP 625 – Filename of a Source Distribution">PEP 625</a>, that has only been true since 2020
and thus there are many older sdists with names that may not be guessable).</p>
<p>The decision was made to require the sdist file name out of simplicity.</p>
</section>
<section id="make-packages-wheels-a-table">
<h4><a class="toc-backref" href="#make-packages-wheels-a-table" role="doc-backlink">Make <code class="docutils literal notranslate"><span class="pre">packages.wheels</span></code> a table</a></h4>
<p>One could see writing out wheel file details as a table keyed on the file name.
For example:</p>
<div class="highlight-TOML notranslate"><div class="highlight"><pre><span></span><span class="k">[[packages]]</span>
<span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;attrs&quot;</span>
<span class="n">version</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;23.2.0&quot;</span>
<span class="n">requires-python</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;&gt;=3.7&quot;</span>
<span class="n">index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;https://pypi.org/simple/&quot;</span>

<span class="k">[packages.wheels]</span>
<span class="s2">&quot;attrs-23.2.0-py3-none-any.whl&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="n">upload-time</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="ld">2023-12-31T06:30:30.772444Z</span><span class="p">,</span><span class="w"> </span><span class="n">url</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s2">&quot;https://files.pythonhosted.org/packages/e0/44/827b2a91a5816512fcaf3cc4ebc465ccd5d598c45cefa6703fcf4a79018f/attrs-23.2.0-py3-none-any.whl&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">60752</span><span class="p">,</span><span class="w"> </span><span class="n">hashes</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">{</span><span class="n">sha256</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s2">&quot;99b87a485a5820b23b879f04c2305b44b951b502fd64be915879d77a7e8fc6f1&quot;</span><span class="p">}</span>

<span class="k">[[packages]]</span>
<span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;numpy&quot;</span>
<span class="n">version</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;2.0.1&quot;</span>
<span class="n">requires-python</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;&gt;=3.9&quot;</span>
<span class="n">index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;https://pypi.org/simple/&quot;</span>

<span class="k">[packages.wheels]</span>
<span class="s2">&quot;numpy-2.0.1-cp312-cp312-macosx_10_9_x86_64.whl&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="n">upload-time</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="ld">2024-07-21T13:37:15.810939Z</span><span class="p">,</span><span class="w"> </span><span class="n">url</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s2">&quot;https://files.pythonhosted.org/packages/64/1c/401489a7e92c30db413362756c313b9353fb47565015986c55582593e2ae/numpy-2.0.1-cp312-cp312-macosx_10_9_x86_64.whl&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">20965374</span><span class="p">,</span><span class="w"> </span><span class="n">hashes</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">{</span><span class="n">sha256</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s2">&quot;6bf4e6f4a2a2e26655717a1983ef6324f2664d7011f6ef7482e8c0b3d51e82ac&quot;</span><span class="p">}</span>
<span class="s2">&quot;numpy-2.0.1-cp312-cp312-macosx_11_0_arm64.whl&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="n">upload-time</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="ld">2024-07-21T13:37:36.460324Z</span><span class="p">,</span><span class="w"> </span><span class="n">url</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s2">&quot;https://files.pythonhosted.org/packages/08/61/460fb524bb2d1a8bd4bbcb33d9b0971f9837fdedcfda8478d4c8f5cfd7ee/numpy-2.0.1-cp312-cp312-macosx_11_0_arm64.whl&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">13102536</span><span class="p">,</span><span class="w"> </span><span class="n">hashes</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">{</span><span class="n">sha256</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s2">&quot;7d6fddc5fe258d3328cd8e3d7d3e02234c5d70e01ebe377a6ab92adb14039cb4&quot;</span><span class="p">}</span>
<span class="s2">&quot;numpy-2.0.1-cp312-cp312-macosx_14_0_arm64.whl&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="n">upload-time</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="ld">2024-07-21T13:37:46.601144Z</span><span class="p">,</span><span class="w"> </span><span class="n">url</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s2">&quot;https://files.pythonhosted.org/packages/c2/da/3d8debb409bc97045b559f408d2b8cefa6a077a73df14dbf4d8780d976b1/numpy-2.0.1-cp312-cp312-macosx_14_0_arm64.whl&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">5037809</span><span class="p">,</span><span class="w"> </span><span class="n">hashes</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">{</span><span class="n">sha256</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s2">&quot;5daab361be6ddeb299a918a7c0864fa8618af66019138263247af405018b04e1&quot;</span><span class="p">}</span>
<span class="s2">&quot;numpy-2.0.1-cp312-cp312-macosx_14_0_x86_64.whl&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="n">upload-time</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="ld">2024-07-21T13:37:58.784393Z</span><span class="p">,</span><span class="w"> </span><span class="n">url</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s2">&quot;https://files.pythonhosted.org/packages/6d/59/85160bf5f4af6264a7c5149ab07be9c8db2b0eb064794f8a7bf6d/numpy-2.0.1-cp312-cp312-macosx_14_0_x86_64.whl&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">6631813</span><span class="p">,</span><span class="w"> </span><span class="n">hashes</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">{</span><span class="n">sha256</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s2">&quot;ea2326a4dca88e4a274ba3a4405eb6c6467d3ffbd8c7d38632502eaae3820587&quot;</span><span class="p">}</span>
<span class="s2">&quot;numpy-2.0.1-cp312-cp312-manylinux_2_17_aarch64.manylinux2014_aarch64.whl&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="n">upload-time</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="ld">2024-07-21T13:38:19.714559Z</span><span class="p">,</span><span class="w"> </span><span class="n">url</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s2">&quot;https://files.pythonhosted.org/packages/5e/e3/944b77e2742fece7da8dfba6f7ef7dccdd163d1a613f7027f4d5b/numpy-2.0.1-cp312-cp312-manylinux_2_17_aarch64.manylinux2014_aarch64.whl&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">13623742</span><span class="p">,</span><span class="w"> </span><span class="n">hashes</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">{</span><span class="n">sha256</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s2">&quot;529af13c5f4b7a932fb0e1911d3a75da204eff023ee5e0e79c1751564221a5c8&quot;</span><span class="p">}</span>
<span class="s2">&quot;numpy-2.0.1-cp312-cp312-manylinux_2_17_x86_64.manylinux2014_x86_64.whl&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="n">upload-time</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="ld">2024-07-21T13:38:48.972569Z</span><span class="p">,</span><span class="w"> </span><span class="n">url</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s2">&quot;https://files.pythonhosted.org/packages/2c/f3/61eee37decb58e7cb29940f19a1464b8608f2cab8a8616aba75fd/numpy-2.0.1-cp312-cp312-manylinux_2_17_x86_64.manylinux2014_x86_64.whl&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">19242336</span><span class="p">,</span><span class="w"> </span><span class="n">hashes</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">{</span><span class="n">sha256</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s2">&quot;6790654cb13eab303d8402354fabd47472b24635700f631f041bd0b65e37298a&quot;</span><span class="p">}</span>
<span class="s2">&quot;numpy-2.0.1-cp312-cp312-musllinux_1_1_x86_64.whl&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="n">upload-time</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="ld">2024-07-21T13:39:19.213811Z</span><span class="p">,</span><span class="w"> </span><span class="n">url</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s2">&quot;https://files.pythonhosted.org/packages/77/b5/c74cc436114c1de5912cdb475145245f6e645a6a1a29b5d08c774/numpy-2.0.1-cp312-cp312-musllinux_1_1_x86_64.whl&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">19637264</span><span class="p">,</span><span class="w"> </span><span class="n">hashes</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">{</span><span class="n">sha256</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s2">&quot;cbab9fc9c391700e3e1287666dfd82d8666d10e69a6c4a09ab97574c0b7ee0a7&quot;</span><span class="p">}</span>
<span class="s2">&quot;numpy-2.0.1-cp312-cp312-musllinux_1_2_aarch64.whl&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="n">upload-time</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="ld">2024-07-21T13:39:41.812321Z</span><span class="p">,</span><span class="w"> </span><span class="n">url</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s2">&quot;https://files.pythonhosted.org/packages/da/89/c8856e12e0b3f6af371ccb90d604600923b08050c58f0cd26eac9/numpy-2.0.1-cp312-cp312-musllinux_1_2_aarch64.whl&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">14108911</span><span class="p">,</span><span class="w"> </span><span class="n">hashes</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">{</span><span class="n">sha256</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s2">&quot;99d0d92a5e3613c33a5f01db206a33f8fdf3d71f2912b0de1739894668b7a93b&quot;</span><span class="p">}</span>
<span class="s2">&quot;numpy-2.0.1-cp312-cp312-win32.whl&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="n">upload-time</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="ld">2024-07-21T13:39:52.932102Z</span><span class="p">,</span><span class="w"> </span><span class="n">url</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s2">&quot;https://files.pythonhosted.org/packages/15/96/310c6f6d146518479b0a6ee6eb92a537954ec3b1acfa2894d1347/numpy-2.0.1-cp312-cp312-win32.whl&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">6171379</span><span class="p">,</span><span class="w"> </span><span class="n">hashes</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">{</span><span class="n">sha256</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s2">&quot;173a00b9995f73b79eb0191129f2455f1e34c203f559dd118636858cc452a1bf&quot;</span><span class="p">}</span>
<span class="s2">&quot;numpy-2.0.1-cp312-cp312-win_amd64.whl&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="n">upload-time</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="ld">2024-07-21T13:40:17.532627Z</span><span class="p">,</span><span class="w"> </span><span class="n">url</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s2">&quot;https://files.pythonhosted.org/packages/b5/59/f6ad378ad85ed9c2785f271b39c3e5b6412c66e810d2c60934c9f/numpy-2.0.1-cp312-cp312-win_amd64.whl&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">16255757</span><span class="p">,</span><span class="w"> </span><span class="n">hashes</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">{</span><span class="n">sha256</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s2">&quot;bb2124fdc6e62baae159ebcfa368708867eb56806804d005860b6007388df171&quot;</span><span class="p">}</span>
</pre></div>
</div>
<p>In general, though, people did not prefer this over the approach this PEP has
taken.</p>
</section>
</section>
<section id="self-referential">
<h3><a class="toc-backref" href="#self-referential" role="doc-backlink">Self-Referential</a></h3>
<section id="drop-the-tool-table">
<h4><a class="toc-backref" href="#drop-the-tool-table" role="doc-backlink">Drop the <code class="docutils literal notranslate"><span class="pre">[tool]</span></code> table</a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">[tool]</span></code> table is included as it has been found to be very useful for
<code class="docutils literal notranslate"><span class="pre">pyproject.toml</span></code> files. Providing similar flexibility to this PEP is done in
hopes that similar benefits will materialize.</p>
<p>But some people have been concerned that such a table will be too enticing to
tools and will lead to files that are tool-specific and unusable by other
tools. This could cause issues for tools trying to do installation, auditing,
etc. as they would not know what details in the <code class="docutils literal notranslate"><span class="pre">[tool]</span></code> table are somehow
critical.</p>
<p>As a compromise, this PEP specifies that the details recorded in <code class="docutils literal notranslate"><span class="pre">[tool]</span></code> must
be disposable and not affect installation of packages.</p>
</section>
<section id="list-the-requirement-inputs-for-the-file">
<h4><a class="toc-backref" href="#list-the-requirement-inputs-for-the-file" role="doc-backlink">List the requirement inputs for the file</a></h4>
<p>Right now the file does not record the requirements that acted as inputs to the
file. This is for simplicity reasons and to not explicitly constrain the file
in some unforeseen way (e.g., updating the file after initial creation for a
new platform that has different requirements, all without having to resolve
how to write a comprehensive set of requirements).</p>
<p>But it may help in auditing and any recreation of the file if the original
requirements were somehow recorded. This could be a single string or an array
of strings if multiple requirements were used with the file.</p>
<p>In the end it was deemed too complicated to try and capture the inputs
that a tool used to construct the lock file in a generic fashion.</p>
</section>
</section>
<section id="auditing">
<h3><a class="toc-backref" href="#auditing" role="doc-backlink">Auditing</a></h3>
<section id="recording-dependents">
<h4><a class="toc-backref" href="#recording-dependents" role="doc-backlink">Recording dependents</a></h4>
<p>Recording the dependents of a package is not necessary to install it. As such,
it has been left out of the PEP as it can be included via <code class="docutils literal notranslate"><span class="pre">[tool]</span></code>.</p>
<p>But knowing how critical a package is to other packages may be beneficial. This
information is included by <a class="reference external" href="https://pypi.org/project/pip-tools/">pip-tools</a> , so there’s prior art in including it.
A flexible approach could be used to record the dependents, e.g. as much
detail as to differentiate from any other entry for the same package in the file
(inspired by <a class="reference external" href="https://github.com/astral-sh/uv">uv</a>).</p>
<p>In the end, though, it was decided that recording the dependencies is a better
thing to record.</p>
</section>
</section>
</section>
<section id="acknowledgements">
<h2><a class="toc-backref" href="#acknowledgements" role="doc-backlink">Acknowledgements</a></h2>
<p>Thanks to everyone who participated in the discussions on discuss.python.org.
Also thanks to Randy Döring, Seth Michael Larson, Paul Moore, and Ofek Lev for
providing feedback on a draft version of this PEP before going public. Thanks to
Randy Döring of Poetry, Charlie Marsh of uv, and Frost Ming of PDM for providing
feedback on behalf of their respective projects.</p>
</section>
<section id="copyright">
<h2><a class="toc-backref" href="#copyright" role="doc-backlink">Copyright</a></h2>
<p>This document is placed in the public domain or under the
CC0-1.0-Universal license, whichever is more permissive.</p>
</section>
</section>
<hr class="docutils" />
<p>Source: <a class="reference external" href="https://github.com/python/peps/blob/main/peps/pep-0751.rst">https://github.com/python/peps/blob/main/peps/pep-0751.rst</a></p>
<p>Last modified: <a class="reference external" href="https://github.com/python/peps/commits/main/peps/pep-0751.rst">2025-06-20 17:43:34 GMT</a></p>

        </article>
        <nav id="pep-sidebar">
            <h2>Contents</h2>
            <ul>
<li><a class="reference internal" href="#abstract">Abstract</a></li>
<li><a class="reference internal" href="#motivation">Motivation</a></li>
<li><a class="reference internal" href="#rationale">Rationale</a></li>
<li><a class="reference internal" href="#specification">Specification</a><ul>
<li><a class="reference internal" href="#file-name">File Name</a></li>
<li><a class="reference internal" href="#file-format">File Format</a><ul>
<li><a class="reference internal" href="#lock-version"><code class="docutils literal notranslate"><span class="pre">lock-version</span></code></a></li>
<li><a class="reference internal" href="#environments"><code class="docutils literal notranslate"><span class="pre">environments</span></code></a></li>
<li><a class="reference internal" href="#requires-python"><code class="docutils literal notranslate"><span class="pre">requires-python</span></code></a></li>
<li><a class="reference internal" href="#extras"><code class="docutils literal notranslate"><span class="pre">extras</span></code></a></li>
<li><a class="reference internal" href="#dependency-groups"><code class="docutils literal notranslate"><span class="pre">dependency-groups</span></code></a></li>
<li><a class="reference internal" href="#default-groups"><code class="docutils literal notranslate"><span class="pre">default-groups</span></code></a></li>
<li><a class="reference internal" href="#created-by"><code class="docutils literal notranslate"><span class="pre">created-by</span></code></a></li>
<li><a class="reference internal" href="#packages"><code class="docutils literal notranslate"><span class="pre">[[packages]]</span></code></a><ul>
<li><a class="reference internal" href="#packages-name"><code class="docutils literal notranslate"><span class="pre">packages.name</span></code></a></li>
<li><a class="reference internal" href="#packages-version"><code class="docutils literal notranslate"><span class="pre">packages.version</span></code></a></li>
<li><a class="reference internal" href="#packages-marker"><code class="docutils literal notranslate"><span class="pre">packages.marker</span></code></a></li>
<li><a class="reference internal" href="#packages-requires-python"><code class="docutils literal notranslate"><span class="pre">packages.requires-python</span></code></a></li>
<li><a class="reference internal" href="#packages-dependencies"><code class="docutils literal notranslate"><span class="pre">[[packages.dependencies]]</span></code></a></li>
<li><a class="reference internal" href="#packages-vcs"><code class="docutils literal notranslate"><span class="pre">[packages.vcs]</span></code></a><ul>
<li><a class="reference internal" href="#packages-vcs-type"><code class="docutils literal notranslate"><span class="pre">packages.vcs.type</span></code></a></li>
<li><a class="reference internal" href="#packages-vcs-url"><code class="docutils literal notranslate"><span class="pre">packages.vcs.url</span></code></a></li>
<li><a class="reference internal" href="#packages-vcs-path"><code class="docutils literal notranslate"><span class="pre">packages.vcs.path</span></code></a></li>
<li><a class="reference internal" href="#packages-vcs-requested-revision"><code class="docutils literal notranslate"><span class="pre">packages.vcs.requested-revision</span></code></a></li>
<li><a class="reference internal" href="#packages-vcs-commit-id"><code class="docutils literal notranslate"><span class="pre">packages.vcs.commit-id</span></code></a></li>
<li><a class="reference internal" href="#packages-vcs-subdirectory"><code class="docutils literal notranslate"><span class="pre">packages.vcs.subdirectory</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#packages-directory"><code class="docutils literal notranslate"><span class="pre">[packages.directory]</span></code></a><ul>
<li><a class="reference internal" href="#packages-directory-path"><code class="docutils literal notranslate"><span class="pre">packages.directory.path</span></code></a></li>
<li><a class="reference internal" href="#packages-directory-editable"><code class="docutils literal notranslate"><span class="pre">packages.directory.editable</span></code></a></li>
<li><a class="reference internal" href="#packages-directory-subdirectory"><code class="docutils literal notranslate"><span class="pre">packages.directory.subdirectory</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#packages-archive"><code class="docutils literal notranslate"><span class="pre">[packages.archive]</span></code></a><ul>
<li><a class="reference internal" href="#packages-archive-url"><code class="docutils literal notranslate"><span class="pre">packages.archive.url</span></code></a></li>
<li><a class="reference internal" href="#packages-archive-path"><code class="docutils literal notranslate"><span class="pre">packages.archive.path</span></code></a></li>
<li><a class="reference internal" href="#packages-archive-size"><code class="docutils literal notranslate"><span class="pre">packages.archive.size</span></code></a></li>
<li><a class="reference internal" href="#packages-archive-upload-time"><code class="docutils literal notranslate"><span class="pre">packages.archive.upload-time</span></code></a></li>
<li><a class="reference internal" href="#packages-archive-hashes"><code class="docutils literal notranslate"><span class="pre">[packages.archive.hashes]</span></code></a></li>
<li><a class="reference internal" href="#packages-archive-subdirectory"><code class="docutils literal notranslate"><span class="pre">packages.archive.subdirectory</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#packages-index"><code class="docutils literal notranslate"><span class="pre">packages.index</span></code></a></li>
<li><a class="reference internal" href="#packages-sdist"><code class="docutils literal notranslate"><span class="pre">[packages.sdist]</span></code></a><ul>
<li><a class="reference internal" href="#packages-sdist-name"><code class="docutils literal notranslate"><span class="pre">packages.sdist.name</span></code></a></li>
<li><a class="reference internal" href="#packages-sdist-upload-time"><code class="docutils literal notranslate"><span class="pre">packages.sdist.upload-time</span></code></a></li>
<li><a class="reference internal" href="#packages-sdist-url"><code class="docutils literal notranslate"><span class="pre">packages.sdist.url</span></code></a></li>
<li><a class="reference internal" href="#packages-sdist-path"><code class="docutils literal notranslate"><span class="pre">packages.sdist.path</span></code></a></li>
<li><a class="reference internal" href="#packages-sdist-size"><code class="docutils literal notranslate"><span class="pre">packages.sdist.size</span></code></a></li>
<li><a class="reference internal" href="#packages-sdist-hashes"><code class="docutils literal notranslate"><span class="pre">packages.sdist.hashes</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#packages-wheels"><code class="docutils literal notranslate"><span class="pre">[[packages.wheels]]</span></code></a><ul>
<li><a class="reference internal" href="#packages-wheels-name"><code class="docutils literal notranslate"><span class="pre">packages.wheels.name</span></code></a></li>
<li><a class="reference internal" href="#packages-wheels-upload-time"><code class="docutils literal notranslate"><span class="pre">packages.wheels.upload-time</span></code></a></li>
<li><a class="reference internal" href="#packages-wheels-url"><code class="docutils literal notranslate"><span class="pre">packages.wheels.url</span></code></a></li>
<li><a class="reference internal" href="#packages-wheels-path"><code class="docutils literal notranslate"><span class="pre">packages.wheels.path</span></code></a></li>
<li><a class="reference internal" href="#packages-wheels-size"><code class="docutils literal notranslate"><span class="pre">packages.wheels.size</span></code></a></li>
<li><a class="reference internal" href="#packages-wheels-hashes"><code class="docutils literal notranslate"><span class="pre">packages.wheels.hashes</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#packages-attestation-identities"><code class="docutils literal notranslate"><span class="pre">[[packages.attestation-identities]]</span></code></a><ul>
<li><a class="reference internal" href="#packages-attestation-identities-kind"><code class="docutils literal notranslate"><span class="pre">packages.attestation-identities.kind</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#packages-tool"><code class="docutils literal notranslate"><span class="pre">[packages.tool]</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#tool"><code class="docutils literal notranslate"><span class="pre">[tool]</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#additions-to-marker-expression-syntax">Additions to marker expression syntax</a></li>
<li><a class="reference internal" href="#example">Example</a></li>
<li><a class="reference internal" href="#installation">Installation</a></li>
<li><a class="reference internal" href="#semantic-differences-with-requirements-txt-files">Semantic differences with <code class="docutils literal notranslate"><span class="pre">requirements.txt</span></code> files</a></li>
</ul>
</li>
<li><a class="reference internal" href="#backwards-compatibility">Backwards Compatibility</a></li>
<li><a class="reference internal" href="#security-implications">Security Implications</a></li>
<li><a class="reference internal" href="#how-to-teach-this">How to Teach This</a></li>
<li><a class="reference internal" href="#reference-implementation">Reference Implementation</a></li>
<li><a class="reference internal" href="#rejected-ideas">Rejected Ideas</a><ul>
<li><a class="reference internal" href="#recording-the-dependency-graph-for-installation-purposes">Recording the dependency graph for installation purposes</a></li>
<li><a class="reference internal" href="#specifying-a-new-core-metadata-version-that-requires-consistent-metadata-across-files">Specifying a new core metadata version that requires consistent metadata across files</a></li>
<li><a class="reference internal" href="#have-the-installer-do-dependency-resolution">Have the installer do dependency resolution</a></li>
<li><a class="reference internal" href="#requiring-minimum-hash-algorithm-support">Requiring minimum hash algorithm support</a></li>
<li><a class="reference internal" href="#file-naming">File naming</a><ul>
<li><a class="reference internal" href="#using-pylock-toml-as-the-file-name">Using <code class="docutils literal notranslate"><span class="pre">*.pylock.toml</span></code> as the file name</a></li>
<li><a class="reference internal" href="#using-pylock-as-the-file-name">Using <code class="docutils literal notranslate"><span class="pre">*.pylock</span></code> as the file name</a></li>
<li><a class="reference internal" href="#not-having-a-naming-convention-for-the-file">Not having a naming convention for the file</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id1">File format</a><ul>
<li><a class="reference internal" href="#use-json-over-toml">Use JSON over TOML</a></li>
<li><a class="reference internal" href="#use-yaml-over-toml">Use YAML over TOML</a></li>
</ul>
</li>
<li><a class="reference internal" href="#other-keys">Other keys</a><ul>
<li><a class="reference internal" href="#a-single-hash-algorithm-for-the-whole-file">A single hash algorithm for the whole file</a></li>
<li><a class="reference internal" href="#hashing-the-contents-of-the-lock-file-itself">Hashing the contents of the lock file itself</a></li>
<li><a class="reference internal" href="#recording-the-creation-date-of-the-lock-file">Recording the creation date of the lock file</a></li>
<li><a class="reference internal" href="#recording-the-package-indexes-used-in-searching">Recording the package indexes used in searching</a></li>
<li><a class="reference internal" href="#locking-build-requirements-for-sdists">Locking build requirements for sdists</a></li>
<li><a class="reference internal" href="#a-dedicated-direct-key">A dedicated <code class="docutils literal notranslate"><span class="pre">direct</span></code> key</a></li>
</ul>
</li>
<li><a class="reference internal" href="#simplification">Simplification</a><ul>
<li><a class="reference internal" href="#drop-recording-the-package-version">Drop recording the package version</a></li>
<li><a class="reference internal" href="#drop-the-requirement-to-specify-the-location-of-an-sdist-and-or-wheels">Drop the requirement to specify the location of an sdist and/or wheels</a></li>
<li><a class="reference internal" href="#drop-requiring-file-size-and-hashes">Drop requiring file size and hashes</a></li>
<li><a class="reference internal" href="#drop-recording-the-sdist-file-name">Drop recording the sdist file name</a></li>
<li><a class="reference internal" href="#make-packages-wheels-a-table">Make <code class="docutils literal notranslate"><span class="pre">packages.wheels</span></code> a table</a></li>
</ul>
</li>
<li><a class="reference internal" href="#self-referential">Self-Referential</a><ul>
<li><a class="reference internal" href="#drop-the-tool-table">Drop the <code class="docutils literal notranslate"><span class="pre">[tool]</span></code> table</a></li>
<li><a class="reference internal" href="#list-the-requirement-inputs-for-the-file">List the requirement inputs for the file</a></li>
</ul>
</li>
<li><a class="reference internal" href="#auditing">Auditing</a><ul>
<li><a class="reference internal" href="#recording-dependents">Recording dependents</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#acknowledgements">Acknowledgements</a></li>
<li><a class="reference internal" href="#copyright">Copyright</a></li>
</ul>

            <br>
            <a id="source" href="https://github.com/python/peps/blob/main/peps/pep-0751.rst?plain=1">Page Source (GitHub)</a>
        </nav>
    </section>
    <script src="../_static/colour_scheme.js"></script>
    <script src="../_static/wrap_tables.js"></script>
    <script src="../_static/sticky_banner.js"></script>
    <script src="https://analytics.python.org/js/script.outbound-links.js"
            data-domain="peps.python.org" defer></script>
</body>
</html>