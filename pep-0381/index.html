
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="color-scheme" content="light dark">
    <title>PEP 381 – Mirroring infrastructure for PyPI | peps.python.org</title>
    <link rel="shortcut icon" href="../_static/py.png">
    <link rel="canonical" href="https://peps.python.org/pep-0381/">
    <link rel="stylesheet" href="../_static/style.css" type="text/css">
    <link rel="stylesheet" href="../_static/mq.css" type="text/css">
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" media="(prefers-color-scheme: light)" id="pyg-light">
    <link rel="stylesheet" href="../_static/pygments_dark.css" type="text/css" media="(prefers-color-scheme: dark)" id="pyg-dark">
    <link rel="alternate" type="application/rss+xml" title="Latest PEPs" href="https://peps.python.org/peps.rss">
    <meta property="og:title" content='PEP 381 – Mirroring infrastructure for PyPI | peps.python.org'>
    <meta property="og:description" content="This PEP describes a mirroring infrastructure for PyPI.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://peps.python.org/pep-0381/">
    <meta property="og:site_name" content="Python Enhancement Proposals (PEPs)">
    <meta property="og:image" content="https://peps.python.org/_static/og-image.png">
    <meta property="og:image:alt" content="Python PEPs">
    <meta property="og:image:width" content="200">
    <meta property="og:image:height" content="200">
    <meta name="description" content="This PEP describes a mirroring infrastructure for PyPI.">
    <meta name="theme-color" content="#3776ab">
</head>
<body>
    
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-sun-half" viewBox="0 0 24 24" pointer-events="all">
    <title>Following system colour scheme</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none"
         stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <circle cx="12" cy="12" r="9"></circle>
      <path d="M12 3v18m0-12l4.65-4.65M12 14.3l7.37-7.37M12 19.6l8.85-8.85"></path>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24" pointer-events="all">
    <title>Selected dark colour scheme</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none"
         stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z"></path>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24" pointer-events="all">
    <title>Selected light colour scheme</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none"
         stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
</svg>
    <script>

        document.documentElement.dataset.colour_scheme = localStorage.getItem("colour_scheme") || "auto"
    </script>
    <section id="pep-page-section">
        <header>
            <h1 data-pagefind-ignore>Python Enhancement Proposals</h1>
            <ul class="breadcrumbs">
                <li><a href="https://www.python.org/" title="The Python Programming Language">Python</a> &raquo; </li>
                <li><a href="../pep-0000/">PEP Index</a> &raquo; </li>
                <li>PEP 381</li>
            </ul>
            <button id="colour-scheme-cycler" onClick="setColourScheme(nextColourScheme())">
                <svg aria-hidden="true" class="colour-scheme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
                <svg aria-hidden="true" class="colour-scheme-icon-when-dark"><use href="#svg-moon"></use></svg>
                <svg aria-hidden="true" class="colour-scheme-icon-when-light"><use href="#svg-sun"></use></svg>
                <span class="visually-hidden">Toggle light / dark / auto colour theme</span>
            </button>
        </header>
        
        <div id="mobile-search" class="mobile-search-container"></div>
        
        <article data-pagefind-body>
            
            <span data-pagefind-meta="title:PEP 381 – Mirroring infrastructure for PyPI" data-pagefind-weight="10" class="visually-hidden">PEP 381 – Mirroring infrastructure for PyPI</span>
            <section id="pep-content">
<h1 class="page-title">PEP 381 – Mirroring infrastructure for PyPI</h1>
<dl class="rfc2822 field-list simple">
<dt class="field-odd">Author<span class="colon">:</span></dt>
<dd class="field-odd">Tarek Ziadé &lt;tarek&#32;&#97;t&#32;ziade.org&gt;, Martin von Löwis &lt;martin&#32;&#97;t&#32;v.loewis.de&gt;</dd>
<dt class="field-even">Status<span class="colon">:</span></dt>
<dd class="field-even"><abbr title="Removed from consideration by sponsor or authors">Withdrawn</abbr></dd>
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><abbr title="Normative PEP with a new feature for Python, implementation change for CPython or interoperability standard for the ecosystem">Standards Track</abbr></dd>
<dt class="field-even">Topic<span class="colon">:</span></dt>
<dd class="field-even"><a class="reference external" href="../topic/packaging/">Packaging</a></dd>
<dt class="field-odd">Created<span class="colon">:</span></dt>
<dd class="field-odd">21-Mar-2009</dd>
<dt class="field-even">Post-History<span class="colon">:</span></dt>
<dd class="field-even"><p></p></dd>
</dl>
<hr class="docutils" />
<section id="contents">
<details><summary>Table of Contents</summary><ul class="simple">
<li><a class="reference internal" href="#abstract">Abstract</a></li>
<li><a class="reference internal" href="#pep-withdrawal">PEP Withdrawal</a></li>
<li><a class="reference internal" href="#rationale">Rationale</a></li>
<li><a class="reference internal" href="#mirror-listing-and-registering">Mirror listing and registering</a><ul>
<li><a class="reference internal" href="#statistics-page">Statistics page</a></li>
</ul>
</li>
<li><a class="reference internal" href="#mirror-authenticity">Mirror Authenticity</a></li>
<li><a class="reference internal" href="#special-pages-a-mirror-needs-to-provide">Special pages a mirror needs to provide</a><ul>
<li><a class="reference internal" href="#last-modified-date">Last modified date</a></li>
<li><a class="reference internal" href="#local-statistics">Local statistics</a></li>
</ul>
</li>
<li><a class="reference internal" href="#how-a-mirror-should-synchronize-with-pypi">How a mirror should synchronize with PyPI</a><ul>
<li><a class="reference internal" href="#the-mirroring-protocol">The mirroring protocol</a></li>
<li><a class="reference internal" href="#user-agent-request-header">User-agent request header</a></li>
<li><a class="reference internal" href="#how-a-client-can-use-pypi-and-its-mirrors">How a client can use PyPI and its mirrors</a></li>
<li><a class="reference internal" href="#fail-over-mechanism">Fail-over mechanism</a></li>
<li><a class="reference internal" href="#extra-package-indexes">Extra package indexes</a></li>
<li><a class="reference internal" href="#merging-several-indexes">Merging several indexes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#references">References</a></li>
<li><a class="reference internal" href="#acknowledgments">Acknowledgments</a></li>
<li><a class="reference internal" href="#copyright">Copyright</a></li>
</ul>
</details></section>
<section id="abstract">
<h2><a class="toc-backref" href="#abstract" role="doc-backlink">Abstract</a></h2>
<p>This PEP describes a mirroring infrastructure for PyPI.</p>
</section>
<section id="pep-withdrawal">
<h2><a class="toc-backref" href="#pep-withdrawal" role="doc-backlink">PEP Withdrawal</a></h2>
<p>The main PyPI web service was moved behind the Fastly caching CDN in May 2013:
<a class="reference external" href="https://mail.python.org/pipermail/distutils-sig/2013-May/020848.html">https://mail.python.org/pipermail/distutils-sig/2013-May/020848.html</a></p>
<p>Subsequently, this arrangement was formalised as an in-kind sponsorship with
the PSF, and the PSF has also taken on the task of risk management in the event
that that sponsorship arrangement were to ever cease.</p>
<p>The download statistics that were previously provided directly on PyPI, are now
published indirectly via Google Big Query:
<a class="reference external" href="https://packaging.python.org/guides/analyzing-pypi-package-downloads/">https://packaging.python.org/guides/analyzing-pypi-package-downloads/</a></p>
<p>Accordingly, the mirroring proposal described in this PEP is no longer required,
and has been marked as Withdrawn.</p>
</section>
<section id="rationale">
<h2><a class="toc-backref" href="#rationale" role="doc-backlink">Rationale</a></h2>
<p>PyPI is hosting over 6000 projects and is used on a daily basis
by people to build applications. Especially systems like <code class="docutils literal notranslate"><span class="pre">easy_install</span></code>
and <code class="docutils literal notranslate"><span class="pre">zc.buildout</span></code> make intensive usage of PyPI.</p>
<p>For people making intensive use of PyPI, it can act as a single point
of failure.  People have started to set up some mirrors, both private
and public.  Those mirrors are active mirrors, which means that they
are browsing PyPI to get synced.</p>
<p>In order to make the system more reliable, this PEP describes:</p>
<ul class="simple">
<li>the mirror listing and registering at PyPI</li>
<li>the pages a public mirror should maintain.  These pages will be used
by PyPI, in order to get hit counts and the last modified date.</li>
<li>how a mirror should synchronize with PyPI</li>
<li>how a client can implement a fail-over mechanism</li>
</ul>
</section>
<section id="mirror-listing-and-registering">
<h2><a class="toc-backref" href="#mirror-listing-and-registering" role="doc-backlink">Mirror listing and registering</a></h2>
<p>People that wants to mirror PyPI make a proposal on catalog-SIG.
When a mirror is proposed on the mailing list, it is manually
added in a mirror list in the PyPI application after it
has been checked to be compliant with the mirroring rules.</p>
<p>The mirror list is provided as a list of host names of the
form</p>
<blockquote>
<div>X.pypi.python.org</div></blockquote>
<p>The values of X are the sequence a,b,c,…,aa,ab,…
a.pypi.python.org is the master server; the mirrors start
with b. A CNAME record last.pypi.python.org points to the
last host name. Mirror operators should use a static address,
and report planned changes to that address in advance to
distutils-sig.</p>
<p>The new mirror also appears at <code class="docutils literal notranslate"><span class="pre">http://pypi.python.org/mirrors</span></code>
which is a human-readable page that gives the list of mirrors.
This page also explains how to register a new mirror.</p>
<section id="statistics-page">
<h3><a class="toc-backref" href="#statistics-page" role="doc-backlink">Statistics page</a></h3>
<p>PyPI provides statistics on downloads at <code class="docutils literal notranslate"><span class="pre">/stats</span></code>. This page is
calculated daily by PyPI, by reading all mirrors’ local stats and
summing them.</p>
<p>The stats are presented in daily or monthly files, under <code class="docutils literal notranslate"><span class="pre">/stats/days</span></code>
and <code class="docutils literal notranslate"><span class="pre">/stats/months</span></code>. Each file is a <code class="docutils literal notranslate"><span class="pre">bzip2</span></code> file with these formats:</p>
<ul class="simple">
<li>YYYY-MM-DD.bz2 for daily files</li>
<li>YYYY-MM.bz2 for monthly files</li>
</ul>
<p>Examples:</p>
<ul class="simple">
<li>/stats/days/2008-11-06.bz2</li>
<li>/stats/days/2008-11-07.bz2</li>
<li>/stats/days/2008-11-08.bz2</li>
<li>/stats/months/2008-11.bz2</li>
<li>/stats/months/2008-10.bz2</li>
</ul>
</section>
</section>
<section id="mirror-authenticity">
<h2><a class="toc-backref" href="#mirror-authenticity" role="doc-backlink">Mirror Authenticity</a></h2>
<p>With a distributed mirroring system, clients may want to verify that
the mirrored copies are authentic. There are multiple threats to
consider:</p>
<ol class="arabic simple">
<li>the central index may get compromised</li>
<li>the central index is assumed to be trusted, but the mirrors might
be tampered.</li>
<li>a man in the middle between the central index and the end user,
or between a mirror and the end user might tamper with datagrams.</li>
</ol>
<p>This specification only deals with the second threat. Some provisions
are made to detect man-in-the-middle attacks. To detect the first
attack, package authors need to sign their packages using PGP keys, so
that users verify that the package comes from the author they trust.</p>
<p>The central index provides a DSA key at the URL /serverkey, in the PEM
format as generated by “openssl dsa -pubout” (i.e. <span class="target" id="index-0"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc3280.html"><strong>RFC 3280</strong></a>
SubjectPublicKeyInfo, with the algorithm 1.3.14.3.2.12). This URL must
<em>not</em> be mirrored, and clients must fetch the official serverkey from
PyPI directly, or use the copy that came with the PyPI client software.
Mirrors should still download the key, to detect a key rollover.</p>
<p>For each package, a mirrored signature is provided at
/serversig/&lt;package&gt;. This is the DSA signature of the parallel URL
/simple/&lt;package&gt;, in DER form, using SHA-1 with DSA (i.e. as a
<span class="target" id="index-1"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc3279.html"><strong>RFC 3279</strong></a> Dsa-Sig-Value, created by algorithm 1.2.840.10040.4.3)</p>
<p>Clients using a mirror need to perform the following steps to verify
a package:</p>
<ol class="arabic simple">
<li>download the /simple page, and compute its SHA-1 hash</li>
<li>compute the DSA signature of that hash</li>
<li>download the corresponding /serversig, and compare it (byte-for-byte)
with the value computed in step 2.</li>
<li>compute and verify (against the /simple page) the MD-5 hashes
of all files they download from the mirror.</li>
</ol>
<p>An implementation of the verification algorithm is available from
<a class="reference external" href="https://svn.python.org/packages/trunk/pypi/tools/verify.py">https://svn.python.org/packages/trunk/pypi/tools/verify.py</a></p>
<p>Verification is not needed when downloading from central index, and
should be avoided to reduce the computation overhead.</p>
<p>About once a year, the key will be replaced with a new one. Mirrors
will have to re-fetch all /serversig pages. Clients using mirrors need
to find a trusted copy of the new server key. One way to obtain one
is to download it from <a class="reference external" href="https://pypi.python.org/serverkey">https://pypi.python.org/serverkey</a>. To detect
man-in-the-middle attacks, clients need to verify the SSL server
certificate, which will be signed by the CACert authority.</p>
</section>
<section id="special-pages-a-mirror-needs-to-provide">
<h2><a class="toc-backref" href="#special-pages-a-mirror-needs-to-provide" role="doc-backlink">Special pages a mirror needs to provide</a></h2>
<p>A mirror is a subset copy of PyPI, so it provides the same structure
by copying it.</p>
<ul class="simple">
<li>simple: rest version of the package index</li>
<li>packages: packages, stored by Python version, and letters</li>
<li>serversig: signatures for the simple pages</li>
</ul>
<p>It also needs to provide two specific elements:</p>
<ul class="simple">
<li>last-modified</li>
<li>local-stats</li>
</ul>
<section id="last-modified-date">
<h3><a class="toc-backref" href="#last-modified-date" role="doc-backlink">Last modified date</a></h3>
<p>CPAN uses a freshness date system where the mirror’s last
synchronisation date is made available.</p>
<p>For PyPI, each mirror needs to maintain a URL with simple text content
that represents the last synchronisation date the mirror maintains.</p>
<p>The date is provided in GMT time, using the ISO 8601 format <a class="footnote-reference brackets" href="#iso8601" id="id1">[2]</a>.
Each mirror will be responsible to maintain its last modified date.</p>
<p>This page must be located at : <code class="docutils literal notranslate"><span class="pre">/last-modified</span></code> and must be a
text/plain page.</p>
</section>
<section id="local-statistics">
<h3><a class="toc-backref" href="#local-statistics" role="doc-backlink">Local statistics</a></h3>
<p>Each mirror is responsible to count all the downloads that where done
via it.  This is used by PyPI to sum up all downloads, to be able to
display the grand total.</p>
<p>These statistics are in CSV-like form, with a header in the first
line.  It needs to obey <a class="pep reference internal" href="../pep-0305/" title="PEP 305 – CSV File API">PEP 305</a>.  Basically, it should be
readable by Python’s <code class="docutils literal notranslate"><span class="pre">csv</span></code> module.</p>
<p>The fields in this file are:</p>
<ul class="simple">
<li>package: the distutils id of the package.</li>
<li>filename: the filename that has been downloaded.</li>
<li>useragent: the User-Agent of the client that has downloaded the
package.</li>
<li>count: the number of downloads.</li>
</ul>
<p>The content will look like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># package,filename,useragent,count</span>
<span class="n">zc</span><span class="o">.</span><span class="n">buildout</span><span class="p">,</span><span class="n">zc</span><span class="o">.</span><span class="n">buildout</span><span class="o">-</span><span class="mf">1.6.0</span><span class="o">.</span><span class="n">tgz</span><span class="p">,</span><span class="n">MyAgent</span><span class="p">,</span><span class="mi">142</span>
<span class="o">...</span>
</pre></div>
</div>
<p>The counting starts the day the mirror is launched, and there is one
file per day, compressed using the <code class="docutils literal notranslate"><span class="pre">bzip2</span></code> format.  Each file is named
like the day.  For example, <code class="docutils literal notranslate"><span class="pre">2008-11-06.bz2</span></code> is the file for the 6th of
November 2008.</p>
<p>They are then provided in a folder called <code class="docutils literal notranslate"><span class="pre">days</span></code>. For example:</p>
<ul class="simple">
<li>/local-stats/days/2008-11-06.bz2</li>
<li>/local-stats/days/2008-11-07.bz2</li>
<li>/local-stats/days/2008-11-08.bz2</li>
</ul>
<p>This page must be located at <code class="docutils literal notranslate"><span class="pre">/local-stats</span></code>.</p>
</section>
</section>
<section id="how-a-mirror-should-synchronize-with-pypi">
<h2><a class="toc-backref" href="#how-a-mirror-should-synchronize-with-pypi" role="doc-backlink">How a mirror should synchronize with PyPI</a></h2>
<p>A mirroring protocol called <code class="docutils literal notranslate"><span class="pre">Simple</span> <span class="pre">Index</span></code> was described and
implemented by Martin v. Loewis and Jim Fulton, based on how
<code class="docutils literal notranslate"><span class="pre">easy_install</span></code> works.  This section synthesizes it and gives a few
relevant links, plus a small part about <code class="docutils literal notranslate"><span class="pre">User-Agent</span></code>.</p>
<section id="the-mirroring-protocol">
<h3><a class="toc-backref" href="#the-mirroring-protocol" role="doc-backlink">The mirroring protocol</a></h3>
<p>Mirrors must reduce the amount of data transferred between the central
server and the mirror. To achieve that, they MUST use the changelog()
PyPI XML-RPC call, and only refetch the packages that have been
changed since the last time. For each package P, they MUST copy
documents /simple/P/ and /serversig/P. If a package is deleted on the
central server, they MUST delete the package and all associated files.
To detect modification of package files, they MAY cache the file’s
ETag, and MAY request skipping it using the If-none-match header.</p>
<p>Each mirroring tool MUST identify itself using a descripte User-agent
header.</p>
<p>The pep381client package <a class="footnote-reference brackets" href="#pep381client" id="id2">[1]</a> provides an application that
respects this protocol to browse PyPI.</p>
</section>
<section id="user-agent-request-header">
<h3><a class="toc-backref" href="#user-agent-request-header" role="doc-backlink">User-agent request header</a></h3>
<p>In order to be able to differentiate actions taken by clients over
PyPI, a specific user agent name should be provided by all mirroring
software.</p>
<p>This is also true for all clients like:</p>
<ul class="simple">
<li>zc.buildout <a class="footnote-reference brackets" href="#zc-buildout" id="id3">[3]</a>.</li>
<li>setuptools <a class="footnote-reference brackets" href="#setuptools" id="id4">[4]</a>.</li>
<li>pip <a class="footnote-reference brackets" href="#pip" id="id5">[5]</a>.</li>
</ul>
<p>XXX user agent registering mechanism at PyPI ?</p>
</section>
<section id="how-a-client-can-use-pypi-and-its-mirrors">
<h3><a class="toc-backref" href="#how-a-client-can-use-pypi-and-its-mirrors" role="doc-backlink">How a client can use PyPI and its mirrors</a></h3>
<p>Clients that are browsing PyPI should be able to use alternative
mirrors, by getting the list of the mirrors using <code class="docutils literal notranslate"><span class="pre">last.pypi.python.org</span></code>.</p>
<p>Code example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">socket</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">socket</span><span class="o">.</span><span class="n">gethostbyname_ex</span><span class="p">(</span><span class="s1">&#39;last.pypi.python.org&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">&#39;h.pypi.python.org&#39;</span>
</pre></div>
</div>
<p>The clients so far that could use this mechanism:</p>
<ul class="simple">
<li>setuptools</li>
<li>zc.buildout (through setuptools)</li>
<li>pip</li>
</ul>
</section>
<section id="fail-over-mechanism">
<h3><a class="toc-backref" href="#fail-over-mechanism" role="doc-backlink">Fail-over mechanism</a></h3>
<p>Clients that are browsing PyPI should be able to use a fail-over
mechanism when PyPI or the used mirror is not responding.</p>
<p>It is up to the client to decide which mirror should be used, maybe by
looking at its geographical location and its responsiveness.</p>
<p>This PEP does not describe how this fail-over mechanism should work,
but it is strongly encouraged that the clients try to use the nearest
mirror.</p>
<p>The clients so far that could use this mechanism:</p>
<ul class="simple">
<li>setuptools</li>
<li>zc.buildout (through setuptools)</li>
<li>pip</li>
</ul>
</section>
<section id="extra-package-indexes">
<h3><a class="toc-backref" href="#extra-package-indexes" role="doc-backlink">Extra package indexes</a></h3>
<p>It is obvious that some packages will not be uploaded to PyPI, whether
because they are private or whether because the project maintainer
runs their own server where people might get the project package.
However, it is strongly encouraged that a public package index follows
PyPI and Distutils protocols.</p>
<p>In other words, the <code class="docutils literal notranslate"><span class="pre">register</span></code> and <code class="docutils literal notranslate"><span class="pre">upload</span></code> command should be
compatible with any package index server out there.</p>
<p>Software that are compatible with PyPI and Distutils so far:</p>
<ul class="simple">
<li>PloneSoftwareCenter <a class="footnote-reference brackets" href="#psc" id="id6">[6]</a> which is used to run plone.org products section.</li>
<li>EggBasket <a class="footnote-reference brackets" href="#eggbasket" id="id7">[7]</a>.</li>
</ul>
<p><strong>An extra package index is not a mirror of PyPI, but can have some
mirrors itself.</strong></p>
</section>
<section id="merging-several-indexes">
<h3><a class="toc-backref" href="#merging-several-indexes" role="doc-backlink">Merging several indexes</a></h3>
<p>When a client needs to get some packages from several distinct
indexes, it should be able to use each one of them as a potential
source of packages.  Different indexes should be defined as a sorted
list for the client to look for a package.</p>
<p>Each independent index can of course provide a list of its mirrors.</p>
<p>XXX define how to get the hostname for the mirrors of an arbitrary
index.</p>
<p>That permits all combinations at client level, for a reliable
packaging system with all levels of privacy.</p>
<p>It is up the client to deal with the merging.</p>
</section>
</section>
<section id="references">
<h2><a class="toc-backref" href="#references" role="doc-backlink">References</a></h2>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="pep381client" role="doc-footnote">
<dt class="label" id="pep381client">[<a href="#id2">1</a>]</dt>
<dd><a class="reference external" href="http://pypi.python.org/pypi/pep381client">http://pypi.python.org/pypi/pep381client</a></aside>
<aside class="footnote brackets" id="iso8601" role="doc-footnote">
<dt class="label" id="iso8601">[<a href="#id1">2</a>]</dt>
<dd><a class="reference external" href="http://en.wikipedia.org/wiki/ISO_8601">http://en.wikipedia.org/wiki/ISO_8601</a></aside>
<aside class="footnote brackets" id="zc-buildout" role="doc-footnote">
<dt class="label" id="zc-buildout">[<a href="#id3">3</a>]</dt>
<dd><a class="reference external" href="http://pypi.python.org/pypi/zc.buildout">http://pypi.python.org/pypi/zc.buildout</a></aside>
<aside class="footnote brackets" id="setuptools" role="doc-footnote">
<dt class="label" id="setuptools">[<a href="#id4">4</a>]</dt>
<dd><a class="reference external" href="http://pypi.python.org/pypi/setuptools">http://pypi.python.org/pypi/setuptools</a></aside>
<aside class="footnote brackets" id="pip" role="doc-footnote">
<dt class="label" id="pip">[<a href="#id5">5</a>]</dt>
<dd><a class="reference external" href="http://pypi.python.org/pypi/pip">http://pypi.python.org/pypi/pip</a></aside>
<aside class="footnote brackets" id="psc" role="doc-footnote">
<dt class="label" id="psc">[<a href="#id6">6</a>]</dt>
<dd><a class="reference external" href="http://plone.org/products/plonesoftwarecenter">http://plone.org/products/plonesoftwarecenter</a></aside>
<aside class="footnote brackets" id="eggbasket" role="doc-footnote">
<dt class="label" id="eggbasket">[<a href="#id7">7</a>]</dt>
<dd><a class="reference external" href="http://www.chrisarndt.de/projects/eggbasket">http://www.chrisarndt.de/projects/eggbasket</a></aside>
</aside>
</section>
<section id="acknowledgments">
<h2><a class="toc-backref" href="#acknowledgments" role="doc-backlink">Acknowledgments</a></h2>
<p>Georg Brandl.</p>
</section>
<section id="copyright">
<h2><a class="toc-backref" href="#copyright" role="doc-backlink">Copyright</a></h2>
<p>This document has been placed in the public domain.</p>
</section>
</section>
<hr class="docutils" />
<p>Source: <a class="reference external" href="https://github.com/python/peps/blob/main/peps/pep-0381.rst">https://github.com/python/peps/blob/main/peps/pep-0381.rst</a></p>
<p>Last modified: <a class="reference external" href="https://github.com/python/peps/commits/main/peps/pep-0381.rst">2025-02-01 08:55:40 GMT</a></p>

        </article>
        <nav id="pep-sidebar">
            <div id="search"></div>
            <h2>Contents</h2>
            <ul>
<li><a class="reference internal" href="#abstract">Abstract</a></li>
<li><a class="reference internal" href="#pep-withdrawal">PEP Withdrawal</a></li>
<li><a class="reference internal" href="#rationale">Rationale</a></li>
<li><a class="reference internal" href="#mirror-listing-and-registering">Mirror listing and registering</a><ul>
<li><a class="reference internal" href="#statistics-page">Statistics page</a></li>
</ul>
</li>
<li><a class="reference internal" href="#mirror-authenticity">Mirror Authenticity</a></li>
<li><a class="reference internal" href="#special-pages-a-mirror-needs-to-provide">Special pages a mirror needs to provide</a><ul>
<li><a class="reference internal" href="#last-modified-date">Last modified date</a></li>
<li><a class="reference internal" href="#local-statistics">Local statistics</a></li>
</ul>
</li>
<li><a class="reference internal" href="#how-a-mirror-should-synchronize-with-pypi">How a mirror should synchronize with PyPI</a><ul>
<li><a class="reference internal" href="#the-mirroring-protocol">The mirroring protocol</a></li>
<li><a class="reference internal" href="#user-agent-request-header">User-agent request header</a></li>
<li><a class="reference internal" href="#how-a-client-can-use-pypi-and-its-mirrors">How a client can use PyPI and its mirrors</a></li>
<li><a class="reference internal" href="#fail-over-mechanism">Fail-over mechanism</a></li>
<li><a class="reference internal" href="#extra-package-indexes">Extra package indexes</a></li>
<li><a class="reference internal" href="#merging-several-indexes">Merging several indexes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#references">References</a></li>
<li><a class="reference internal" href="#acknowledgments">Acknowledgments</a></li>
<li><a class="reference internal" href="#copyright">Copyright</a></li>
</ul>

            <br>
            <a id="source" href="https://github.com/python/peps/blob/main/peps/pep-0381.rst?plain=1">Page Source (GitHub)</a>
        </nav>
    </section>
    <script src="../_static/colour_scheme.js"></script>
    <script src="../_static/wrap_tables.js"></script>
    <script src="../_static/sticky_banner.js"></script>
    <script src="https://analytics.python.org/js/script.outbound-links.js"
            data-domain="peps.python.org" defer></script>
    <script src="/pagefind/pagefind-ui.js"></script>
    <script>
        window.addEventListener('DOMContentLoaded', (event) => {
            // Ranking configuration to boost exact title matches
            const searchOptions = {
                ranking: {
                    termSimilarity: 9.0, // Higher values favor exact matches
                    termFrequency: 0.5, // Lower values reduce penalty for low term frequency
                    pageLength: 0.2, // Lower values reduce the impact of page length
                }
            };

            // Initialize pagefind for either mobile or desktop, not both
            if (window.innerWidth <= 640) {
                new PagefindUI({ element: "#mobile-search", ...searchOptions, showSubResults: false });
            } else {
                new PagefindUI({ element: "#search", ...searchOptions, showSubResults: true });
            }
        });
    </script>
</body>
</html>